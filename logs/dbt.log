[0m13:37:23.593409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794ce17c2a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794ce319a6f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794ce0e3e060>]}


============================== 13:37:23.601080 | c56f165f-0103-492a-abcd-7847bb81505d ==============================
[0m13:37:23.601080 [info ] [MainThread]: Running with dbt=1.10.2
[0m13:37:23.602138 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/evelyn.bautista@Digital-Grenoble.local/module_bi_2025/dbt_project_25/logs', 'version_check': 'True', 'profiles_dir': '/home/evelyn.bautista@Digital-Grenoble.local/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:37:23.853926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c56f165f-0103-492a-abcd-7847bb81505d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794ce0b5b260>]}
[0m13:37:23.899278 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-zvcdxsh2'
[0m13:37:23.900245 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m13:37:24.057361 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m13:37:24.059655 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m13:37:24.112712 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m13:37:24.138488 [info ] [MainThread]: Updating lock file in file path: /home/evelyn.bautista@Digital-Grenoble.local/module_bi_2025/dbt_project_25/package-lock.yml
[0m13:37:24.142161 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-zwi9udkb'
[0m13:37:24.147764 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m13:37:24.420145 [info ] [MainThread]: Installed from version 1.3.0
[0m13:37:24.420943 [info ] [MainThread]: Up to date!
[0m13:37:24.421707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c56f165f-0103-492a-abcd-7847bb81505d', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794ce02b8530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794ce03587a0>]}
[0m13:37:24.423742 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.9348263, "process_in_blocks": "1968", "process_kernel_time": 0.266823, "process_mem_max_rss": "103196", "process_out_blocks": "2304", "process_user_time": 2.839116}
[0m13:37:24.424688 [debug] [MainThread]: Command `dbt deps` succeeded at 13:37:24.424484 after 0.94 seconds
[0m13:37:24.425393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794ce0d1bd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794ce2873710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794ce03cca70>]}
[0m13:37:24.426138 [debug] [MainThread]: Flushing usage events
[0m13:37:24.874127 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:40:53.480351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4af8df4230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4af8bef6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4af9722a20>]}


============================== 13:40:53.487993 | ab24ba62-7d84-4b53-bf44-7455d0f227b9 ==============================
[0m13:40:53.487993 [info ] [MainThread]: Running with dbt=1.10.2
[0m13:40:53.489021 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/evelyn.bautista@Digital-Grenoble.local/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/evelyn.bautista@Digital-Grenoble.local/module_bi_2025/dbt_project_25/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:40:53.870851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ab24ba62-7d84-4b53-bf44-7455d0f227b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4af8526d80>]}
[0m13:40:53.995317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ab24ba62-7d84-4b53-bf44-7455d0f227b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4af919f2f0>]}
[0m13:40:53.997406 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:40:54.176213 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m13:40:54.177470 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:40:54.178239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ab24ba62-7d84-4b53-bf44-7455d0f227b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4af7b4b1a0>]}
[0m13:40:56.735752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ab24ba62-7d84-4b53-bf44-7455d0f227b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4af73375c0>]}
[0m13:40:56.869279 [debug] [MainThread]: Wrote artifact WritableManifest to /home/evelyn.bautista@Digital-Grenoble.local/module_bi_2025/dbt_project_25/target/manifest.json
[0m13:40:56.872501 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/evelyn.bautista@Digital-Grenoble.local/module_bi_2025/dbt_project_25/target/semantic_manifest.json
[0m13:40:56.898416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ab24ba62-7d84-4b53-bf44-7455d0f227b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4af7fa4d10>]}
[0m13:40:56.899286 [info ] [MainThread]: Found 2 models, 4 data tests, 549 macros
[0m13:40:56.900004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab24ba62-7d84-4b53-bf44-7455d0f227b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4af8612c30>]}
[0m13:40:56.902979 [info ] [MainThread]: 
[0m13:40:56.903723 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:40:56.904347 [info ] [MainThread]: 
[0m13:40:56.905263 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:40:56.912593 [debug] [ThreadPool]: Acquiring new postgres connection 'list_BI_group4'
[0m13:40:57.007729 [debug] [ThreadPool]: Using postgres connection "list_BI_group4"
[0m13:40:57.008512 [debug] [ThreadPool]: On list_BI_group4: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_project_25", "target_name": "dev", "connection_name": "list_BI_group4"} */

    select distinct nspname from pg_namespace
  
[0m13:40:57.009177 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:40:57.456862 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.447 seconds
[0m13:40:57.461819 [debug] [ThreadPool]: On list_BI_group4: Close
[0m13:40:57.466166 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_BI_group4, now list_BI_group4_public)
[0m13:40:57.478028 [debug] [ThreadPool]: Using postgres connection "list_BI_group4_public"
[0m13:40:57.478766 [debug] [ThreadPool]: On list_BI_group4_public: BEGIN
[0m13:40:57.479363 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:40:57.643401 [debug] [ThreadPool]: SQL status: BEGIN in 0.164 seconds
[0m13:40:57.644962 [debug] [ThreadPool]: Using postgres connection "list_BI_group4_public"
[0m13:40:57.646403 [debug] [ThreadPool]: On list_BI_group4_public: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_project_25", "target_name": "dev", "connection_name": "list_BI_group4_public"} */
select
      'BI_group4' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'BI_group4' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'BI_group4' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:40:57.664512 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.017 seconds
[0m13:40:57.669302 [debug] [ThreadPool]: On list_BI_group4_public: ROLLBACK
[0m13:40:57.679761 [debug] [ThreadPool]: On list_BI_group4_public: Close
[0m13:40:57.693484 [debug] [MainThread]: Using postgres connection "master"
[0m13:40:57.694213 [debug] [MainThread]: On master: BEGIN
[0m13:40:57.694851 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:40:57.850853 [debug] [MainThread]: SQL status: BEGIN in 0.156 seconds
[0m13:40:57.852314 [debug] [MainThread]: Using postgres connection "master"
[0m13:40:57.854048 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_project_25", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:40:57.877217 [debug] [MainThread]: SQL status: SELECT 0 in 0.021 seconds
[0m13:40:57.881412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab24ba62-7d84-4b53-bf44-7455d0f227b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4af6b3deb0>]}
[0m13:40:57.883245 [debug] [MainThread]: On master: ROLLBACK
[0m13:40:57.894550 [debug] [MainThread]: Using postgres connection "master"
[0m13:40:57.895671 [debug] [MainThread]: On master: BEGIN
[0m13:40:57.915935 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m13:40:57.917417 [debug] [MainThread]: On master: COMMIT
[0m13:40:57.918801 [debug] [MainThread]: Using postgres connection "master"
[0m13:40:57.920118 [debug] [MainThread]: On master: COMMIT
[0m13:40:57.931190 [debug] [MainThread]: SQL status: COMMIT in 0.010 seconds
[0m13:40:57.932737 [debug] [MainThread]: On master: Close
[0m13:40:57.941610 [debug] [Thread-1 (]: Began running node model.dbt_project_25.my_first_dbt_model
[0m13:40:57.943891 [info ] [Thread-1 (]: 1 of 2 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m13:40:57.946343 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_BI_group4_public, now model.dbt_project_25.my_first_dbt_model)
[0m13:40:57.948031 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.my_first_dbt_model
[0m13:40:57.962926 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.my_first_dbt_model"
[0m13:40:57.964234 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.my_first_dbt_model
[0m13:40:58.032233 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.my_first_dbt_model"
[0m13:40:58.033675 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_first_dbt_model"
[0m13:40:58.034457 [debug] [Thread-1 (]: On model.dbt_project_25.my_first_dbt_model: BEGIN
[0m13:40:58.035180 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:40:58.191113 [debug] [Thread-1 (]: SQL status: BEGIN in 0.156 seconds
[0m13:40:58.192700 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_first_dbt_model"
[0m13:40:58.194355 [debug] [Thread-1 (]: On model.dbt_project_25.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_project_25", "target_name": "dev", "node_id": "model.dbt_project_25.my_first_dbt_model"} */

  
    

  create  table "BI_group4"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m13:40:58.211041 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.015 seconds
[0m13:40:58.234601 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_first_dbt_model"
[0m13:40:58.235429 [debug] [Thread-1 (]: On model.dbt_project_25.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_project_25", "target_name": "dev", "node_id": "model.dbt_project_25.my_first_dbt_model"} */
alter table "BI_group4"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m13:40:58.246076 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m13:40:58.254067 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_first_dbt_model"
[0m13:40:58.254855 [debug] [Thread-1 (]: On model.dbt_project_25.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_project_25", "target_name": "dev", "node_id": "model.dbt_project_25.my_first_dbt_model"} */
alter table "BI_group4"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m13:40:58.265369 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m13:40:58.294920 [debug] [Thread-1 (]: On model.dbt_project_25.my_first_dbt_model: COMMIT
[0m13:40:58.295780 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_first_dbt_model"
[0m13:40:58.296495 [debug] [Thread-1 (]: On model.dbt_project_25.my_first_dbt_model: COMMIT
[0m13:40:58.308966 [debug] [Thread-1 (]: SQL status: COMMIT in 0.012 seconds
[0m13:40:58.324168 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."public"."my_first_dbt_model__dbt_backup"
[0m13:40:58.333796 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_first_dbt_model"
[0m13:40:58.334619 [debug] [Thread-1 (]: On model.dbt_project_25.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_project_25", "target_name": "dev", "node_id": "model.dbt_project_25.my_first_dbt_model"} */
drop table if exists "BI_group4"."public"."my_first_dbt_model__dbt_backup" cascade
[0m13:40:58.365426 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.030 seconds
[0m13:40:58.373924 [debug] [Thread-1 (]: On model.dbt_project_25.my_first_dbt_model: Close
[0m13:40:58.377439 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab24ba62-7d84-4b53-bf44-7455d0f227b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4af9300b30>]}
[0m13:40:58.378707 [info ] [Thread-1 (]: 1 of 2 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.43s]
[0m13:40:58.379894 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.my_first_dbt_model
[0m13:40:58.381881 [debug] [Thread-1 (]: Began running node model.dbt_project_25.my_second_dbt_model
[0m13:40:58.382838 [info ] [Thread-1 (]: 2 of 2 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m13:40:58.383721 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_25.my_first_dbt_model, now model.dbt_project_25.my_second_dbt_model)
[0m13:40:58.384483 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.my_second_dbt_model
[0m13:40:58.389386 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.my_second_dbt_model"
[0m13:40:58.390396 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.my_second_dbt_model
[0m13:40:58.423061 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.my_second_dbt_model"
[0m13:40:58.424279 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_second_dbt_model"
[0m13:40:58.425069 [debug] [Thread-1 (]: On model.dbt_project_25.my_second_dbt_model: BEGIN
[0m13:40:58.425770 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:40:58.583256 [debug] [Thread-1 (]: SQL status: BEGIN in 0.157 seconds
[0m13:40:58.584895 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_second_dbt_model"
[0m13:40:58.586517 [debug] [Thread-1 (]: On model.dbt_project_25.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_project_25", "target_name": "dev", "node_id": "model.dbt_project_25.my_second_dbt_model"} */

  create view "BI_group4"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "BI_group4"."public"."my_first_dbt_model"
where id = 1
  );
[0m13:40:58.601382 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m13:40:58.611379 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_second_dbt_model"
[0m13:40:58.612714 [debug] [Thread-1 (]: On model.dbt_project_25.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_project_25", "target_name": "dev", "node_id": "model.dbt_project_25.my_second_dbt_model"} */
alter table "BI_group4"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m13:40:58.623871 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m13:40:58.627326 [debug] [Thread-1 (]: On model.dbt_project_25.my_second_dbt_model: COMMIT
[0m13:40:58.628410 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_second_dbt_model"
[0m13:40:58.629414 [debug] [Thread-1 (]: On model.dbt_project_25.my_second_dbt_model: COMMIT
[0m13:40:58.643034 [debug] [Thread-1 (]: SQL status: COMMIT in 0.013 seconds
[0m13:40:58.649375 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."public"."my_second_dbt_model__dbt_backup"
[0m13:40:58.657432 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_second_dbt_model"
[0m13:40:58.658231 [debug] [Thread-1 (]: On model.dbt_project_25.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_project_25", "target_name": "dev", "node_id": "model.dbt_project_25.my_second_dbt_model"} */
drop view if exists "BI_group4"."public"."my_second_dbt_model__dbt_backup" cascade
[0m13:40:58.669176 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.010 seconds
[0m13:40:58.671690 [debug] [Thread-1 (]: On model.dbt_project_25.my_second_dbt_model: Close
[0m13:40:58.672914 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab24ba62-7d84-4b53-bf44-7455d0f227b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4af487dbb0>]}
[0m13:40:58.674199 [info ] [Thread-1 (]: 2 of 2 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.29s]
[0m13:40:58.675371 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.my_second_dbt_model
[0m13:40:58.678367 [debug] [MainThread]: Using postgres connection "master"
[0m13:40:58.679814 [debug] [MainThread]: On master: BEGIN
[0m13:40:58.681105 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:40:58.856268 [debug] [MainThread]: SQL status: BEGIN in 0.175 seconds
[0m13:40:58.857923 [debug] [MainThread]: On master: COMMIT
[0m13:40:58.859293 [debug] [MainThread]: Using postgres connection "master"
[0m13:40:58.860622 [debug] [MainThread]: On master: COMMIT
[0m13:40:58.872085 [debug] [MainThread]: SQL status: COMMIT in 0.010 seconds
[0m13:40:58.873197 [debug] [MainThread]: On master: Close
[0m13:40:58.874437 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:40:58.875270 [debug] [MainThread]: Connection 'model.dbt_project_25.my_second_dbt_model' was properly closed.
[0m13:40:58.876136 [info ] [MainThread]: 
[0m13:40:58.877009 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 1.97 seconds (1.97s).
[0m13:40:58.878591 [debug] [MainThread]: Command end result
[0m13:40:58.918974 [debug] [MainThread]: Wrote artifact WritableManifest to /home/evelyn.bautista@Digital-Grenoble.local/module_bi_2025/dbt_project_25/target/manifest.json
[0m13:40:58.921941 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/evelyn.bautista@Digital-Grenoble.local/module_bi_2025/dbt_project_25/target/semantic_manifest.json
[0m13:40:58.931909 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/evelyn.bautista@Digital-Grenoble.local/module_bi_2025/dbt_project_25/target/run_results.json
[0m13:40:58.932582 [info ] [MainThread]: 
[0m13:40:58.933351 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:40:58.934016 [info ] [MainThread]: 
[0m13:40:58.934713 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m13:40:58.936301 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.559959, "process_in_blocks": "19328", "process_kernel_time": 0.40965, "process_mem_max_rss": "125892", "process_out_blocks": "3440", "process_user_time": 6.3296}
[0m13:40:58.937218 [debug] [MainThread]: Command `dbt run` succeeded at 13:40:58.937033 after 5.56 seconds
[0m13:40:58.937950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4af8433fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4af8cdfe00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4af6f3f8c0>]}
[0m13:40:58.938694 [debug] [MainThread]: Flushing usage events
[0m13:40:59.382968 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:06:56.984838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71336b62d9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71336b198bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71336b62f080>]}


============================== 14:06:56.992486 | c2bc6f4a-4b30-426f-ae98-acebf8ea749e ==============================
[0m14:06:56.992486 [info ] [MainThread]: Running with dbt=1.10.2
[0m14:06:56.993540 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/evelyn.bautista@Digital-Grenoble.local/module_bi_2025/dbt_project_25/logs', 'profiles_dir': '/home/evelyn.bautista@Digital-Grenoble.local/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt test', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:06:57.308506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c2bc6f4a-4b30-426f-ae98-acebf8ea749e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71336acad640>]}
[0m14:06:57.432920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c2bc6f4a-4b30-426f-ae98-acebf8ea749e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71336a71bb00>]}
[0m14:06:57.434280 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:06:57.602430 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m14:06:57.796541 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:06:57.797281 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:06:57.864969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c2bc6f4a-4b30-426f-ae98-acebf8ea749e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71336a35fe30>]}
[0m14:06:57.992457 [debug] [MainThread]: Wrote artifact WritableManifest to /home/evelyn.bautista@Digital-Grenoble.local/module_bi_2025/dbt_project_25/target/manifest.json
[0m14:06:57.995328 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/evelyn.bautista@Digital-Grenoble.local/module_bi_2025/dbt_project_25/target/semantic_manifest.json
[0m14:06:58.037731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c2bc6f4a-4b30-426f-ae98-acebf8ea749e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7133693d4c80>]}
[0m14:06:58.038659 [info ] [MainThread]: Found 2 models, 4 data tests, 549 macros
[0m14:06:58.039440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2bc6f4a-4b30-426f-ae98-acebf8ea749e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71336a38e180>]}
[0m14:06:58.042891 [info ] [MainThread]: 
[0m14:06:58.043681 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:06:58.044304 [info ] [MainThread]: 
[0m14:06:58.045240 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:06:58.052471 [debug] [ThreadPool]: Acquiring new postgres connection 'list_BI_group4_public'
[0m14:06:58.121999 [debug] [ThreadPool]: Using postgres connection "list_BI_group4_public"
[0m14:06:58.122798 [debug] [ThreadPool]: On list_BI_group4_public: BEGIN
[0m14:06:58.123416 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:06:58.546297 [debug] [ThreadPool]: SQL status: BEGIN in 0.423 seconds
[0m14:06:58.547920 [debug] [ThreadPool]: Using postgres connection "list_BI_group4_public"
[0m14:06:58.549393 [debug] [ThreadPool]: On list_BI_group4_public: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_project_25", "target_name": "dev", "connection_name": "list_BI_group4_public"} */
select
      'BI_group4' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'BI_group4' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'BI_group4' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:06:58.567173 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.016 seconds
[0m14:06:58.572352 [debug] [ThreadPool]: On list_BI_group4_public: ROLLBACK
[0m14:06:58.583286 [debug] [ThreadPool]: On list_BI_group4_public: Close
[0m14:06:58.597984 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:58.598842 [debug] [MainThread]: On master: BEGIN
[0m14:06:58.599558 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:06:58.763844 [debug] [MainThread]: SQL status: BEGIN in 0.164 seconds
[0m14:06:58.765381 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:58.767127 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_project_25", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:06:58.801438 [debug] [MainThread]: SQL status: SELECT 1 in 0.032 seconds
[0m14:06:58.807121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2bc6f4a-4b30-426f-ae98-acebf8ea749e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713369faccb0>]}
[0m14:06:58.808873 [debug] [MainThread]: On master: ROLLBACK
[0m14:06:58.819976 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:58.820717 [debug] [MainThread]: On master: BEGIN
[0m14:06:58.841348 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m14:06:58.842824 [debug] [MainThread]: On master: COMMIT
[0m14:06:58.844185 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:58.845479 [debug] [MainThread]: On master: COMMIT
[0m14:06:58.857484 [debug] [MainThread]: SQL status: COMMIT in 0.011 seconds
[0m14:06:58.859040 [debug] [MainThread]: On master: Close
[0m14:06:58.866337 [debug] [Thread-1 (]: Began running node test.dbt_project_25.not_null_my_first_dbt_model_id.5fb22c2710
[0m14:06:58.868100 [info ] [Thread-1 (]: 1 of 4 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m14:06:58.869935 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_BI_group4_public, now test.dbt_project_25.not_null_my_first_dbt_model_id.5fb22c2710)
[0m14:06:58.871524 [debug] [Thread-1 (]: Began compiling node test.dbt_project_25.not_null_my_first_dbt_model_id.5fb22c2710
[0m14:06:58.903266 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project_25.not_null_my_first_dbt_model_id.5fb22c2710"
[0m14:06:58.904537 [debug] [Thread-1 (]: Began executing node test.dbt_project_25.not_null_my_first_dbt_model_id.5fb22c2710
[0m14:06:58.936109 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project_25.not_null_my_first_dbt_model_id.5fb22c2710"
[0m14:06:58.937405 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project_25.not_null_my_first_dbt_model_id.5fb22c2710"
[0m14:06:58.938201 [debug] [Thread-1 (]: On test.dbt_project_25.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
[0m14:06:58.938895 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:59.097887 [debug] [Thread-1 (]: SQL status: BEGIN in 0.159 seconds
[0m14:06:59.099615 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project_25.not_null_my_first_dbt_model_id.5fb22c2710"
[0m14:06:59.101202 [debug] [Thread-1 (]: On test.dbt_project_25.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_project_25", "target_name": "dev", "node_id": "test.dbt_project_25.not_null_my_first_dbt_model_id.5fb22c2710"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "BI_group4"."public"."my_first_dbt_model"
where id is null



  
  
      
    ) dbt_internal_test
[0m14:06:59.114280 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.012 seconds
[0m14:06:59.126559 [debug] [Thread-1 (]: On test.dbt_project_25.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m14:06:59.137282 [debug] [Thread-1 (]: On test.dbt_project_25.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m14:06:59.139902 [error] [Thread-1 (]: 1 of 4 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.27s]
[0m14:06:59.142349 [debug] [Thread-1 (]: Finished running node test.dbt_project_25.not_null_my_first_dbt_model_id.5fb22c2710
[0m14:06:59.144058 [debug] [Thread-1 (]: Began running node test.dbt_project_25.not_null_my_second_dbt_model_id.151b76d778
[0m14:06:59.145883 [info ] [Thread-1 (]: 2 of 4 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m14:06:59.146769 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project_25.not_null_my_first_dbt_model_id.5fb22c2710, now test.dbt_project_25.not_null_my_second_dbt_model_id.151b76d778)
[0m14:06:59.147529 [debug] [Thread-1 (]: Began compiling node test.dbt_project_25.not_null_my_second_dbt_model_id.151b76d778
[0m14:06:59.155310 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project_25.not_null_my_second_dbt_model_id.151b76d778"
[0m14:06:59.156361 [debug] [Thread-1 (]: Began executing node test.dbt_project_25.not_null_my_second_dbt_model_id.151b76d778
[0m14:06:59.161029 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project_25.not_null_my_second_dbt_model_id.151b76d778"
[0m14:06:59.162164 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project_25.not_null_my_second_dbt_model_id.151b76d778"
[0m14:06:59.162946 [debug] [Thread-1 (]: On test.dbt_project_25.not_null_my_second_dbt_model_id.151b76d778: BEGIN
[0m14:06:59.163654 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:59.322245 [debug] [Thread-1 (]: SQL status: BEGIN in 0.158 seconds
[0m14:06:59.324018 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project_25.not_null_my_second_dbt_model_id.151b76d778"
[0m14:06:59.325631 [debug] [Thread-1 (]: On test.dbt_project_25.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_project_25", "target_name": "dev", "node_id": "test.dbt_project_25.not_null_my_second_dbt_model_id.151b76d778"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "BI_group4"."public"."my_second_dbt_model"
where id is null



  
  
      
    ) dbt_internal_test
[0m14:06:59.338197 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.011 seconds
[0m14:06:59.344271 [debug] [Thread-1 (]: On test.dbt_project_25.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
[0m14:06:59.355588 [debug] [Thread-1 (]: On test.dbt_project_25.not_null_my_second_dbt_model_id.151b76d778: Close
[0m14:06:59.357057 [info ] [Thread-1 (]: 2 of 4 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.21s]
[0m14:06:59.358767 [debug] [Thread-1 (]: Finished running node test.dbt_project_25.not_null_my_second_dbt_model_id.151b76d778
[0m14:06:59.359909 [debug] [Thread-1 (]: Began running node test.dbt_project_25.unique_my_first_dbt_model_id.16e066b321
[0m14:06:59.360990 [info ] [Thread-1 (]: 3 of 4 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m14:06:59.362375 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project_25.not_null_my_second_dbt_model_id.151b76d778, now test.dbt_project_25.unique_my_first_dbt_model_id.16e066b321)
[0m14:06:59.363452 [debug] [Thread-1 (]: Began compiling node test.dbt_project_25.unique_my_first_dbt_model_id.16e066b321
[0m14:06:59.376248 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project_25.unique_my_first_dbt_model_id.16e066b321"
[0m14:06:59.377437 [debug] [Thread-1 (]: Began executing node test.dbt_project_25.unique_my_first_dbt_model_id.16e066b321
[0m14:06:59.382258 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project_25.unique_my_first_dbt_model_id.16e066b321"
[0m14:06:59.383465 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project_25.unique_my_first_dbt_model_id.16e066b321"
[0m14:06:59.384257 [debug] [Thread-1 (]: On test.dbt_project_25.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m14:06:59.384981 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:59.539022 [debug] [Thread-1 (]: SQL status: BEGIN in 0.154 seconds
[0m14:06:59.540836 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project_25.unique_my_first_dbt_model_id.16e066b321"
[0m14:06:59.542463 [debug] [Thread-1 (]: On test.dbt_project_25.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_project_25", "target_name": "dev", "node_id": "test.dbt_project_25.unique_my_first_dbt_model_id.16e066b321"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "BI_group4"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:06:59.554418 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.010 seconds
[0m14:06:59.557890 [debug] [Thread-1 (]: On test.dbt_project_25.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m14:06:59.568267 [debug] [Thread-1 (]: On test.dbt_project_25.unique_my_first_dbt_model_id.16e066b321: Close
[0m14:06:59.570349 [info ] [Thread-1 (]: 3 of 4 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.21s]
[0m14:06:59.572257 [debug] [Thread-1 (]: Finished running node test.dbt_project_25.unique_my_first_dbt_model_id.16e066b321
[0m14:06:59.573605 [debug] [Thread-1 (]: Began running node test.dbt_project_25.unique_my_second_dbt_model_id.57a0f8c493
[0m14:06:59.574872 [info ] [Thread-1 (]: 4 of 4 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m14:06:59.576457 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project_25.unique_my_first_dbt_model_id.16e066b321, now test.dbt_project_25.unique_my_second_dbt_model_id.57a0f8c493)
[0m14:06:59.577767 [debug] [Thread-1 (]: Began compiling node test.dbt_project_25.unique_my_second_dbt_model_id.57a0f8c493
[0m14:06:59.585379 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project_25.unique_my_second_dbt_model_id.57a0f8c493"
[0m14:06:59.586412 [debug] [Thread-1 (]: Began executing node test.dbt_project_25.unique_my_second_dbt_model_id.57a0f8c493
[0m14:06:59.593545 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project_25.unique_my_second_dbt_model_id.57a0f8c493"
[0m14:06:59.594705 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project_25.unique_my_second_dbt_model_id.57a0f8c493"
[0m14:06:59.595467 [debug] [Thread-1 (]: On test.dbt_project_25.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
[0m14:06:59.596183 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:59.755011 [debug] [Thread-1 (]: SQL status: BEGIN in 0.158 seconds
[0m14:06:59.756754 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project_25.unique_my_second_dbt_model_id.57a0f8c493"
[0m14:06:59.758369 [debug] [Thread-1 (]: On test.dbt_project_25.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_project_25", "target_name": "dev", "node_id": "test.dbt_project_25.unique_my_second_dbt_model_id.57a0f8c493"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "BI_group4"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:06:59.775046 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.015 seconds
[0m14:06:59.780320 [debug] [Thread-1 (]: On test.dbt_project_25.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
[0m14:06:59.791133 [debug] [Thread-1 (]: On test.dbt_project_25.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m14:06:59.793718 [info ] [Thread-1 (]: 4 of 4 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.22s]
[0m14:06:59.796113 [debug] [Thread-1 (]: Finished running node test.dbt_project_25.unique_my_second_dbt_model_id.57a0f8c493
[0m14:06:59.800273 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:59.801688 [debug] [MainThread]: On master: BEGIN
[0m14:06:59.802967 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:06:59.967667 [debug] [MainThread]: SQL status: BEGIN in 0.165 seconds
[0m14:06:59.969272 [debug] [MainThread]: On master: COMMIT
[0m14:06:59.970672 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:59.971981 [debug] [MainThread]: On master: COMMIT
[0m14:06:59.983296 [debug] [MainThread]: SQL status: COMMIT in 0.010 seconds
[0m14:06:59.984786 [debug] [MainThread]: On master: Close
[0m14:06:59.986709 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:06:59.988011 [debug] [MainThread]: Connection 'test.dbt_project_25.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m14:06:59.989350 [info ] [MainThread]: 
[0m14:06:59.990790 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 1.94 seconds (1.94s).
[0m14:06:59.993004 [debug] [MainThread]: Command end result
[0m14:07:00.031152 [debug] [MainThread]: Wrote artifact WritableManifest to /home/evelyn.bautista@Digital-Grenoble.local/module_bi_2025/dbt_project_25/target/manifest.json
[0m14:07:00.034121 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/evelyn.bautista@Digital-Grenoble.local/module_bi_2025/dbt_project_25/target/semantic_manifest.json
[0m14:07:00.045744 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/evelyn.bautista@Digital-Grenoble.local/module_bi_2025/dbt_project_25/target/run_results.json
[0m14:07:00.046439 [info ] [MainThread]: 
[0m14:07:00.047176 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:07:00.047848 [info ] [MainThread]: 
[0m14:07:00.048631 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
[0m14:07:00.049383 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m14:07:00.049998 [info ] [MainThread]: 
[0m14:07:00.050735 [info ] [MainThread]:   compiled code at target/compiled/dbt_project_25/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m14:07:00.051374 [info ] [MainThread]: 
[0m14:07:00.052080 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m14:07:00.053711 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 3.1737316, "process_in_blocks": "1128", "process_kernel_time": 0.356813, "process_mem_max_rss": "122792", "process_out_blocks": "2344", "process_user_time": 4.048232}
[0m14:07:00.054660 [debug] [MainThread]: Command `dbt test` failed at 14:07:00.054460 after 3.17 seconds
[0m14:07:00.055405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71336d0a3d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71336bcfe120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71336b470d40>]}
[0m14:07:00.056165 [debug] [MainThread]: Flushing usage events
[0m14:07:00.495942 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:07:23.400087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c20b7c38440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c20b7540f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c20bab5a4b0>]}


============================== 14:07:23.407523 | 744d386e-c46d-400a-8bde-f12f05f84bc8 ==============================
[0m14:07:23.407523 [info ] [MainThread]: Running with dbt=1.10.2
[0m14:07:23.408583 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/evelyn.bautista@Digital-Grenoble.local/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/evelyn.bautista@Digital-Grenoble.local/module_bi_2025/dbt_project_25/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m14:07:23.424856 [info ] [MainThread]: dbt version: 1.10.2
[0m14:07:23.425625 [info ] [MainThread]: python version: 3.12.11
[0m14:07:23.426265 [info ] [MainThread]: python path: /home/evelyn.bautista@Digital-Grenoble.local/anaconda3/envs/BI/bin/python3.12
[0m14:07:23.426904 [info ] [MainThread]: os info: Linux-6.11.0-28-generic-x86_64-with-glibc2.39
[0m14:07:23.517477 [info ] [MainThread]: Using profiles dir at /home/evelyn.bautista@Digital-Grenoble.local/.dbt
[0m14:07:23.518280 [info ] [MainThread]: Using profiles.yml file at /home/evelyn.bautista@Digital-Grenoble.local/.dbt/profiles.yml
[0m14:07:23.518942 [info ] [MainThread]: Using dbt_project.yml file at /home/evelyn.bautista@Digital-Grenoble.local/module_bi_2025/dbt_project_25/dbt_project.yml
[0m14:07:23.519841 [info ] [MainThread]: adapter type: postgres
[0m14:07:23.520502 [info ] [MainThread]: adapter version: 1.9.0
[0m14:07:23.731022 [info ] [MainThread]: Configuration:
[0m14:07:23.731858 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:07:23.732505 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:07:23.733142 [info ] [MainThread]: Required dependencies:
[0m14:07:23.733803 [debug] [MainThread]: Executing "git --help"
[0m14:07:23.741755 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:07:23.742672 [debug] [MainThread]: STDERR: "b''"
[0m14:07:23.743290 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:07:23.743943 [info ] [MainThread]: Connection:
[0m14:07:23.744587 [info ] [MainThread]:   host: 51.159.205.157
[0m14:07:23.745199 [info ] [MainThread]:   port: 15030
[0m14:07:23.745814 [info ] [MainThread]:   user: binome4
[0m14:07:23.746412 [info ] [MainThread]:   database: BI_group4
[0m14:07:23.747027 [info ] [MainThread]:   schema: public
[0m14:07:23.747646 [info ] [MainThread]:   connect_timeout: 10
[0m14:07:23.748252 [info ] [MainThread]:   role: None
[0m14:07:23.748872 [info ] [MainThread]:   search_path: None
[0m14:07:23.749469 [info ] [MainThread]:   keepalives_idle: 0
[0m14:07:23.750088 [info ] [MainThread]:   sslmode: None
[0m14:07:23.750699 [info ] [MainThread]:   sslcert: None
[0m14:07:23.751285 [info ] [MainThread]:   sslkey: None
[0m14:07:23.751891 [info ] [MainThread]:   sslrootcert: None
[0m14:07:23.752482 [info ] [MainThread]:   application_name: dbt
[0m14:07:23.753088 [info ] [MainThread]:   retries: 1
[0m14:07:23.753948 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:07:23.900887 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m14:07:23.942468 [debug] [MainThread]: Using postgres connection "debug"
[0m14:07:23.943255 [debug] [MainThread]: On debug: select 1 as id
[0m14:07:23.943881 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:07:24.103967 [debug] [MainThread]: SQL status: SELECT 1 in 0.160 seconds
[0m14:07:24.107651 [debug] [MainThread]: On debug: Close
[0m14:07:24.109171 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m14:07:24.110333 [info ] [MainThread]: [32mAll checks passed![0m
[0m14:07:24.112968 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.8166259, "process_in_blocks": "96", "process_kernel_time": 0.312093, "process_mem_max_rss": "114832", "process_out_blocks": "24", "process_user_time": 2.973364}
[0m14:07:24.114519 [debug] [MainThread]: Command `dbt debug` succeeded at 14:07:24.114210 after 0.82 seconds
[0m14:07:24.115635 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:07:24.116812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c20b9687080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c20b6512720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c20b7782f60>]}
[0m14:07:24.118134 [debug] [MainThread]: Flushing usage events
[0m14:07:24.476285 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:10:06.846307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c64d397e060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c64d14a8bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c64d3451ee0>]}


============================== 14:10:06.853861 | 3e1e354a-10eb-4c42-8cea-e46dd1c0db51 ==============================
[0m14:10:06.853861 [info ] [MainThread]: Running with dbt=1.10.2
[0m14:10:06.854919 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/evelyn.bautista@Digital-Grenoble.local/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/evelyn.bautista@Digital-Grenoble.local/module_bi_2025/dbt_project_25/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:10:07.167434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e1e354a-10eb-4c42-8cea-e46dd1c0db51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c64d382f470>]}
[0m14:10:07.291896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3e1e354a-10eb-4c42-8cea-e46dd1c0db51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c64d1823b00>]}
[0m14:10:07.293272 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:10:07.460269 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m14:10:07.654127 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:10:07.654873 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:10:07.723945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3e1e354a-10eb-4c42-8cea-e46dd1c0db51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c64d092f080>]}
[0m14:10:07.850720 [debug] [MainThread]: Wrote artifact WritableManifest to /home/evelyn.bautista@Digital-Grenoble.local/module_bi_2025/dbt_project_25/target/manifest.json
[0m14:10:07.853515 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/evelyn.bautista@Digital-Grenoble.local/module_bi_2025/dbt_project_25/target/semantic_manifest.json
[0m14:10:07.890149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3e1e354a-10eb-4c42-8cea-e46dd1c0db51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c64cf9a4ce0>]}
[0m14:10:07.891032 [info ] [MainThread]: Found 2 models, 4 data tests, 549 macros
[0m14:10:07.891741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e1e354a-10eb-4c42-8cea-e46dd1c0db51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c64cfdc67e0>]}
[0m14:10:07.895117 [info ] [MainThread]: 
[0m14:10:07.895848 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:10:07.896457 [info ] [MainThread]: 
[0m14:10:07.897386 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:10:07.905209 [debug] [ThreadPool]: Acquiring new postgres connection 'list_BI_group4_public'
[0m14:10:07.977335 [debug] [ThreadPool]: Using postgres connection "list_BI_group4_public"
[0m14:10:07.978125 [debug] [ThreadPool]: On list_BI_group4_public: BEGIN
[0m14:10:07.978759 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:10:08.149740 [debug] [ThreadPool]: SQL status: BEGIN in 0.171 seconds
[0m14:10:08.151313 [debug] [ThreadPool]: Using postgres connection "list_BI_group4_public"
[0m14:10:08.152790 [debug] [ThreadPool]: On list_BI_group4_public: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_project_25", "target_name": "dev", "connection_name": "list_BI_group4_public"} */
select
      'BI_group4' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'BI_group4' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'BI_group4' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:10:08.172874 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.019 seconds
[0m14:10:08.177992 [debug] [ThreadPool]: On list_BI_group4_public: ROLLBACK
[0m14:10:08.190060 [debug] [ThreadPool]: On list_BI_group4_public: Close
[0m14:10:08.203636 [debug] [MainThread]: Using postgres connection "master"
[0m14:10:08.204371 [debug] [MainThread]: On master: BEGIN
[0m14:10:08.205024 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:10:08.370022 [debug] [MainThread]: SQL status: BEGIN in 0.165 seconds
[0m14:10:08.371491 [debug] [MainThread]: Using postgres connection "master"
[0m14:10:08.373218 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_project_25", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:10:08.408031 [debug] [MainThread]: SQL status: SELECT 1 in 0.033 seconds
[0m14:10:08.413633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e1e354a-10eb-4c42-8cea-e46dd1c0db51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c64d0967a10>]}
[0m14:10:08.415325 [debug] [MainThread]: On master: ROLLBACK
[0m14:10:08.426419 [debug] [MainThread]: Using postgres connection "master"
[0m14:10:08.427274 [debug] [MainThread]: On master: BEGIN
[0m14:10:08.447121 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m14:10:08.448541 [debug] [MainThread]: On master: COMMIT
[0m14:10:08.449903 [debug] [MainThread]: Using postgres connection "master"
[0m14:10:08.451196 [debug] [MainThread]: On master: COMMIT
[0m14:10:08.462397 [debug] [MainThread]: SQL status: COMMIT in 0.010 seconds
[0m14:10:08.463889 [debug] [MainThread]: On master: Close
[0m14:10:08.471359 [debug] [Thread-1 (]: Began running node test.dbt_project_25.not_null_my_first_dbt_model_id.5fb22c2710
[0m14:10:08.473094 [info ] [Thread-1 (]: 1 of 4 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m14:10:08.474892 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_BI_group4_public, now test.dbt_project_25.not_null_my_first_dbt_model_id.5fb22c2710)
[0m14:10:08.476455 [debug] [Thread-1 (]: Began compiling node test.dbt_project_25.not_null_my_first_dbt_model_id.5fb22c2710
[0m14:10:08.509268 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project_25.not_null_my_first_dbt_model_id.5fb22c2710"
[0m14:10:08.510500 [debug] [Thread-1 (]: Began executing node test.dbt_project_25.not_null_my_first_dbt_model_id.5fb22c2710
[0m14:10:08.541889 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project_25.not_null_my_first_dbt_model_id.5fb22c2710"
[0m14:10:08.543108 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project_25.not_null_my_first_dbt_model_id.5fb22c2710"
[0m14:10:08.543900 [debug] [Thread-1 (]: On test.dbt_project_25.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
[0m14:10:08.544597 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:08.737701 [debug] [Thread-1 (]: SQL status: BEGIN in 0.193 seconds
[0m14:10:08.739418 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project_25.not_null_my_first_dbt_model_id.5fb22c2710"
[0m14:10:08.741050 [debug] [Thread-1 (]: On test.dbt_project_25.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_project_25", "target_name": "dev", "node_id": "test.dbt_project_25.not_null_my_first_dbt_model_id.5fb22c2710"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "BI_group4"."public"."my_first_dbt_model"
where id is null



  
  
      
    ) dbt_internal_test
[0m14:10:08.755283 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.013 seconds
[0m14:10:08.766401 [debug] [Thread-1 (]: On test.dbt_project_25.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m14:10:08.777055 [debug] [Thread-1 (]: On test.dbt_project_25.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m14:10:08.779005 [error] [Thread-1 (]: 1 of 4 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.30s]
[0m14:10:08.780684 [debug] [Thread-1 (]: Finished running node test.dbt_project_25.not_null_my_first_dbt_model_id.5fb22c2710
[0m14:10:08.781844 [debug] [Thread-1 (]: Began running node test.dbt_project_25.not_null_my_second_dbt_model_id.151b76d778
[0m14:10:08.782892 [info ] [Thread-1 (]: 2 of 4 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m14:10:08.783977 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project_25.not_null_my_first_dbt_model_id.5fb22c2710, now test.dbt_project_25.not_null_my_second_dbt_model_id.151b76d778)
[0m14:10:08.784760 [debug] [Thread-1 (]: Began compiling node test.dbt_project_25.not_null_my_second_dbt_model_id.151b76d778
[0m14:10:08.792444 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project_25.not_null_my_second_dbt_model_id.151b76d778"
[0m14:10:08.793557 [debug] [Thread-1 (]: Began executing node test.dbt_project_25.not_null_my_second_dbt_model_id.151b76d778
[0m14:10:08.798235 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project_25.not_null_my_second_dbt_model_id.151b76d778"
[0m14:10:08.799380 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project_25.not_null_my_second_dbt_model_id.151b76d778"
[0m14:10:08.800164 [debug] [Thread-1 (]: On test.dbt_project_25.not_null_my_second_dbt_model_id.151b76d778: BEGIN
[0m14:10:08.800876 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:08.969897 [debug] [Thread-1 (]: SQL status: BEGIN in 0.169 seconds
[0m14:10:08.971670 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project_25.not_null_my_second_dbt_model_id.151b76d778"
[0m14:10:08.973278 [debug] [Thread-1 (]: On test.dbt_project_25.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_project_25", "target_name": "dev", "node_id": "test.dbt_project_25.not_null_my_second_dbt_model_id.151b76d778"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "BI_group4"."public"."my_second_dbt_model"
where id is null



  
  
      
    ) dbt_internal_test
[0m14:10:08.987356 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.013 seconds
[0m14:10:08.993438 [debug] [Thread-1 (]: On test.dbt_project_25.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
[0m14:10:09.006208 [debug] [Thread-1 (]: On test.dbt_project_25.not_null_my_second_dbt_model_id.151b76d778: Close
[0m14:10:09.008155 [info ] [Thread-1 (]: 2 of 4 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.22s]
[0m14:10:09.009923 [debug] [Thread-1 (]: Finished running node test.dbt_project_25.not_null_my_second_dbt_model_id.151b76d778
[0m14:10:09.011160 [debug] [Thread-1 (]: Began running node test.dbt_project_25.unique_my_first_dbt_model_id.16e066b321
[0m14:10:09.012900 [info ] [Thread-1 (]: 3 of 4 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m14:10:09.014807 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project_25.not_null_my_second_dbt_model_id.151b76d778, now test.dbt_project_25.unique_my_first_dbt_model_id.16e066b321)
[0m14:10:09.016389 [debug] [Thread-1 (]: Began compiling node test.dbt_project_25.unique_my_first_dbt_model_id.16e066b321
[0m14:10:09.032108 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project_25.unique_my_first_dbt_model_id.16e066b321"
[0m14:10:09.033283 [debug] [Thread-1 (]: Began executing node test.dbt_project_25.unique_my_first_dbt_model_id.16e066b321
[0m14:10:09.037901 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project_25.unique_my_first_dbt_model_id.16e066b321"
[0m14:10:09.039058 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project_25.unique_my_first_dbt_model_id.16e066b321"
[0m14:10:09.039837 [debug] [Thread-1 (]: On test.dbt_project_25.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m14:10:09.040537 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:09.200093 [debug] [Thread-1 (]: SQL status: BEGIN in 0.159 seconds
[0m14:10:09.201872 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project_25.unique_my_first_dbt_model_id.16e066b321"
[0m14:10:09.203494 [debug] [Thread-1 (]: On test.dbt_project_25.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_project_25", "target_name": "dev", "node_id": "test.dbt_project_25.unique_my_first_dbt_model_id.16e066b321"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "BI_group4"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:10:09.216706 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.011 seconds
[0m14:10:09.222199 [debug] [Thread-1 (]: On test.dbt_project_25.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m14:10:09.233897 [debug] [Thread-1 (]: On test.dbt_project_25.unique_my_first_dbt_model_id.16e066b321: Close
[0m14:10:09.235217 [info ] [Thread-1 (]: 3 of 4 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.22s]
[0m14:10:09.236600 [debug] [Thread-1 (]: Finished running node test.dbt_project_25.unique_my_first_dbt_model_id.16e066b321
[0m14:10:09.237659 [debug] [Thread-1 (]: Began running node test.dbt_project_25.unique_my_second_dbt_model_id.57a0f8c493
[0m14:10:09.238677 [info ] [Thread-1 (]: 4 of 4 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m14:10:09.239944 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project_25.unique_my_first_dbt_model_id.16e066b321, now test.dbt_project_25.unique_my_second_dbt_model_id.57a0f8c493)
[0m14:10:09.240939 [debug] [Thread-1 (]: Began compiling node test.dbt_project_25.unique_my_second_dbt_model_id.57a0f8c493
[0m14:10:09.249533 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project_25.unique_my_second_dbt_model_id.57a0f8c493"
[0m14:10:09.250648 [debug] [Thread-1 (]: Began executing node test.dbt_project_25.unique_my_second_dbt_model_id.57a0f8c493
[0m14:10:09.257782 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project_25.unique_my_second_dbt_model_id.57a0f8c493"
[0m14:10:09.258990 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project_25.unique_my_second_dbt_model_id.57a0f8c493"
[0m14:10:09.259775 [debug] [Thread-1 (]: On test.dbt_project_25.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
[0m14:10:09.260473 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:09.420523 [debug] [Thread-1 (]: SQL status: BEGIN in 0.160 seconds
[0m14:10:09.422302 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project_25.unique_my_second_dbt_model_id.57a0f8c493"
[0m14:10:09.423979 [debug] [Thread-1 (]: On test.dbt_project_25.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_project_25", "target_name": "dev", "node_id": "test.dbt_project_25.unique_my_second_dbt_model_id.57a0f8c493"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "BI_group4"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:10:09.438060 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.012 seconds
[0m14:10:09.442998 [debug] [Thread-1 (]: On test.dbt_project_25.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
[0m14:10:09.454469 [debug] [Thread-1 (]: On test.dbt_project_25.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m14:10:09.455790 [info ] [Thread-1 (]: 4 of 4 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.22s]
[0m14:10:09.456956 [debug] [Thread-1 (]: Finished running node test.dbt_project_25.unique_my_second_dbt_model_id.57a0f8c493
[0m14:10:09.460541 [debug] [MainThread]: Using postgres connection "master"
[0m14:10:09.461976 [debug] [MainThread]: On master: BEGIN
[0m14:10:09.463249 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:10:09.684262 [debug] [MainThread]: SQL status: BEGIN in 0.221 seconds
[0m14:10:09.685865 [debug] [MainThread]: On master: COMMIT
[0m14:10:09.687231 [debug] [MainThread]: Using postgres connection "master"
[0m14:10:09.688529 [debug] [MainThread]: On master: COMMIT
[0m14:10:09.699648 [debug] [MainThread]: SQL status: COMMIT in 0.010 seconds
[0m14:10:09.701136 [debug] [MainThread]: On master: Close
[0m14:10:09.703081 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:10:09.704399 [debug] [MainThread]: Connection 'test.dbt_project_25.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m14:10:09.705763 [info ] [MainThread]: 
[0m14:10:09.707207 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 1.81 seconds (1.81s).
[0m14:10:09.710101 [debug] [MainThread]: Command end result
[0m14:10:09.747886 [debug] [MainThread]: Wrote artifact WritableManifest to /home/evelyn.bautista@Digital-Grenoble.local/module_bi_2025/dbt_project_25/target/manifest.json
[0m14:10:09.750866 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/evelyn.bautista@Digital-Grenoble.local/module_bi_2025/dbt_project_25/target/semantic_manifest.json
[0m14:10:09.762452 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/evelyn.bautista@Digital-Grenoble.local/module_bi_2025/dbt_project_25/target/run_results.json
[0m14:10:09.763134 [info ] [MainThread]: 
[0m14:10:09.763863 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:10:09.764523 [info ] [MainThread]: 
[0m14:10:09.765310 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
[0m14:10:09.766080 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m14:10:09.766699 [info ] [MainThread]: 
[0m14:10:09.767422 [info ] [MainThread]:   compiled code at target/compiled/dbt_project_25/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m14:10:09.768068 [info ] [MainThread]: 
[0m14:10:09.768769 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m14:10:09.770381 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 3.0286524, "process_in_blocks": "0", "process_kernel_time": 0.343422, "process_mem_max_rss": "123080", "process_out_blocks": "2352", "process_user_time": 4.02795}
[0m14:10:09.771311 [debug] [MainThread]: Command `dbt test` failed at 14:10:09.771129 after 3.03 seconds
[0m14:10:09.772079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c64d1bd1880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c64d14fd760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c64d2021b20>]}
[0m14:10:09.772838 [debug] [MainThread]: Flushing usage events
[0m14:10:10.200698 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:18:03.578925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77175f79ade0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x771762af26f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77176012fbf0>]}


============================== 15:18:03.586438 | 1aa63b55-bf12-4f73-9d25-45c63103096c ==============================
[0m15:18:03.586438 [info ] [MainThread]: Running with dbt=1.10.2
[0m15:18:03.587487 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/evelyn.bautista@Digital-Grenoble.local/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/evelyn.bautista@Digital-Grenoble.local/module_bi_2025/dbt_project_25/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:18:03.602247 [info ] [MainThread]: dbt version: 1.10.2
[0m15:18:03.602984 [info ] [MainThread]: python version: 3.12.11
[0m15:18:03.603623 [info ] [MainThread]: python path: /home/evelyn.bautista@Digital-Grenoble.local/anaconda3/envs/BI/bin/python3.12
[0m15:18:03.604244 [info ] [MainThread]: os info: Linux-6.11.0-28-generic-x86_64-with-glibc2.39
[0m15:18:03.694682 [info ] [MainThread]: Using profiles dir at /home/evelyn.bautista@Digital-Grenoble.local/.dbt
[0m15:18:03.695481 [info ] [MainThread]: Using profiles.yml file at /home/evelyn.bautista@Digital-Grenoble.local/.dbt/profiles.yml
[0m15:18:03.696133 [info ] [MainThread]: Using dbt_project.yml file at /home/evelyn.bautista@Digital-Grenoble.local/module_bi_2025/dbt_project_25/dbt_project.yml
[0m15:18:03.697042 [info ] [MainThread]: adapter type: postgres
[0m15:18:03.697703 [info ] [MainThread]: adapter version: 1.9.0
[0m15:18:03.907465 [info ] [MainThread]: Configuration:
[0m15:18:03.908275 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:18:03.908932 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:18:03.909545 [info ] [MainThread]: Required dependencies:
[0m15:18:03.910205 [debug] [MainThread]: Executing "git --help"
[0m15:18:03.916247 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:18:03.917109 [debug] [MainThread]: STDERR: "b''"
[0m15:18:03.917730 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:18:03.918365 [info ] [MainThread]: Connection:
[0m15:18:03.919028 [info ] [MainThread]:   host: 51.159.205.157
[0m15:18:03.919651 [info ] [MainThread]:   port: 15030
[0m15:18:03.920244 [info ] [MainThread]:   user: binome4
[0m15:18:03.920854 [info ] [MainThread]:   database: BI_group4
[0m15:18:03.921449 [info ] [MainThread]:   schema: public
[0m15:18:03.922061 [info ] [MainThread]:   connect_timeout: 10
[0m15:18:03.922686 [info ] [MainThread]:   role: None
[0m15:18:03.923288 [info ] [MainThread]:   search_path: None
[0m15:18:03.923908 [info ] [MainThread]:   keepalives_idle: 0
[0m15:18:03.924507 [info ] [MainThread]:   sslmode: None
[0m15:18:03.925127 [info ] [MainThread]:   sslcert: None
[0m15:18:03.925778 [info ] [MainThread]:   sslkey: None
[0m15:18:03.926379 [info ] [MainThread]:   sslrootcert: None
[0m15:18:03.926999 [info ] [MainThread]:   application_name: dbt
[0m15:18:03.927608 [info ] [MainThread]:   retries: 1
[0m15:18:03.928440 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:18:04.073306 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m15:18:04.114667 [debug] [MainThread]: Using postgres connection "debug"
[0m15:18:04.115417 [debug] [MainThread]: On debug: select 1 as id
[0m15:18:04.116040 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:18:04.413971 [debug] [MainThread]: SQL status: SELECT 1 in 0.298 seconds
[0m15:18:04.417615 [debug] [MainThread]: On debug: Close
[0m15:18:04.419248 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m15:18:04.420662 [info ] [MainThread]: [32mAll checks passed![0m
[0m15:18:04.422477 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.94750726, "process_in_blocks": "0", "process_kernel_time": 0.306818, "process_mem_max_rss": "114844", "process_out_blocks": "24", "process_user_time": 2.978241}
[0m15:18:04.423550 [debug] [MainThread]: Command `dbt debug` succeeded at 15:18:04.423336 after 0.95 seconds
[0m15:18:04.424304 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:18:04.425107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77175fb4f410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7717637fb410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77175f33fd70>]}
[0m15:18:04.426006 [debug] [MainThread]: Flushing usage events
[0m15:18:04.857707 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:06:47.979732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e25e6287fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e25e46f8ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e25e47e33e0>]}


============================== 16:06:47.987470 | ca983a01-c80f-45f8-b2db-90b3266862cc ==============================
[0m16:06:47.987470 [info ] [MainThread]: Running with dbt=1.10.2
[0m16:06:47.988503 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/evelyn.bautista@Digital-Grenoble.local/module_bi_2025/BI_DBT/logs', 'fail_fast': 'False', 'profiles_dir': '/home/evelyn.bautista@Digital-Grenoble.local/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:06:47.992905 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'dbt_project_25'
[0m16:06:47.994482 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.11863293, "process_in_blocks": "0", "process_kernel_time": 0.244642, "process_mem_max_rss": "100096", "process_out_blocks": "8", "process_user_time": 2.48237}
[0m16:06:47.995369 [debug] [MainThread]: Command `dbt run` failed at 16:06:47.995171 after 0.12 seconds
[0m16:06:47.996052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e25e47b1dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e25e81fb3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e25e3fda210>]}
[0m16:06:47.996796 [debug] [MainThread]: Flushing usage events
[0m16:06:48.352264 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:08:45.882827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x719451a15c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x719451958470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x719451a15d60>]}


============================== 16:08:45.890382 | 272b25db-30a0-443c-9828-ac290b9121df ==============================
[0m16:08:45.890382 [info ] [MainThread]: Running with dbt=1.10.2
[0m16:08:45.891423 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/evelyn.bautista@Digital-Grenoble.local/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/evelyn.bautista@Digital-Grenoble.local/module_bi_2025/BI_DBT/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:08:46.203156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '272b25db-30a0-443c-9828-ac290b9121df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7194510a5130>]}
[0m16:08:46.326210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '272b25db-30a0-443c-9828-ac290b9121df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x719452eb6450>]}
[0m16:08:46.327546 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:08:46.494794 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m16:08:46.654362 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m16:08:46.655150 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:08:46.655834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '272b25db-30a0-443c-9828-ac290b9121df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7194518a5a00>]}
[0m16:08:49.164606 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_project_25.stg_productcat' (models/Staging/stg_productcat.sql) depends on a source named 'raw.productcategory' which was not found
[0m16:08:49.166410 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.3874934, "process_in_blocks": "0", "process_kernel_time": 0.294848, "process_mem_max_rss": "115544", "process_out_blocks": "16", "process_user_time": 5.695064}
[0m16:08:49.167350 [debug] [MainThread]: Command `dbt run` failed at 16:08:49.167149 after 3.39 seconds
[0m16:08:49.168083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x719453a96120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71944f771670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x719453820a10>]}
[0m16:08:49.168835 [debug] [MainThread]: Flushing usage events
[0m16:08:49.595571 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:09:45.236813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccd7bbf70b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccd7c176b40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccd7c177fe0>]}


============================== 16:09:45.244300 | 54cb0bce-0271-4397-83cf-38cafc627d17 ==============================
[0m16:09:45.244300 [info ] [MainThread]: Running with dbt=1.10.2
[0m16:09:45.245347 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/evelyn.bautista@Digital-Grenoble.local/.dbt', 'log_path': '/home/evelyn.bautista@Digital-Grenoble.local/module_bi_2025/BI_DBT/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m16:09:45.559517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '54cb0bce-0271-4397-83cf-38cafc627d17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccd7dd22e70>]}
[0m16:09:45.683650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '54cb0bce-0271-4397-83cf-38cafc627d17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccd7ba7bb00>]}
[0m16:09:45.684989 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:09:45.852821 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m16:09:46.013525 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m16:09:46.014330 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:09:46.014999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '54cb0bce-0271-4397-83cf-38cafc627d17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccd7bbb15e0>]}
[0m16:09:48.702602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '54cb0bce-0271-4397-83cf-38cafc627d17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccd79d4fb60>]}
[0m16:09:48.845375 [debug] [MainThread]: Wrote artifact WritableManifest to /home/evelyn.bautista@Digital-Grenoble.local/module_bi_2025/BI_DBT/target/manifest.json
[0m16:09:48.848243 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/evelyn.bautista@Digital-Grenoble.local/module_bi_2025/BI_DBT/target/semantic_manifest.json
[0m16:09:48.869911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '54cb0bce-0271-4397-83cf-38cafc627d17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccd795ade50>]}
[0m16:09:48.870775 [info ] [MainThread]: Found 5 models, 4 data tests, 3 sources, 549 macros
[0m16:09:48.871483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54cb0bce-0271-4397-83cf-38cafc627d17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccd79d96c60>]}
[0m16:09:48.874794 [info ] [MainThread]: 
[0m16:09:48.875518 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:09:48.876128 [info ] [MainThread]: 
[0m16:09:48.877034 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:09:48.884686 [debug] [ThreadPool]: Acquiring new postgres connection 'list_BI_group4'
[0m16:09:48.950221 [debug] [ThreadPool]: Using postgres connection "list_BI_group4"
[0m16:09:48.951003 [debug] [ThreadPool]: On list_BI_group4: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "connection_name": "list_BI_group4"} */

    select distinct nspname from pg_namespace
  
[0m16:09:48.951642 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:09:49.120028 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.168 seconds
[0m16:09:49.124920 [debug] [ThreadPool]: On list_BI_group4: Close
[0m16:09:49.132371 [debug] [ThreadPool]: Using postgres connection "list_BI_group4"
[0m16:09:49.133053 [debug] [ThreadPool]: On list_BI_group4: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "connection_name": "list_BI_group4"} */

    select distinct nspname from pg_namespace
  
[0m16:09:49.133667 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:09:49.317869 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.184 seconds
[0m16:09:49.322520 [debug] [ThreadPool]: On list_BI_group4: Close
[0m16:09:49.325287 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_BI_group4, now create_BI_group4__)
[0m16:09:49.327128 [debug] [ThreadPool]: Creating schema "database: "BI_group4"
schema: "_"
"
[0m16:09:49.338645 [debug] [ThreadPool]: Using postgres connection "create_BI_group4__"
[0m16:09:49.339359 [debug] [ThreadPool]: On create_BI_group4__: BEGIN
[0m16:09:49.339951 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:09:49.498630 [debug] [ThreadPool]: SQL status: BEGIN in 0.158 seconds
[0m16:09:49.500138 [debug] [ThreadPool]: Using postgres connection "create_BI_group4__"
[0m16:09:49.501448 [debug] [ThreadPool]: On create_BI_group4__: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "connection_name": "create_BI_group4__"} */
create schema if not exists "_"
[0m16:09:49.514362 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.012 seconds
[0m16:09:49.517858 [debug] [ThreadPool]: On create_BI_group4__: COMMIT
[0m16:09:49.519241 [debug] [ThreadPool]: Using postgres connection "create_BI_group4__"
[0m16:09:49.520496 [debug] [ThreadPool]: On create_BI_group4__: COMMIT
[0m16:09:49.533042 [debug] [ThreadPool]: SQL status: COMMIT in 0.011 seconds
[0m16:09:49.534460 [debug] [ThreadPool]: On create_BI_group4__: Close
[0m16:09:49.536817 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_BI_group4__, now create_BI_group4____staging)
[0m16:09:49.538765 [debug] [ThreadPool]: Creating schema "database: "BI_group4"
schema: "___staging"
"
[0m16:09:49.544505 [debug] [ThreadPool]: Using postgres connection "create_BI_group4____staging"
[0m16:09:49.545152 [debug] [ThreadPool]: On create_BI_group4____staging: BEGIN
[0m16:09:49.545747 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:09:49.701945 [debug] [ThreadPool]: SQL status: BEGIN in 0.156 seconds
[0m16:09:49.703472 [debug] [ThreadPool]: Using postgres connection "create_BI_group4____staging"
[0m16:09:49.704830 [debug] [ThreadPool]: On create_BI_group4____staging: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "connection_name": "create_BI_group4____staging"} */
create schema if not exists "___staging"
[0m16:09:49.717405 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.011 seconds
[0m16:09:49.720903 [debug] [ThreadPool]: On create_BI_group4____staging: COMMIT
[0m16:09:49.722288 [debug] [ThreadPool]: Using postgres connection "create_BI_group4____staging"
[0m16:09:49.723489 [debug] [ThreadPool]: On create_BI_group4____staging: COMMIT
[0m16:09:49.735644 [debug] [ThreadPool]: SQL status: COMMIT in 0.011 seconds
[0m16:09:49.736872 [debug] [ThreadPool]: On create_BI_group4____staging: Close
[0m16:09:49.741483 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_BI_group4____staging, now list_BI_group4__)
[0m16:09:49.760731 [debug] [ThreadPool]: Using postgres connection "list_BI_group4__"
[0m16:09:49.761409 [debug] [ThreadPool]: On list_BI_group4__: BEGIN
[0m16:09:49.761988 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:09:49.917422 [debug] [ThreadPool]: SQL status: BEGIN in 0.155 seconds
[0m16:09:49.918905 [debug] [ThreadPool]: Using postgres connection "list_BI_group4__"
[0m16:09:49.920346 [debug] [ThreadPool]: On list_BI_group4__: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "connection_name": "list_BI_group4__"} */
select
      'BI_group4' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike '_'
    union all
    select
      'BI_group4' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike '_'
    union all
    select
      'BI_group4' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike '_'
  
[0m16:09:49.934293 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.012 seconds
[0m16:09:49.938569 [debug] [ThreadPool]: On list_BI_group4__: ROLLBACK
[0m16:09:49.949264 [debug] [ThreadPool]: On list_BI_group4__: Close
[0m16:09:49.950822 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_BI_group4__, now list_BI_group4____staging)
[0m16:09:49.955604 [debug] [ThreadPool]: Using postgres connection "list_BI_group4____staging"
[0m16:09:49.956271 [debug] [ThreadPool]: On list_BI_group4____staging: BEGIN
[0m16:09:49.956863 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:09:50.117938 [debug] [ThreadPool]: SQL status: BEGIN in 0.161 seconds
[0m16:09:50.119442 [debug] [ThreadPool]: Using postgres connection "list_BI_group4____staging"
[0m16:09:50.120856 [debug] [ThreadPool]: On list_BI_group4____staging: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "connection_name": "list_BI_group4____staging"} */
select
      'BI_group4' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike '___staging'
    union all
    select
      'BI_group4' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike '___staging'
    union all
    select
      'BI_group4' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike '___staging'
  
[0m16:09:50.134374 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.012 seconds
[0m16:09:50.138265 [debug] [ThreadPool]: On list_BI_group4____staging: ROLLBACK
[0m16:09:50.149330 [debug] [ThreadPool]: On list_BI_group4____staging: Close
[0m16:09:50.162329 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:50.163269 [debug] [MainThread]: On master: BEGIN
[0m16:09:50.164102 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:09:50.381886 [debug] [MainThread]: SQL status: BEGIN in 0.218 seconds
[0m16:09:50.382954 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:50.384124 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:09:50.404562 [debug] [MainThread]: SQL status: SELECT 2 in 0.019 seconds
[0m16:09:50.408341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54cb0bce-0271-4397-83cf-38cafc627d17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccd79950500>]}
[0m16:09:50.409749 [debug] [MainThread]: On master: ROLLBACK
[0m16:09:50.419882 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:50.420856 [debug] [MainThread]: On master: BEGIN
[0m16:09:50.441440 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m16:09:50.442974 [debug] [MainThread]: On master: COMMIT
[0m16:09:50.444379 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:50.445728 [debug] [MainThread]: On master: COMMIT
[0m16:09:50.455827 [debug] [MainThread]: SQL status: COMMIT in 0.009 seconds
[0m16:09:50.456648 [debug] [MainThread]: On master: Close
[0m16:09:50.462250 [debug] [Thread-1 (]: Began running node model.dbt_project_25.my_first_dbt_model
[0m16:09:50.464325 [info ] [Thread-1 (]: 1 of 5 START sql table model _.my_first_dbt_model .............................. [RUN]
[0m16:09:50.466144 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_BI_group4____staging, now model.dbt_project_25.my_first_dbt_model)
[0m16:09:50.467722 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.my_first_dbt_model
[0m16:09:50.482157 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.my_first_dbt_model"
[0m16:09:50.483342 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.my_first_dbt_model
[0m16:09:50.551146 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.my_first_dbt_model"
[0m16:09:50.552437 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_first_dbt_model"
[0m16:09:50.553196 [debug] [Thread-1 (]: On model.dbt_project_25.my_first_dbt_model: BEGIN
[0m16:09:50.553900 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:09:50.703991 [debug] [Thread-1 (]: SQL status: BEGIN in 0.150 seconds
[0m16:09:50.705699 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_first_dbt_model"
[0m16:09:50.707344 [debug] [Thread-1 (]: On model.dbt_project_25.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.my_first_dbt_model"} */

  
    

  create  table "BI_group4"."_"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m16:09:50.720793 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.012 seconds
[0m16:09:50.742682 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_first_dbt_model"
[0m16:09:50.743462 [debug] [Thread-1 (]: On model.dbt_project_25.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.my_first_dbt_model"} */
alter table "BI_group4"."_"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m16:09:50.754142 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m16:09:50.779473 [debug] [Thread-1 (]: On model.dbt_project_25.my_first_dbt_model: COMMIT
[0m16:09:50.780241 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_first_dbt_model"
[0m16:09:50.780932 [debug] [Thread-1 (]: On model.dbt_project_25.my_first_dbt_model: COMMIT
[0m16:09:50.793313 [debug] [Thread-1 (]: SQL status: COMMIT in 0.011 seconds
[0m16:09:50.808388 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."_"."my_first_dbt_model__dbt_backup"
[0m16:09:50.818371 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_first_dbt_model"
[0m16:09:50.819142 [debug] [Thread-1 (]: On model.dbt_project_25.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.my_first_dbt_model"} */
drop table if exists "BI_group4"."_"."my_first_dbt_model__dbt_backup" cascade
[0m16:09:50.829894 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.010 seconds
[0m16:09:50.838615 [debug] [Thread-1 (]: On model.dbt_project_25.my_first_dbt_model: Close
[0m16:09:50.842605 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54cb0bce-0271-4397-83cf-38cafc627d17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccd7dad6840>]}
[0m16:09:50.843797 [info ] [Thread-1 (]: 1 of 5 OK created sql table model _.my_first_dbt_model ......................... [[32mSELECT 2[0m in 0.37s]
[0m16:09:50.844964 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.my_first_dbt_model
[0m16:09:50.845775 [debug] [Thread-1 (]: Began running node model.dbt_project_25.stg_product
[0m16:09:50.846922 [info ] [Thread-1 (]: 2 of 5 START sql table model ___staging.stg_product ............................ [RUN]
[0m16:09:50.848000 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_25.my_first_dbt_model, now model.dbt_project_25.stg_product)
[0m16:09:50.848797 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.stg_product
[0m16:09:50.854091 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.stg_product"
[0m16:09:50.855189 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.stg_product
[0m16:09:50.864190 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.stg_product"
[0m16:09:50.865412 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_product"
[0m16:09:50.866147 [debug] [Thread-1 (]: On model.dbt_project_25.stg_product: BEGIN
[0m16:09:50.866847 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:09:51.014732 [debug] [Thread-1 (]: SQL status: BEGIN in 0.147 seconds
[0m16:09:51.016493 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_product"
[0m16:09:51.018090 [debug] [Thread-1 (]: On model.dbt_project_25.stg_product: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_product"} */

  
    

  create  table "BI_group4"."___staging"."stg_product__dbt_tmp"
  
  
    as
  
  (
    

SELECT
  productid, 
  name AS itemname
FROM "BI_group4"."corentin"."product"

--run in terminal/shell: 
--dbt run --select stg_product

--(This will build the model as a new view/table in your dev schema, leaving the original data untouched)
  );
  
[0m16:09:51.031347 [debug] [Thread-1 (]: SQL status: SELECT 504 in 0.012 seconds
[0m16:09:51.041858 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_product"
[0m16:09:51.042660 [debug] [Thread-1 (]: On model.dbt_project_25.stg_product: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_product"} */
alter table "BI_group4"."___staging"."stg_product__dbt_tmp" rename to "stg_product"
[0m16:09:51.053262 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m16:09:51.058968 [debug] [Thread-1 (]: On model.dbt_project_25.stg_product: COMMIT
[0m16:09:51.060618 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_product"
[0m16:09:51.061832 [debug] [Thread-1 (]: On model.dbt_project_25.stg_product: COMMIT
[0m16:09:51.074537 [debug] [Thread-1 (]: SQL status: COMMIT in 0.012 seconds
[0m16:09:51.083052 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."___staging"."stg_product__dbt_backup"
[0m16:09:51.084610 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_product"
[0m16:09:51.085376 [debug] [Thread-1 (]: On model.dbt_project_25.stg_product: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_product"} */
drop table if exists "BI_group4"."___staging"."stg_product__dbt_backup" cascade
[0m16:09:51.096251 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.010 seconds
[0m16:09:51.099650 [debug] [Thread-1 (]: On model.dbt_project_25.stg_product: Close
[0m16:09:51.101261 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54cb0bce-0271-4397-83cf-38cafc627d17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccd7314fa40>]}
[0m16:09:51.102845 [info ] [Thread-1 (]: 2 of 5 OK created sql table model ___staging.stg_product ....................... [[32mSELECT 504[0m in 0.25s]
[0m16:09:51.104004 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.stg_product
[0m16:09:51.104822 [debug] [Thread-1 (]: Began running node model.dbt_project_25.stg_productcat
[0m16:09:51.105940 [info ] [Thread-1 (]: 3 of 5 START sql table model ___staging.stg_productcat ......................... [RUN]
[0m16:09:51.106828 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_25.stg_product, now model.dbt_project_25.stg_productcat)
[0m16:09:51.107597 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.stg_productcat
[0m16:09:51.113016 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.stg_productcat"
[0m16:09:51.114065 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.stg_productcat
[0m16:09:51.120373 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.stg_productcat"
[0m16:09:51.121464 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_productcat"
[0m16:09:51.122196 [debug] [Thread-1 (]: On model.dbt_project_25.stg_productcat: BEGIN
[0m16:09:51.122891 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:09:51.325997 [debug] [Thread-1 (]: SQL status: BEGIN in 0.203 seconds
[0m16:09:51.327742 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_productcat"
[0m16:09:51.329342 [debug] [Thread-1 (]: On model.dbt_project_25.stg_productcat: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_productcat"} */

  
    

  create  table "BI_group4"."___staging"."stg_productcat__dbt_tmp"
  
  
    as
  
  (
    

SELECT
  productcategoryid, 
  name AS itemcategoryname
FROM "BI_group4"."corentin"."productcategory"

--run in terminal/shell: 
--dbt run --select stg_productcat

--(This will build the model as a new view/table in your dev schema, leaving the original data untouched)
  );
  
[0m16:09:51.342188 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.011 seconds
[0m16:09:51.352752 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_productcat"
[0m16:09:51.354050 [debug] [Thread-1 (]: On model.dbt_project_25.stg_productcat: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_productcat"} */
alter table "BI_group4"."___staging"."stg_productcat__dbt_tmp" rename to "stg_productcat"
[0m16:09:51.364791 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m16:09:51.370440 [debug] [Thread-1 (]: On model.dbt_project_25.stg_productcat: COMMIT
[0m16:09:51.372011 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_productcat"
[0m16:09:51.373328 [debug] [Thread-1 (]: On model.dbt_project_25.stg_productcat: COMMIT
[0m16:09:51.385409 [debug] [Thread-1 (]: SQL status: COMMIT in 0.011 seconds
[0m16:09:51.393846 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."___staging"."stg_productcat__dbt_backup"
[0m16:09:51.395362 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_productcat"
[0m16:09:51.396105 [debug] [Thread-1 (]: On model.dbt_project_25.stg_productcat: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_productcat"} */
drop table if exists "BI_group4"."___staging"."stg_productcat__dbt_backup" cascade
[0m16:09:51.407456 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.010 seconds
[0m16:09:51.411385 [debug] [Thread-1 (]: On model.dbt_project_25.stg_productcat: Close
[0m16:09:51.413184 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54cb0bce-0271-4397-83cf-38cafc627d17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccd7915b980>]}
[0m16:09:51.414719 [info ] [Thread-1 (]: 3 of 5 OK created sql table model ___staging.stg_productcat .................... [[32mSELECT 4[0m in 0.31s]
[0m16:09:51.415851 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.stg_productcat
[0m16:09:51.416657 [debug] [Thread-1 (]: Began running node model.dbt_project_25.stg_stateprovince
[0m16:09:51.417740 [info ] [Thread-1 (]: 4 of 5 START sql table model ___staging.stg_stateprovince ...................... [RUN]
[0m16:09:51.418624 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_25.stg_productcat, now model.dbt_project_25.stg_stateprovince)
[0m16:09:51.419380 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.stg_stateprovince
[0m16:09:51.424790 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.stg_stateprovince"
[0m16:09:51.425842 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.stg_stateprovince
[0m16:09:51.432270 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.stg_stateprovince"
[0m16:09:51.433419 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_stateprovince"
[0m16:09:51.434172 [debug] [Thread-1 (]: On model.dbt_project_25.stg_stateprovince: BEGIN
[0m16:09:51.434882 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:09:51.583126 [debug] [Thread-1 (]: SQL status: BEGIN in 0.148 seconds
[0m16:09:51.584766 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_stateprovince"
[0m16:09:51.586367 [debug] [Thread-1 (]: On model.dbt_project_25.stg_stateprovince: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_stateprovince"} */

  
    

  create  table "BI_group4"."___staging"."stg_stateprovince__dbt_tmp"
  
  
    as
  
  (
    

SELECT
  stateprovinceid, 
  countryregioncode,
  territoryid,
  name AS regionname,
  stateprovincecode
FROM "BI_group4"."corentin"."stateprovince"

--run in terminal/shell: 
--dbt run --select stg_stateprovince

--(This will build the model as a new view/table in your dev schema, leaving the original data untouched)
  );
  
[0m16:09:51.599875 [debug] [Thread-1 (]: SQL status: SELECT 181 in 0.012 seconds
[0m16:09:51.610091 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_stateprovince"
[0m16:09:51.611165 [debug] [Thread-1 (]: On model.dbt_project_25.stg_stateprovince: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_stateprovince"} */
alter table "BI_group4"."___staging"."stg_stateprovince__dbt_tmp" rename to "stg_stateprovince"
[0m16:09:51.622182 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m16:09:51.625061 [debug] [Thread-1 (]: On model.dbt_project_25.stg_stateprovince: COMMIT
[0m16:09:51.625840 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_stateprovince"
[0m16:09:51.626551 [debug] [Thread-1 (]: On model.dbt_project_25.stg_stateprovince: COMMIT
[0m16:09:51.638882 [debug] [Thread-1 (]: SQL status: COMMIT in 0.011 seconds
[0m16:09:51.649369 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."___staging"."stg_stateprovince__dbt_backup"
[0m16:09:51.651048 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_stateprovince"
[0m16:09:51.651901 [debug] [Thread-1 (]: On model.dbt_project_25.stg_stateprovince: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_stateprovince"} */
drop table if exists "BI_group4"."___staging"."stg_stateprovince__dbt_backup" cascade
[0m16:09:51.662578 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.010 seconds
[0m16:09:51.665004 [debug] [Thread-1 (]: On model.dbt_project_25.stg_stateprovince: Close
[0m16:09:51.666145 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54cb0bce-0271-4397-83cf-38cafc627d17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccd731ca9c0>]}
[0m16:09:51.667335 [info ] [Thread-1 (]: 4 of 5 OK created sql table model ___staging.stg_stateprovince ................. [[32mSELECT 181[0m in 0.25s]
[0m16:09:51.668464 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.stg_stateprovince
[0m16:09:51.669258 [debug] [Thread-1 (]: Began running node model.dbt_project_25.my_second_dbt_model
[0m16:09:51.670313 [info ] [Thread-1 (]: 5 of 5 START sql view model _.my_second_dbt_model .............................. [RUN]
[0m16:09:51.671154 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_25.stg_stateprovince, now model.dbt_project_25.my_second_dbt_model)
[0m16:09:51.671905 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.my_second_dbt_model
[0m16:09:51.676569 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.my_second_dbt_model"
[0m16:09:51.677691 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.my_second_dbt_model
[0m16:09:51.710230 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.my_second_dbt_model"
[0m16:09:51.711502 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_second_dbt_model"
[0m16:09:51.712284 [debug] [Thread-1 (]: On model.dbt_project_25.my_second_dbt_model: BEGIN
[0m16:09:51.712970 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:09:51.861547 [debug] [Thread-1 (]: SQL status: BEGIN in 0.148 seconds
[0m16:09:51.863319 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_second_dbt_model"
[0m16:09:51.864953 [debug] [Thread-1 (]: On model.dbt_project_25.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.my_second_dbt_model"} */

  create view "BI_group4"."_"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "BI_group4"."_"."my_first_dbt_model"
where id = 1
  );
[0m16:09:51.877954 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m16:09:51.887938 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_second_dbt_model"
[0m16:09:51.888722 [debug] [Thread-1 (]: On model.dbt_project_25.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.my_second_dbt_model"} */
alter table "BI_group4"."_"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m16:09:51.901420 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.012 seconds
[0m16:09:51.904154 [debug] [Thread-1 (]: On model.dbt_project_25.my_second_dbt_model: COMMIT
[0m16:09:51.904927 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_second_dbt_model"
[0m16:09:51.905643 [debug] [Thread-1 (]: On model.dbt_project_25.my_second_dbt_model: COMMIT
[0m16:09:51.919027 [debug] [Thread-1 (]: SQL status: COMMIT in 0.012 seconds
[0m16:09:51.927219 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."_"."my_second_dbt_model__dbt_backup"
[0m16:09:51.933088 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_second_dbt_model"
[0m16:09:51.933881 [debug] [Thread-1 (]: On model.dbt_project_25.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.my_second_dbt_model"} */
drop view if exists "BI_group4"."_"."my_second_dbt_model__dbt_backup" cascade
[0m16:09:51.944745 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.010 seconds
[0m16:09:51.947266 [debug] [Thread-1 (]: On model.dbt_project_25.my_second_dbt_model: Close
[0m16:09:51.948619 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54cb0bce-0271-4397-83cf-38cafc627d17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccd731bb860>]}
[0m16:09:51.950024 [info ] [Thread-1 (]: 5 of 5 OK created sql view model _.my_second_dbt_model ......................... [[32mCREATE VIEW[0m in 0.28s]
[0m16:09:51.951474 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.my_second_dbt_model
[0m16:09:51.954807 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:51.956218 [debug] [MainThread]: On master: BEGIN
[0m16:09:51.957439 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:09:52.109420 [debug] [MainThread]: SQL status: BEGIN in 0.152 seconds
[0m16:09:52.110960 [debug] [MainThread]: On master: COMMIT
[0m16:09:52.112355 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:52.113650 [debug] [MainThread]: On master: COMMIT
[0m16:09:52.124401 [debug] [MainThread]: SQL status: COMMIT in 0.010 seconds
[0m16:09:52.125312 [debug] [MainThread]: On master: Close
[0m16:09:52.126523 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:09:52.127346 [debug] [MainThread]: Connection 'model.dbt_project_25.my_second_dbt_model' was properly closed.
[0m16:09:52.128303 [info ] [MainThread]: 
[0m16:09:52.129217 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0 hours 0 minutes and 3.25 seconds (3.25s).
[0m16:09:52.132110 [debug] [MainThread]: Command end result
[0m16:09:52.176090 [debug] [MainThread]: Wrote artifact WritableManifest to /home/evelyn.bautista@Digital-Grenoble.local/module_bi_2025/BI_DBT/target/manifest.json
[0m16:09:52.179001 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/evelyn.bautista@Digital-Grenoble.local/module_bi_2025/BI_DBT/target/semantic_manifest.json
[0m16:09:52.189214 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/evelyn.bautista@Digital-Grenoble.local/module_bi_2025/BI_DBT/target/run_results.json
[0m16:09:52.189869 [info ] [MainThread]: 
[0m16:09:52.190598 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:09:52.191235 [info ] [MainThread]: 
[0m16:09:52.191917 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m16:09:52.193531 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.060903, "process_in_blocks": "8", "process_kernel_time": 0.439974, "process_mem_max_rss": "128248", "process_out_blocks": "3600", "process_user_time": 7.067583}
[0m16:09:52.194452 [debug] [MainThread]: Command `dbt run` succeeded at 16:09:52.194266 after 7.06 seconds
[0m16:09:52.195149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccd7bc36b40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccd7b233ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccd7a946ab0>]}
[0m16:09:52.195886 [debug] [MainThread]: Flushing usage events
[0m16:09:52.721093 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:57:42.793060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7906a975bef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7906a83f5f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7906a811a0c0>]}


============================== 09:57:42.803703 | afac0cf3-fd4d-42f4-849d-0c85a479980e ==============================
[0m09:57:42.803703 [info ] [MainThread]: Running with dbt=1.10.2
[0m09:57:42.805019 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/corentin.vanlandeghe@Digital-Grenoble.local/BI_DBT/logs', 'version_check': 'True', 'profiles_dir': '/home/corentin.vanlandeghe@Digital-Grenoble.local/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt test', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:57:43.209812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'afac0cf3-fd4d-42f4-849d-0c85a479980e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7906a742e060>]}
[0m09:57:43.336180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'afac0cf3-fd4d-42f4-849d-0c85a479980e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7906a742e030>]}
[0m09:57:43.338209 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:57:43.530349 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m09:57:43.824070 [debug] [MainThread]: Partial parsing enabled: 4 files deleted, 9 files added, 0 files changed.
[0m09:57:43.825206 [debug] [MainThread]: Partial parsing: added file: dbt_project_25://models/staging/salesorderdetailsclean.sql
[0m09:57:43.826090 [debug] [MainThread]: Partial parsing: added file: dbt_project_25://models/staging/storeclean.sql
[0m09:57:43.826904 [debug] [MainThread]: Partial parsing: added file: dbt_project_25://models/staging/stg_stateprovince.sql
[0m09:57:43.827697 [debug] [MainThread]: Partial parsing: added file: dbt_project_25://models/staging/stg_productcat.sql
[0m09:57:43.828478 [debug] [MainThread]: Partial parsing: added file: dbt_project_25://models/staging/customerclean.sql
[0m09:57:43.829368 [debug] [MainThread]: Partial parsing: added file: dbt_project_25://models/staging/schema.yml
[0m09:57:43.830163 [debug] [MainThread]: Partial parsing: added file: dbt_project_25://models/staging/dateclean.sql
[0m09:57:43.830951 [debug] [MainThread]: Partial parsing: added file: dbt_project_25://models/staging/salesorderheaderclean.sql
[0m09:57:43.831741 [debug] [MainThread]: Partial parsing: added file: dbt_project_25://models/staging/stg_product.sql
[0m09:57:43.832582 [debug] [MainThread]: Partial parsing: deleted file: dbt_project_25://models/Staging/stg_productcat.sql
[0m09:57:43.833301 [debug] [MainThread]: Partial parsing: deleted file: dbt_project_25://models/Staging/stg_stateprovince.sql
[0m09:57:43.834026 [debug] [MainThread]: Partial parsing: deleted file: dbt_project_25://models/Staging/stg_product.sql
[0m09:57:44.605461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'afac0cf3-fd4d-42f4-849d-0c85a479980e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7906a59a5580>]}
[0m09:57:44.756754 [debug] [MainThread]: Wrote artifact WritableManifest to /home/corentin.vanlandeghe@Digital-Grenoble.local/BI_DBT/target/manifest.json
[0m09:57:45.012644 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/corentin.vanlandeghe@Digital-Grenoble.local/BI_DBT/target/semantic_manifest.json
[0m09:57:45.085036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'afac0cf3-fd4d-42f4-849d-0c85a479980e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7906a514e630>]}
[0m09:57:45.086080 [info ] [MainThread]: Found 10 models, 4 data tests, 8 sources, 549 macros
[0m09:57:45.086916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'afac0cf3-fd4d-42f4-849d-0c85a479980e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7906a59a67b0>]}
[0m09:57:45.090627 [info ] [MainThread]: 
[0m09:57:45.091467 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:57:45.092220 [info ] [MainThread]: 
[0m09:57:45.093259 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:57:45.101869 [debug] [ThreadPool]: Acquiring new postgres connection 'list_BI_group4__'
[0m09:57:45.291802 [debug] [ThreadPool]: Using postgres connection "list_BI_group4__"
[0m09:57:45.292708 [debug] [ThreadPool]: On list_BI_group4__: BEGIN
[0m09:57:45.293436 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:57:45.780139 [debug] [ThreadPool]: SQL status: BEGIN in 0.486 seconds
[0m09:57:45.781969 [debug] [ThreadPool]: Using postgres connection "list_BI_group4__"
[0m09:57:45.783642 [debug] [ThreadPool]: On list_BI_group4__: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "connection_name": "list_BI_group4__"} */
select
      'BI_group4' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike '_'
    union all
    select
      'BI_group4' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike '_'
    union all
    select
      'BI_group4' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike '_'
  
[0m09:57:45.802709 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.017 seconds
[0m09:57:45.808075 [debug] [ThreadPool]: On list_BI_group4__: ROLLBACK
[0m09:57:45.819657 [debug] [ThreadPool]: On list_BI_group4__: Close
[0m09:57:45.821790 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_BI_group4__, now list_BI_group4____staging)
[0m09:57:45.829436 [debug] [ThreadPool]: Using postgres connection "list_BI_group4____staging"
[0m09:57:45.830390 [debug] [ThreadPool]: On list_BI_group4____staging: BEGIN
[0m09:57:45.831284 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:57:45.992934 [debug] [ThreadPool]: SQL status: BEGIN in 0.161 seconds
[0m09:57:45.994663 [debug] [ThreadPool]: Using postgres connection "list_BI_group4____staging"
[0m09:57:45.996281 [debug] [ThreadPool]: On list_BI_group4____staging: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "connection_name": "list_BI_group4____staging"} */
select
      'BI_group4' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike '___staging'
    union all
    select
      'BI_group4' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike '___staging'
    union all
    select
      'BI_group4' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike '___staging'
  
[0m09:57:46.011913 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.014 seconds
[0m09:57:46.017056 [debug] [ThreadPool]: On list_BI_group4____staging: ROLLBACK
[0m09:57:46.028155 [debug] [ThreadPool]: On list_BI_group4____staging: Close
[0m09:57:46.043682 [debug] [MainThread]: Using postgres connection "master"
[0m09:57:46.044578 [debug] [MainThread]: On master: BEGIN
[0m09:57:46.045374 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:57:46.266428 [debug] [MainThread]: SQL status: BEGIN in 0.221 seconds
[0m09:57:46.268132 [debug] [MainThread]: Using postgres connection "master"
[0m09:57:46.270041 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:57:46.292464 [debug] [MainThread]: SQL status: SELECT 3 in 0.020 seconds
[0m09:57:46.298372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'afac0cf3-fd4d-42f4-849d-0c85a479980e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7906a59a6180>]}
[0m09:57:46.300044 [debug] [MainThread]: On master: ROLLBACK
[0m09:57:46.311341 [debug] [MainThread]: Using postgres connection "master"
[0m09:57:46.313001 [debug] [MainThread]: On master: BEGIN
[0m09:57:46.334928 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m09:57:46.336591 [debug] [MainThread]: On master: COMMIT
[0m09:57:46.338172 [debug] [MainThread]: Using postgres connection "master"
[0m09:57:46.339714 [debug] [MainThread]: On master: COMMIT
[0m09:57:46.350849 [debug] [MainThread]: SQL status: COMMIT in 0.010 seconds
[0m09:57:46.352543 [debug] [MainThread]: On master: Close
[0m09:57:46.364312 [debug] [Thread-1 (]: Began running node test.dbt_project_25.not_null_my_first_dbt_model_id.5fb22c2710
[0m09:57:46.366260 [info ] [Thread-1 (]: 1 of 4 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m09:57:46.368301 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_BI_group4____staging, now test.dbt_project_25.not_null_my_first_dbt_model_id.5fb22c2710)
[0m09:57:46.370051 [debug] [Thread-1 (]: Began compiling node test.dbt_project_25.not_null_my_first_dbt_model_id.5fb22c2710
[0m09:57:46.403987 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project_25.not_null_my_first_dbt_model_id.5fb22c2710"
[0m09:57:46.405321 [debug] [Thread-1 (]: Began executing node test.dbt_project_25.not_null_my_first_dbt_model_id.5fb22c2710
[0m09:57:46.440118 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project_25.not_null_my_first_dbt_model_id.5fb22c2710"
[0m09:57:46.441484 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project_25.not_null_my_first_dbt_model_id.5fb22c2710"
[0m09:57:46.442382 [debug] [Thread-1 (]: On test.dbt_project_25.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
[0m09:57:46.443236 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:57:46.602992 [debug] [Thread-1 (]: SQL status: BEGIN in 0.159 seconds
[0m09:57:46.604917 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project_25.not_null_my_first_dbt_model_id.5fb22c2710"
[0m09:57:46.606748 [debug] [Thread-1 (]: On test.dbt_project_25.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "test.dbt_project_25.not_null_my_first_dbt_model_id.5fb22c2710"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "BI_group4"."_"."my_first_dbt_model"
where id is null



  
  
      
    ) dbt_internal_test
[0m09:57:46.619140 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.011 seconds
[0m09:57:46.630729 [debug] [Thread-1 (]: On test.dbt_project_25.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m09:57:46.642546 [debug] [Thread-1 (]: On test.dbt_project_25.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m09:57:46.645378 [error] [Thread-1 (]: 1 of 4 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.28s]
[0m09:57:46.648094 [debug] [Thread-1 (]: Finished running node test.dbt_project_25.not_null_my_first_dbt_model_id.5fb22c2710
[0m09:57:46.650046 [debug] [Thread-1 (]: Began running node test.dbt_project_25.not_null_my_second_dbt_model_id.151b76d778
[0m09:57:46.651355 [info ] [Thread-1 (]: 2 of 4 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m09:57:46.652579 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project_25.not_null_my_first_dbt_model_id.5fb22c2710, now test.dbt_project_25.not_null_my_second_dbt_model_id.151b76d778)
[0m09:57:46.653462 [debug] [Thread-1 (]: Began compiling node test.dbt_project_25.not_null_my_second_dbt_model_id.151b76d778
[0m09:57:46.661643 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project_25.not_null_my_second_dbt_model_id.151b76d778"
[0m09:57:46.662889 [debug] [Thread-1 (]: Began executing node test.dbt_project_25.not_null_my_second_dbt_model_id.151b76d778
[0m09:57:46.667788 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project_25.not_null_my_second_dbt_model_id.151b76d778"
[0m09:57:46.669084 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project_25.not_null_my_second_dbt_model_id.151b76d778"
[0m09:57:46.669971 [debug] [Thread-1 (]: On test.dbt_project_25.not_null_my_second_dbt_model_id.151b76d778: BEGIN
[0m09:57:46.670799 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:57:46.828190 [debug] [Thread-1 (]: SQL status: BEGIN in 0.157 seconds
[0m09:57:46.830175 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project_25.not_null_my_second_dbt_model_id.151b76d778"
[0m09:57:46.832009 [debug] [Thread-1 (]: On test.dbt_project_25.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "test.dbt_project_25.not_null_my_second_dbt_model_id.151b76d778"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "BI_group4"."_"."my_second_dbt_model"
where id is null



  
  
      
    ) dbt_internal_test
[0m09:57:46.845422 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.011 seconds
[0m09:57:46.851325 [debug] [Thread-1 (]: On test.dbt_project_25.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
[0m09:57:46.862850 [debug] [Thread-1 (]: On test.dbt_project_25.not_null_my_second_dbt_model_id.151b76d778: Close
[0m09:57:46.865689 [info ] [Thread-1 (]: 2 of 4 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.21s]
[0m09:57:46.868304 [debug] [Thread-1 (]: Finished running node test.dbt_project_25.not_null_my_second_dbt_model_id.151b76d778
[0m09:57:46.870247 [debug] [Thread-1 (]: Began running node test.dbt_project_25.unique_my_first_dbt_model_id.16e066b321
[0m09:57:46.872283 [info ] [Thread-1 (]: 3 of 4 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m09:57:46.873304 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project_25.not_null_my_second_dbt_model_id.151b76d778, now test.dbt_project_25.unique_my_first_dbt_model_id.16e066b321)
[0m09:57:46.874191 [debug] [Thread-1 (]: Began compiling node test.dbt_project_25.unique_my_first_dbt_model_id.16e066b321
[0m09:57:46.886429 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project_25.unique_my_first_dbt_model_id.16e066b321"
[0m09:57:46.887723 [debug] [Thread-1 (]: Began executing node test.dbt_project_25.unique_my_first_dbt_model_id.16e066b321
[0m09:57:46.892583 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project_25.unique_my_first_dbt_model_id.16e066b321"
[0m09:57:46.893926 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project_25.unique_my_first_dbt_model_id.16e066b321"
[0m09:57:46.894809 [debug] [Thread-1 (]: On test.dbt_project_25.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m09:57:46.895635 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:57:47.051839 [debug] [Thread-1 (]: SQL status: BEGIN in 0.156 seconds
[0m09:57:47.053830 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project_25.unique_my_first_dbt_model_id.16e066b321"
[0m09:57:47.055672 [debug] [Thread-1 (]: On test.dbt_project_25.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "test.dbt_project_25.unique_my_first_dbt_model_id.16e066b321"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "BI_group4"."_"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m09:57:47.068356 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.011 seconds
[0m09:57:47.072648 [debug] [Thread-1 (]: On test.dbt_project_25.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m09:57:47.082738 [debug] [Thread-1 (]: On test.dbt_project_25.unique_my_first_dbt_model_id.16e066b321: Close
[0m09:57:47.084494 [info ] [Thread-1 (]: 3 of 4 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.21s]
[0m09:57:47.086284 [debug] [Thread-1 (]: Finished running node test.dbt_project_25.unique_my_first_dbt_model_id.16e066b321
[0m09:57:47.087601 [debug] [Thread-1 (]: Began running node test.dbt_project_25.unique_my_second_dbt_model_id.57a0f8c493
[0m09:57:47.089013 [info ] [Thread-1 (]: 4 of 4 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m09:57:47.090408 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project_25.unique_my_first_dbt_model_id.16e066b321, now test.dbt_project_25.unique_my_second_dbt_model_id.57a0f8c493)
[0m09:57:47.091657 [debug] [Thread-1 (]: Began compiling node test.dbt_project_25.unique_my_second_dbt_model_id.57a0f8c493
[0m09:57:47.100128 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project_25.unique_my_second_dbt_model_id.57a0f8c493"
[0m09:57:47.101364 [debug] [Thread-1 (]: Began executing node test.dbt_project_25.unique_my_second_dbt_model_id.57a0f8c493
[0m09:57:47.106200 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project_25.unique_my_second_dbt_model_id.57a0f8c493"
[0m09:57:47.107490 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project_25.unique_my_second_dbt_model_id.57a0f8c493"
[0m09:57:47.108377 [debug] [Thread-1 (]: On test.dbt_project_25.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
[0m09:57:47.109202 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:57:47.279439 [debug] [Thread-1 (]: SQL status: BEGIN in 0.170 seconds
[0m09:57:47.281428 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project_25.unique_my_second_dbt_model_id.57a0f8c493"
[0m09:57:47.283260 [debug] [Thread-1 (]: On test.dbt_project_25.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "test.dbt_project_25.unique_my_second_dbt_model_id.57a0f8c493"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "BI_group4"."_"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m09:57:47.298206 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.013 seconds
[0m09:57:47.303980 [debug] [Thread-1 (]: On test.dbt_project_25.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
[0m09:57:47.315391 [debug] [Thread-1 (]: On test.dbt_project_25.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m09:57:47.317699 [info ] [Thread-1 (]: 4 of 4 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.23s]
[0m09:57:47.319799 [debug] [Thread-1 (]: Finished running node test.dbt_project_25.unique_my_second_dbt_model_id.57a0f8c493
[0m09:57:47.323906 [debug] [MainThread]: Using postgres connection "master"
[0m09:57:47.325575 [debug] [MainThread]: On master: BEGIN
[0m09:57:47.327119 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:57:47.487092 [debug] [MainThread]: SQL status: BEGIN in 0.160 seconds
[0m09:57:47.488947 [debug] [MainThread]: On master: COMMIT
[0m09:57:47.490578 [debug] [MainThread]: Using postgres connection "master"
[0m09:57:47.492113 [debug] [MainThread]: On master: COMMIT
[0m09:57:47.503387 [debug] [MainThread]: SQL status: COMMIT in 0.010 seconds
[0m09:57:47.504279 [debug] [MainThread]: On master: Close
[0m09:57:47.505430 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:57:47.506286 [debug] [MainThread]: Connection 'test.dbt_project_25.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m09:57:47.507170 [info ] [MainThread]: 
[0m09:57:47.508090 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 2.41 seconds (2.41s).
[0m09:57:47.510553 [debug] [MainThread]: Command end result
[0m09:57:47.558796 [debug] [MainThread]: Wrote artifact WritableManifest to /home/corentin.vanlandeghe@Digital-Grenoble.local/BI_DBT/target/manifest.json
[0m09:57:47.561982 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/corentin.vanlandeghe@Digital-Grenoble.local/BI_DBT/target/semantic_manifest.json
[0m09:57:47.573974 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/corentin.vanlandeghe@Digital-Grenoble.local/BI_DBT/target/run_results.json
[0m09:57:47.574785 [info ] [MainThread]: 
[0m09:57:47.575631 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:57:47.576412 [info ] [MainThread]: 
[0m09:57:47.577324 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
[0m09:57:47.578214 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m09:57:47.578961 [info ] [MainThread]: 
[0m09:57:47.579816 [info ] [MainThread]:   compiled code at target/compiled/dbt_project_25/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m09:57:47.580570 [info ] [MainThread]: 
[0m09:57:47.581371 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m09:57:47.584162 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 4.909143, "process_in_blocks": "79688", "process_kernel_time": 0.629516, "process_mem_max_rss": "128124", "process_out_blocks": "3672", "process_user_time": 5.199302}
[0m09:57:47.585191 [debug] [MainThread]: Command `dbt test` failed at 09:57:47.584999 after 4.91 seconds
[0m09:57:47.586052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7906a811a1e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7906a411f7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7906a5951a00>]}
[0m09:57:47.586928 [debug] [MainThread]: Flushing usage events
[0m09:57:48.556769 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:57:57.514491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c44e325340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c44e845430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c44d80dd00>]}


============================== 09:57:57.520212 | bb64c696-0be0-41da-95e8-7e4817b14170 ==============================
[0m09:57:57.520212 [info ] [MainThread]: Running with dbt=1.10.2
[0m09:57:57.521362 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/corentin.vanlandeghe@Digital-Grenoble.local/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/corentin.vanlandeghe@Digital-Grenoble.local/BI_DBT/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m09:57:57.844810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bb64c696-0be0-41da-95e8-7e4817b14170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c44df59c70>]}
[0m09:57:57.970937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bb64c696-0be0-41da-95e8-7e4817b14170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c44de16810>]}
[0m09:57:57.972439 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:57:58.154795 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m09:57:58.384338 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:57:58.385171 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:57:58.472006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bb64c696-0be0-41da-95e8-7e4817b14170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c44cf4b2c0>]}
[0m09:57:58.632127 [debug] [MainThread]: Wrote artifact WritableManifest to /home/corentin.vanlandeghe@Digital-Grenoble.local/BI_DBT/target/manifest.json
[0m09:57:58.635125 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/corentin.vanlandeghe@Digital-Grenoble.local/BI_DBT/target/semantic_manifest.json
[0m09:57:58.657868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bb64c696-0be0-41da-95e8-7e4817b14170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c44bfce270>]}
[0m09:57:58.658846 [info ] [MainThread]: Found 10 models, 4 data tests, 8 sources, 549 macros
[0m09:57:58.659665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb64c696-0be0-41da-95e8-7e4817b14170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c44c33b020>]}
[0m09:57:58.663592 [info ] [MainThread]: 
[0m09:57:58.664405 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:57:58.665137 [info ] [MainThread]: 
[0m09:57:58.666179 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:57:58.674626 [debug] [ThreadPool]: Acquiring new postgres connection 'list_BI_group4'
[0m09:57:58.748728 [debug] [ThreadPool]: Using postgres connection "list_BI_group4"
[0m09:57:58.749638 [debug] [ThreadPool]: On list_BI_group4: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "connection_name": "list_BI_group4"} */

    select distinct nspname from pg_namespace
  
[0m09:57:58.750395 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:57:58.925872 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.175 seconds
[0m09:57:58.931105 [debug] [ThreadPool]: On list_BI_group4: Close
[0m09:57:58.937366 [debug] [ThreadPool]: Using postgres connection "list_BI_group4"
[0m09:57:58.938620 [debug] [ThreadPool]: On list_BI_group4: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "connection_name": "list_BI_group4"} */

    select distinct nspname from pg_namespace
  
[0m09:57:58.939583 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:57:59.099034 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.159 seconds
[0m09:57:59.104008 [debug] [ThreadPool]: On list_BI_group4: Close
[0m09:57:59.110728 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_BI_group4, now list_BI_group4__)
[0m09:57:59.127552 [debug] [ThreadPool]: Using postgres connection "list_BI_group4__"
[0m09:57:59.128329 [debug] [ThreadPool]: On list_BI_group4__: BEGIN
[0m09:57:59.129047 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:57:59.341306 [debug] [ThreadPool]: SQL status: BEGIN in 0.212 seconds
[0m09:57:59.342941 [debug] [ThreadPool]: Using postgres connection "list_BI_group4__"
[0m09:57:59.344393 [debug] [ThreadPool]: On list_BI_group4__: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "connection_name": "list_BI_group4__"} */
select
      'BI_group4' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike '_'
    union all
    select
      'BI_group4' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike '_'
    union all
    select
      'BI_group4' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike '_'
  
[0m09:57:59.360990 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.015 seconds
[0m09:57:59.366114 [debug] [ThreadPool]: On list_BI_group4__: ROLLBACK
[0m09:57:59.377186 [debug] [ThreadPool]: On list_BI_group4__: Close
[0m09:57:59.379439 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_BI_group4__, now list_BI_group4____staging)
[0m09:57:59.387256 [debug] [ThreadPool]: Using postgres connection "list_BI_group4____staging"
[0m09:57:59.388156 [debug] [ThreadPool]: On list_BI_group4____staging: BEGIN
[0m09:57:59.388980 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:57:59.561805 [debug] [ThreadPool]: SQL status: BEGIN in 0.173 seconds
[0m09:57:59.563485 [debug] [ThreadPool]: Using postgres connection "list_BI_group4____staging"
[0m09:57:59.565137 [debug] [ThreadPool]: On list_BI_group4____staging: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "connection_name": "list_BI_group4____staging"} */
select
      'BI_group4' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike '___staging'
    union all
    select
      'BI_group4' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike '___staging'
    union all
    select
      'BI_group4' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike '___staging'
  
[0m09:57:59.582212 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.015 seconds
[0m09:57:59.587334 [debug] [ThreadPool]: On list_BI_group4____staging: ROLLBACK
[0m09:57:59.598812 [debug] [ThreadPool]: On list_BI_group4____staging: Close
[0m09:57:59.615959 [debug] [MainThread]: Using postgres connection "master"
[0m09:57:59.616756 [debug] [MainThread]: On master: BEGIN
[0m09:57:59.617455 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:57:59.780917 [debug] [MainThread]: SQL status: BEGIN in 0.163 seconds
[0m09:57:59.782608 [debug] [MainThread]: Using postgres connection "master"
[0m09:57:59.784520 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:57:59.814174 [debug] [MainThread]: SQL status: SELECT 3 in 0.028 seconds
[0m09:57:59.819765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb64c696-0be0-41da-95e8-7e4817b14170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c44d4f6a80>]}
[0m09:57:59.821746 [debug] [MainThread]: On master: ROLLBACK
[0m09:57:59.833364 [debug] [MainThread]: Using postgres connection "master"
[0m09:57:59.834209 [debug] [MainThread]: On master: BEGIN
[0m09:57:59.854929 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m09:57:59.856598 [debug] [MainThread]: On master: COMMIT
[0m09:57:59.858159 [debug] [MainThread]: Using postgres connection "master"
[0m09:57:59.859677 [debug] [MainThread]: On master: COMMIT
[0m09:57:59.870861 [debug] [MainThread]: SQL status: COMMIT in 0.010 seconds
[0m09:57:59.872101 [debug] [MainThread]: On master: Close
[0m09:57:59.879030 [debug] [Thread-1 (]: Began running node model.dbt_project_25.customerclean
[0m09:57:59.881370 [info ] [Thread-1 (]: 1 of 10 START sql table model ___staging.customerclean ......................... [RUN]
[0m09:57:59.883427 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_BI_group4____staging, now model.dbt_project_25.customerclean)
[0m09:57:59.885219 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.customerclean
[0m09:57:59.900775 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.customerclean"
[0m09:57:59.902136 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.customerclean
[0m09:57:59.972449 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.customerclean"
[0m09:57:59.973842 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.customerclean"
[0m09:57:59.974713 [debug] [Thread-1 (]: On model.dbt_project_25.customerclean: BEGIN
[0m09:57:59.975518 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:58:00.141874 [debug] [Thread-1 (]: SQL status: BEGIN in 0.166 seconds
[0m09:58:00.143847 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.customerclean"
[0m09:58:00.145652 [debug] [Thread-1 (]: On model.dbt_project_25.customerclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.customerclean"} */

  
    

  create  table "BI_group4"."___staging"."customerclean__dbt_tmp"
  
  
    as
  
  (
    

select
    customerid, 
	storeid,
    territoryid,
from "BI_group4"."corentin"."customer"
  );
  
[0m09:58:00.157678 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "from"
LINE 18: from "BI_group4"."corentin"."customer"
         ^

[0m09:58:00.158843 [debug] [Thread-1 (]: On model.dbt_project_25.customerclean: ROLLBACK
[0m09:58:00.170479 [debug] [Thread-1 (]: On model.dbt_project_25.customerclean: Close
[0m09:58:00.269066 [debug] [Thread-1 (]: Database Error in model customerclean (models/staging/customerclean.sql)
  syntax error at or near "from"
  LINE 18: from "BI_group4"."corentin"."customer"
           ^
  compiled code at target/run/dbt_project_25/models/staging/customerclean.sql
[0m09:58:00.272817 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb64c696-0be0-41da-95e8-7e4817b14170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c44cb4f7a0>]}
[0m09:58:00.274430 [error] [Thread-1 (]: 1 of 10 ERROR creating sql table model ___staging.customerclean ................ [[31mERROR[0m in 0.39s]
[0m09:58:00.275761 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.customerclean
[0m09:58:00.276705 [debug] [Thread-1 (]: Began running node model.dbt_project_25.dateclean
[0m09:58:00.278444 [debug] [Thread-4 (]: Marking all children of 'model.dbt_project_25.customerclean' to be skipped because of status 'error'.  Reason: Database Error in model customerclean (models/staging/customerclean.sql)
  syntax error at or near "from"
  LINE 18: from "BI_group4"."corentin"."customer"
           ^
  compiled code at target/run/dbt_project_25/models/staging/customerclean.sql.
[0m09:58:00.280376 [info ] [Thread-1 (]: 2 of 10 START sql table model ___staging.dateclean ............................. [RUN]
[0m09:58:00.284075 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_25.customerclean, now model.dbt_project_25.dateclean)
[0m09:58:00.285011 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.dateclean
[0m09:58:00.291098 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.dateclean"
[0m09:58:00.292287 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.dateclean
[0m09:58:00.302609 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.dateclean"
[0m09:58:00.303994 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.dateclean"
[0m09:58:00.304913 [debug] [Thread-1 (]: On model.dbt_project_25.dateclean: BEGIN
[0m09:58:00.305737 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:58:00.466625 [debug] [Thread-1 (]: SQL status: BEGIN in 0.160 seconds
[0m09:58:00.468644 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.dateclean"
[0m09:58:00.470524 [debug] [Thread-1 (]: On model.dbt_project_25.dateclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.dateclean"} */

  
    

  create  table "BI_group4"."___staging"."dateclean__dbt_tmp"
  
  
    as
  
  (
    

select
    date_day,
    day_of_week, as number_day_week
    day_of_week_name as day_name
    
from "BI_group4"."corentin"."date"
  );
  
[0m09:58:00.482624 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "as"
LINE 16:     day_of_week, as number_day_week
                          ^

[0m09:58:00.484459 [debug] [Thread-1 (]: On model.dbt_project_25.dateclean: ROLLBACK
[0m09:58:00.496205 [debug] [Thread-1 (]: On model.dbt_project_25.dateclean: Close
[0m09:58:00.502793 [debug] [Thread-1 (]: Database Error in model dateclean (models/staging/dateclean.sql)
  syntax error at or near "as"
  LINE 16:     day_of_week, as number_day_week
                            ^
  compiled code at target/run/dbt_project_25/models/staging/dateclean.sql
[0m09:58:00.503975 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb64c696-0be0-41da-95e8-7e4817b14170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c448e9a6f0>]}
[0m09:58:00.505465 [error] [Thread-1 (]: 2 of 10 ERROR creating sql table model ___staging.dateclean .................... [[31mERROR[0m in 0.22s]
[0m09:58:00.506916 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.dateclean
[0m09:58:00.507975 [debug] [Thread-1 (]: Began running node model.dbt_project_25.my_first_dbt_model
[0m09:58:00.509754 [debug] [Thread-4 (]: Marking all children of 'model.dbt_project_25.dateclean' to be skipped because of status 'error'.  Reason: Database Error in model dateclean (models/staging/dateclean.sql)
  syntax error at or near "as"
  LINE 16:     day_of_week, as number_day_week
                            ^
  compiled code at target/run/dbt_project_25/models/staging/dateclean.sql.
[0m09:58:00.511579 [info ] [Thread-1 (]: 3 of 10 START sql table model _.my_first_dbt_model ............................. [RUN]
[0m09:58:00.513175 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_25.dateclean, now model.dbt_project_25.my_first_dbt_model)
[0m09:58:00.514075 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.my_first_dbt_model
[0m09:58:00.519288 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.my_first_dbt_model"
[0m09:58:00.520540 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.my_first_dbt_model
[0m09:58:00.527807 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.my_first_dbt_model"
[0m09:58:00.529149 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_first_dbt_model"
[0m09:58:00.530054 [debug] [Thread-1 (]: On model.dbt_project_25.my_first_dbt_model: BEGIN
[0m09:58:00.530880 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:58:00.689621 [debug] [Thread-1 (]: SQL status: BEGIN in 0.158 seconds
[0m09:58:00.691652 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_first_dbt_model"
[0m09:58:00.693569 [debug] [Thread-1 (]: On model.dbt_project_25.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.my_first_dbt_model"} */

  
    

  create  table "BI_group4"."_"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m09:58:00.711660 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.016 seconds
[0m09:58:00.735116 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_first_dbt_model"
[0m09:58:00.736047 [debug] [Thread-1 (]: On model.dbt_project_25.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.my_first_dbt_model"} */
alter table "BI_group4"."_"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m09:58:00.748158 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.011 seconds
[0m09:58:00.754644 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_first_dbt_model"
[0m09:58:00.755521 [debug] [Thread-1 (]: On model.dbt_project_25.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.my_first_dbt_model"} */
alter table "BI_group4"."_"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m09:58:00.768586 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.012 seconds
[0m09:58:00.802609 [debug] [Thread-1 (]: On model.dbt_project_25.my_first_dbt_model: COMMIT
[0m09:58:00.803512 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_first_dbt_model"
[0m09:58:00.804340 [debug] [Thread-1 (]: On model.dbt_project_25.my_first_dbt_model: COMMIT
[0m09:58:00.818583 [debug] [Thread-1 (]: SQL status: COMMIT in 0.013 seconds
[0m09:58:00.835001 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."_"."my_first_dbt_model__dbt_backup"
[0m09:58:00.845100 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_first_dbt_model"
[0m09:58:00.846015 [debug] [Thread-1 (]: On model.dbt_project_25.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.my_first_dbt_model"} */
drop table if exists "BI_group4"."_"."my_first_dbt_model__dbt_backup" cascade
[0m09:58:00.875214 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.028 seconds
[0m09:58:00.883781 [debug] [Thread-1 (]: On model.dbt_project_25.my_first_dbt_model: Close
[0m09:58:00.885073 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb64c696-0be0-41da-95e8-7e4817b14170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c44fcb3ec0>]}
[0m09:58:00.886383 [info ] [Thread-1 (]: 3 of 10 OK created sql table model _.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.37s]
[0m09:58:00.887682 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.my_first_dbt_model
[0m09:58:00.888625 [debug] [Thread-1 (]: Began running node model.dbt_project_25.salesorderdetailsclean
[0m09:58:00.890116 [info ] [Thread-1 (]: 4 of 10 START sql table model ___staging.salesorderdetailsclean ................ [RUN]
[0m09:58:00.891127 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_25.my_first_dbt_model, now model.dbt_project_25.salesorderdetailsclean)
[0m09:58:00.892019 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.salesorderdetailsclean
[0m09:58:00.897545 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.salesorderdetailsclean"
[0m09:58:00.898674 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.salesorderdetailsclean
[0m09:58:00.905734 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.salesorderdetailsclean"
[0m09:58:00.906983 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderdetailsclean"
[0m09:58:00.907862 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderdetailsclean: BEGIN
[0m09:58:00.908683 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:58:01.074065 [debug] [Thread-1 (]: SQL status: BEGIN in 0.165 seconds
[0m09:58:01.076038 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderdetailsclean"
[0m09:58:01.077868 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderdetailsclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.salesorderdetailsclean"} */

  
    

  create  table "BI_group4"."___staging"."salesorderdetailsclean__dbt_tmp"
  
  
    as
  
  (
    

select 
	salesorderid, 
	unitprice,
	orderqty as orderquantity,
	productid,
	unitpricediscount as discount

from "BI_group4"."corentin"."salesorderdetail"
  );
  
[0m09:58:01.105954 [debug] [Thread-1 (]: SQL status: SELECT 5716 in 0.026 seconds
[0m09:58:01.116753 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderdetailsclean"
[0m09:58:01.117644 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderdetailsclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.salesorderdetailsclean"} */
alter table "BI_group4"."___staging"."salesorderdetailsclean__dbt_tmp" rename to "salesorderdetailsclean"
[0m09:58:01.129563 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.011 seconds
[0m09:58:01.133809 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderdetailsclean: COMMIT
[0m09:58:01.134957 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderdetailsclean"
[0m09:58:01.135808 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderdetailsclean: COMMIT
[0m09:58:01.153592 [debug] [Thread-1 (]: SQL status: COMMIT in 0.017 seconds
[0m09:58:01.166054 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."___staging"."salesorderdetailsclean__dbt_backup"
[0m09:58:01.167840 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderdetailsclean"
[0m09:58:01.168722 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderdetailsclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.salesorderdetailsclean"} */
drop table if exists "BI_group4"."___staging"."salesorderdetailsclean__dbt_backup" cascade
[0m09:58:01.179206 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.010 seconds
[0m09:58:01.181842 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderdetailsclean: Close
[0m09:58:01.183110 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb64c696-0be0-41da-95e8-7e4817b14170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c448eeb560>]}
[0m09:58:01.184436 [info ] [Thread-1 (]: 4 of 10 OK created sql table model ___staging.salesorderdetailsclean ........... [[32mSELECT 5716[0m in 0.29s]
[0m09:58:01.185732 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.salesorderdetailsclean
[0m09:58:01.186669 [debug] [Thread-1 (]: Began running node model.dbt_project_25.salesorderheaderclean
[0m09:58:01.187870 [info ] [Thread-1 (]: 5 of 10 START sql table model ___staging.salesorderheaderclean ................. [RUN]
[0m09:58:01.188867 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_25.salesorderdetailsclean, now model.dbt_project_25.salesorderheaderclean)
[0m09:58:01.189745 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.salesorderheaderclean
[0m09:58:01.195266 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.salesorderheaderclean"
[0m09:58:01.196424 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.salesorderheaderclean
[0m09:58:01.203573 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.salesorderheaderclean"
[0m09:58:01.204772 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderheaderclean"
[0m09:58:01.205664 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderheaderclean: BEGIN
[0m09:58:01.206481 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:58:01.372958 [debug] [Thread-1 (]: SQL status: BEGIN in 0.166 seconds
[0m09:58:01.374971 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderheaderclean"
[0m09:58:01.376826 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderheaderclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.salesorderheaderclean"} */

  
    

  create  table "BI_group4"."___staging"."salesorderheaderclean__dbt_tmp"
  
  
    as
  
  (
    

select
    orderdate,
    salesorderid,
    territoryid,
    salespersonid as salerid,
    billtoaddressid,
    customerid,
    salespersonid,
    shipdate
from "BI_group4"."corentin"."salesorderheader"
  );
  
[0m09:58:01.397286 [debug] [Thread-1 (]: SQL status: SELECT 1566 in 0.019 seconds
[0m09:58:01.407414 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderheaderclean"
[0m09:58:01.408327 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderheaderclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.salesorderheaderclean"} */
alter table "BI_group4"."___staging"."salesorderheaderclean__dbt_tmp" rename to "salesorderheaderclean"
[0m09:58:01.419259 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m09:58:01.424286 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderheaderclean: COMMIT
[0m09:58:01.425788 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderheaderclean"
[0m09:58:01.427137 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderheaderclean: COMMIT
[0m09:58:01.442446 [debug] [Thread-1 (]: SQL status: COMMIT in 0.014 seconds
[0m09:58:01.450746 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."___staging"."salesorderheaderclean__dbt_backup"
[0m09:58:01.453652 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderheaderclean"
[0m09:58:01.455088 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderheaderclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.salesorderheaderclean"} */
drop table if exists "BI_group4"."___staging"."salesorderheaderclean__dbt_backup" cascade
[0m09:58:01.466206 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.010 seconds
[0m09:58:01.469425 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderheaderclean: Close
[0m09:58:01.471173 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb64c696-0be0-41da-95e8-7e4817b14170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c44bb5c710>]}
[0m09:58:01.472994 [info ] [Thread-1 (]: 5 of 10 OK created sql table model ___staging.salesorderheaderclean ............ [[32mSELECT 1566[0m in 0.28s]
[0m09:58:01.474777 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.salesorderheaderclean
[0m09:58:01.476074 [debug] [Thread-1 (]: Began running node model.dbt_project_25.stg_product
[0m09:58:01.477435 [info ] [Thread-1 (]: 6 of 10 START sql table model ___staging.stg_product ........................... [RUN]
[0m09:58:01.478619 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_25.salesorderheaderclean, now model.dbt_project_25.stg_product)
[0m09:58:01.479513 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.stg_product
[0m09:58:01.485114 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.stg_product"
[0m09:58:01.486274 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.stg_product
[0m09:58:01.493329 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.stg_product"
[0m09:58:01.494551 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_product"
[0m09:58:01.495413 [debug] [Thread-1 (]: On model.dbt_project_25.stg_product: BEGIN
[0m09:58:01.496247 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:58:01.658229 [debug] [Thread-1 (]: SQL status: BEGIN in 0.162 seconds
[0m09:58:01.660205 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_product"
[0m09:58:01.662051 [debug] [Thread-1 (]: On model.dbt_project_25.stg_product: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_product"} */

  
    

  create  table "BI_group4"."___staging"."stg_product__dbt_tmp"
  
  
    as
  
  (
    

SELECT
  productid, 
  name AS itemname
FROM "BI_group4"."corentin"."product"

--run in terminal/shell: 
--dbt run --select stg_product

--(This will build the model as a new view/table in your dev schema, leaving the original data untouched)
  );
  
[0m09:58:01.678398 [debug] [Thread-1 (]: SQL status: SELECT 504 in 0.014 seconds
[0m09:58:01.690013 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_product"
[0m09:58:01.690909 [debug] [Thread-1 (]: On model.dbt_project_25.stg_product: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_product"} */
alter table "BI_group4"."___staging"."stg_product" rename to "stg_product__dbt_backup"
[0m09:58:01.702014 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m09:58:01.709938 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_product"
[0m09:58:01.710831 [debug] [Thread-1 (]: On model.dbt_project_25.stg_product: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_product"} */
alter table "BI_group4"."___staging"."stg_product__dbt_tmp" rename to "stg_product"
[0m09:58:01.721899 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m09:58:01.727604 [debug] [Thread-1 (]: On model.dbt_project_25.stg_product: COMMIT
[0m09:58:01.728740 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_product"
[0m09:58:01.729575 [debug] [Thread-1 (]: On model.dbt_project_25.stg_product: COMMIT
[0m09:58:01.743662 [debug] [Thread-1 (]: SQL status: COMMIT in 0.013 seconds
[0m09:58:01.751806 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."___staging"."stg_product__dbt_backup"
[0m09:58:01.757813 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_product"
[0m09:58:01.758781 [debug] [Thread-1 (]: On model.dbt_project_25.stg_product: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_product"} */
drop table if exists "BI_group4"."___staging"."stg_product__dbt_backup" cascade
[0m09:58:01.779295 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.019 seconds
[0m09:58:01.784543 [debug] [Thread-1 (]: On model.dbt_project_25.stg_product: Close
[0m09:58:01.787011 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb64c696-0be0-41da-95e8-7e4817b14170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c448d1fbf0>]}
[0m09:58:01.789355 [info ] [Thread-1 (]: 6 of 10 OK created sql table model ___staging.stg_product ...................... [[32mSELECT 504[0m in 0.31s]
[0m09:58:01.790636 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.stg_product
[0m09:58:01.791552 [debug] [Thread-1 (]: Began running node model.dbt_project_25.stg_productcat
[0m09:58:01.792746 [info ] [Thread-1 (]: 7 of 10 START sql table model ___staging.stg_productcat ........................ [RUN]
[0m09:58:01.793746 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_25.stg_product, now model.dbt_project_25.stg_productcat)
[0m09:58:01.794628 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.stg_productcat
[0m09:58:01.880000 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.stg_productcat"
[0m09:58:01.881238 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.stg_productcat
[0m09:58:01.888073 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.stg_productcat"
[0m09:58:01.889208 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_productcat"
[0m09:58:01.890071 [debug] [Thread-1 (]: On model.dbt_project_25.stg_productcat: BEGIN
[0m09:58:01.890886 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:58:02.055815 [debug] [Thread-1 (]: SQL status: BEGIN in 0.165 seconds
[0m09:58:02.056885 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_productcat"
[0m09:58:02.057788 [debug] [Thread-1 (]: On model.dbt_project_25.stg_productcat: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_productcat"} */

  
    

  create  table "BI_group4"."___staging"."stg_productcat__dbt_tmp"
  
  
    as
  
  (
    

SELECT
  productcategoryid, 
  name AS itemcategoryname
FROM "BI_group4"."corentin"."productcategory"

--run in terminal/shell: 
--dbt run --select stg_productcat

--(This will build the model as a new view/table in your dev schema, leaving the original data untouched)
  );
  
[0m09:58:02.071517 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.013 seconds
[0m09:58:02.078431 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_productcat"
[0m09:58:02.079426 [debug] [Thread-1 (]: On model.dbt_project_25.stg_productcat: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_productcat"} */
alter table "BI_group4"."___staging"."stg_productcat" rename to "stg_productcat__dbt_backup"
[0m09:58:02.091103 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.011 seconds
[0m09:58:02.099098 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_productcat"
[0m09:58:02.100329 [debug] [Thread-1 (]: On model.dbt_project_25.stg_productcat: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_productcat"} */
alter table "BI_group4"."___staging"."stg_productcat__dbt_tmp" rename to "stg_productcat"
[0m09:58:02.111851 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m09:58:02.116532 [debug] [Thread-1 (]: On model.dbt_project_25.stg_productcat: COMMIT
[0m09:58:02.117758 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_productcat"
[0m09:58:02.118911 [debug] [Thread-1 (]: On model.dbt_project_25.stg_productcat: COMMIT
[0m09:58:02.131586 [debug] [Thread-1 (]: SQL status: COMMIT in 0.011 seconds
[0m09:58:02.140742 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."___staging"."stg_productcat__dbt_backup"
[0m09:58:02.142450 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_productcat"
[0m09:58:02.143304 [debug] [Thread-1 (]: On model.dbt_project_25.stg_productcat: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_productcat"} */
drop table if exists "BI_group4"."___staging"."stg_productcat__dbt_backup" cascade
[0m09:58:02.159289 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.015 seconds
[0m09:58:02.164195 [debug] [Thread-1 (]: On model.dbt_project_25.stg_productcat: Close
[0m09:58:02.166735 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb64c696-0be0-41da-95e8-7e4817b14170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c448d11460>]}
[0m09:58:02.169375 [info ] [Thread-1 (]: 7 of 10 OK created sql table model ___staging.stg_productcat ................... [[32mSELECT 4[0m in 0.37s]
[0m09:58:02.171291 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.stg_productcat
[0m09:58:02.172230 [debug] [Thread-1 (]: Began running node model.dbt_project_25.stg_stateprovince
[0m09:58:02.173431 [info ] [Thread-1 (]: 8 of 10 START sql table model ___staging.stg_stateprovince ..................... [RUN]
[0m09:58:02.174434 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_25.stg_productcat, now model.dbt_project_25.stg_stateprovince)
[0m09:58:02.175317 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.stg_stateprovince
[0m09:58:02.180859 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.stg_stateprovince"
[0m09:58:02.181999 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.stg_stateprovince
[0m09:58:02.188972 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.stg_stateprovince"
[0m09:58:02.190147 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_stateprovince"
[0m09:58:02.191001 [debug] [Thread-1 (]: On model.dbt_project_25.stg_stateprovince: BEGIN
[0m09:58:02.191825 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:58:02.365676 [debug] [Thread-1 (]: SQL status: BEGIN in 0.173 seconds
[0m09:58:02.367657 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_stateprovince"
[0m09:58:02.369519 [debug] [Thread-1 (]: On model.dbt_project_25.stg_stateprovince: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_stateprovince"} */

  
    

  create  table "BI_group4"."___staging"."stg_stateprovince__dbt_tmp"
  
  
    as
  
  (
    

SELECT
  stateprovinceid, 
  countryregioncode,
  territoryid,
  name AS regionname,
  stateprovincecode
FROM "BI_group4"."corentin"."stateprovince"

--run in terminal/shell: 
--dbt run --select stg_stateprovince

--(This will build the model as a new view/table in your dev schema, leaving the original data untouched)
  );
  
[0m09:58:02.384536 [debug] [Thread-1 (]: SQL status: SELECT 181 in 0.013 seconds
[0m09:58:02.394786 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_stateprovince"
[0m09:58:02.395678 [debug] [Thread-1 (]: On model.dbt_project_25.stg_stateprovince: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_stateprovince"} */
alter table "BI_group4"."___staging"."stg_stateprovince" rename to "stg_stateprovince__dbt_backup"
[0m09:58:02.406771 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m09:58:02.412599 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_stateprovince"
[0m09:58:02.413477 [debug] [Thread-1 (]: On model.dbt_project_25.stg_stateprovince: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_stateprovince"} */
alter table "BI_group4"."___staging"."stg_stateprovince__dbt_tmp" rename to "stg_stateprovince"
[0m09:58:02.424971 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m09:58:02.429538 [debug] [Thread-1 (]: On model.dbt_project_25.stg_stateprovince: COMMIT
[0m09:58:02.430686 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_stateprovince"
[0m09:58:02.431754 [debug] [Thread-1 (]: On model.dbt_project_25.stg_stateprovince: COMMIT
[0m09:58:02.449998 [debug] [Thread-1 (]: SQL status: COMMIT in 0.017 seconds
[0m09:58:02.459535 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."___staging"."stg_stateprovince__dbt_backup"
[0m09:58:02.465416 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_stateprovince"
[0m09:58:02.466317 [debug] [Thread-1 (]: On model.dbt_project_25.stg_stateprovince: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_stateprovince"} */
drop table if exists "BI_group4"."___staging"."stg_stateprovince__dbt_backup" cascade
[0m09:58:02.481401 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.014 seconds
[0m09:58:02.485726 [debug] [Thread-1 (]: On model.dbt_project_25.stg_stateprovince: Close
[0m09:58:02.487966 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb64c696-0be0-41da-95e8-7e4817b14170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c44bfda5d0>]}
[0m09:58:02.490319 [info ] [Thread-1 (]: 8 of 10 OK created sql table model ___staging.stg_stateprovince ................ [[32mSELECT 181[0m in 0.31s]
[0m09:58:02.492667 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.stg_stateprovince
[0m09:58:02.493659 [debug] [Thread-1 (]: Began running node model.dbt_project_25.storeclean
[0m09:58:02.494854 [info ] [Thread-1 (]: 9 of 10 START sql table model ___staging.storeclean ............................ [RUN]
[0m09:58:02.495848 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_25.stg_stateprovince, now model.dbt_project_25.storeclean)
[0m09:58:02.496712 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.storeclean
[0m09:58:02.502228 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.storeclean"
[0m09:58:02.503379 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.storeclean
[0m09:58:02.510331 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.storeclean"
[0m09:58:02.511561 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.storeclean"
[0m09:58:02.512414 [debug] [Thread-1 (]: On model.dbt_project_25.storeclean: BEGIN
[0m09:58:02.513251 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:58:02.669445 [debug] [Thread-1 (]: SQL status: BEGIN in 0.156 seconds
[0m09:58:02.671233 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.storeclean"
[0m09:58:02.747267 [debug] [Thread-1 (]: On model.dbt_project_25.storeclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.storeclean"} */

  
    

  create  table "BI_group4"."___staging"."storeclean__dbt_tmp"
  
  
    as
  
  (
    

select
    salespersonid as salerid,
    storename,
    businessentityid
from "BI_group4"."corentin"."store1"
  );
  
[0m09:58:02.761423 [debug] [Thread-1 (]: SQL status: SELECT 701 in 0.012 seconds
[0m09:58:02.774240 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.storeclean"
[0m09:58:02.775415 [debug] [Thread-1 (]: On model.dbt_project_25.storeclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.storeclean"} */
alter table "BI_group4"."___staging"."storeclean__dbt_tmp" rename to "storeclean"
[0m09:58:02.786470 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m09:58:02.792774 [debug] [Thread-1 (]: On model.dbt_project_25.storeclean: COMMIT
[0m09:58:02.794629 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.storeclean"
[0m09:58:02.795560 [debug] [Thread-1 (]: On model.dbt_project_25.storeclean: COMMIT
[0m09:58:02.814547 [debug] [Thread-1 (]: SQL status: COMMIT in 0.018 seconds
[0m09:58:02.824282 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."___staging"."storeclean__dbt_backup"
[0m09:58:02.826533 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.storeclean"
[0m09:58:02.827396 [debug] [Thread-1 (]: On model.dbt_project_25.storeclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.storeclean"} */
drop table if exists "BI_group4"."___staging"."storeclean__dbt_backup" cascade
[0m09:58:02.838688 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.010 seconds
[0m09:58:02.842629 [debug] [Thread-1 (]: On model.dbt_project_25.storeclean: Close
[0m09:58:02.844475 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb64c696-0be0-41da-95e8-7e4817b14170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c44c76d490>]}
[0m09:58:02.846150 [info ] [Thread-1 (]: 9 of 10 OK created sql table model ___staging.storeclean ....................... [[32mSELECT 701[0m in 0.35s]
[0m09:58:02.847441 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.storeclean
[0m09:58:02.848391 [debug] [Thread-1 (]: Began running node model.dbt_project_25.my_second_dbt_model
[0m09:58:02.849618 [info ] [Thread-1 (]: 10 of 10 START sql view model _.my_second_dbt_model ............................ [RUN]
[0m09:58:02.850617 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_25.storeclean, now model.dbt_project_25.my_second_dbt_model)
[0m09:58:02.851493 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.my_second_dbt_model
[0m09:58:02.856487 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.my_second_dbt_model"
[0m09:58:02.857721 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.my_second_dbt_model
[0m09:58:02.891703 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.my_second_dbt_model"
[0m09:58:02.893046 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_second_dbt_model"
[0m09:58:02.893932 [debug] [Thread-1 (]: On model.dbt_project_25.my_second_dbt_model: BEGIN
[0m09:58:02.894753 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:58:03.053747 [debug] [Thread-1 (]: SQL status: BEGIN in 0.159 seconds
[0m09:58:03.055689 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_second_dbt_model"
[0m09:58:03.057492 [debug] [Thread-1 (]: On model.dbt_project_25.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.my_second_dbt_model"} */

  create view "BI_group4"."_"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "BI_group4"."_"."my_first_dbt_model"
where id = 1
  );
[0m09:58:03.070416 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m09:58:03.079876 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_second_dbt_model"
[0m09:58:03.080872 [debug] [Thread-1 (]: On model.dbt_project_25.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.my_second_dbt_model"} */
alter table "BI_group4"."_"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m09:58:03.091840 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m09:58:03.094891 [debug] [Thread-1 (]: On model.dbt_project_25.my_second_dbt_model: COMMIT
[0m09:58:03.095796 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_second_dbt_model"
[0m09:58:03.096627 [debug] [Thread-1 (]: On model.dbt_project_25.my_second_dbt_model: COMMIT
[0m09:58:03.110158 [debug] [Thread-1 (]: SQL status: COMMIT in 0.012 seconds
[0m09:58:03.118359 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."_"."my_second_dbt_model__dbt_backup"
[0m09:58:03.125346 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_second_dbt_model"
[0m09:58:03.126365 [debug] [Thread-1 (]: On model.dbt_project_25.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.my_second_dbt_model"} */
drop view if exists "BI_group4"."_"."my_second_dbt_model__dbt_backup" cascade
[0m09:58:03.137076 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.010 seconds
[0m09:58:03.141982 [debug] [Thread-1 (]: On model.dbt_project_25.my_second_dbt_model: Close
[0m09:58:03.144471 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb64c696-0be0-41da-95e8-7e4817b14170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c44a7e0860>]}
[0m09:58:03.147259 [info ] [Thread-1 (]: 10 of 10 OK created sql view model _.my_second_dbt_model ....................... [[32mCREATE VIEW[0m in 0.29s]
[0m09:58:03.148569 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.my_second_dbt_model
[0m09:58:03.151947 [debug] [MainThread]: Using postgres connection "master"
[0m09:58:03.153657 [debug] [MainThread]: On master: BEGIN
[0m09:58:03.155192 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:58:03.366371 [debug] [MainThread]: SQL status: BEGIN in 0.211 seconds
[0m09:58:03.368249 [debug] [MainThread]: On master: COMMIT
[0m09:58:03.369877 [debug] [MainThread]: Using postgres connection "master"
[0m09:58:03.371445 [debug] [MainThread]: On master: COMMIT
[0m09:58:03.382530 [debug] [MainThread]: SQL status: COMMIT in 0.010 seconds
[0m09:58:03.383634 [debug] [MainThread]: On master: Close
[0m09:58:03.385042 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:58:03.386016 [debug] [MainThread]: Connection 'model.dbt_project_25.my_second_dbt_model' was properly closed.
[0m09:58:03.387153 [info ] [MainThread]: 
[0m09:58:03.388218 [info ] [MainThread]: Finished running 9 table models, 1 view model in 0 hours 0 minutes and 4.72 seconds (4.72s).
[0m09:58:03.391976 [debug] [MainThread]: Command end result
[0m09:58:03.439882 [debug] [MainThread]: Wrote artifact WritableManifest to /home/corentin.vanlandeghe@Digital-Grenoble.local/BI_DBT/target/manifest.json
[0m09:58:03.443273 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/corentin.vanlandeghe@Digital-Grenoble.local/BI_DBT/target/semantic_manifest.json
[0m09:58:03.454593 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/corentin.vanlandeghe@Digital-Grenoble.local/BI_DBT/target/run_results.json
[0m09:58:03.455378 [info ] [MainThread]: 
[0m09:58:03.456233 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m09:58:03.457006 [info ] [MainThread]: 
[0m09:58:03.457912 [error] [MainThread]: [31mFailure in model customerclean (models/staging/customerclean.sql)[0m
[0m09:58:03.458812 [error] [MainThread]:   Database Error in model customerclean (models/staging/customerclean.sql)
  syntax error at or near "from"
  LINE 18: from "BI_group4"."corentin"."customer"
           ^
  compiled code at target/run/dbt_project_25/models/staging/customerclean.sql
[0m09:58:03.459565 [info ] [MainThread]: 
[0m09:58:03.460415 [info ] [MainThread]:   compiled code at target/compiled/dbt_project_25/models/staging/customerclean.sql
[0m09:58:03.461192 [info ] [MainThread]: 
[0m09:58:03.462081 [error] [MainThread]: [31mFailure in model dateclean (models/staging/dateclean.sql)[0m
[0m09:58:03.462959 [error] [MainThread]:   Database Error in model dateclean (models/staging/dateclean.sql)
  syntax error at or near "as"
  LINE 16:     day_of_week, as number_day_week
                            ^
  compiled code at target/run/dbt_project_25/models/staging/dateclean.sql
[0m09:58:03.463701 [info ] [MainThread]: 
[0m09:58:03.464551 [info ] [MainThread]:   compiled code at target/compiled/dbt_project_25/models/staging/dateclean.sql
[0m09:58:03.465282 [info ] [MainThread]: 
[0m09:58:03.466087 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=10
[0m09:58:03.467830 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.0620165, "process_in_blocks": "448", "process_kernel_time": 0.524622, "process_mem_max_rss": "125304", "process_out_blocks": "2656", "process_user_time": 5.050738}
[0m09:58:03.468863 [debug] [MainThread]: Command `dbt run` failed at 09:58:03.468671 after 6.06 seconds
[0m09:58:03.469717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c44f303ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c44cb0a660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c44cb09a60>]}
[0m09:58:03.470590 [debug] [MainThread]: Flushing usage events
[0m09:58:03.918333 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:16:42.646759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0c65d11010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0c62a2af30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0c62cf8fb0>]}


============================== 10:16:42.652523 | 86850b34-2b77-4738-864c-1614f18c7751 ==============================
[0m10:16:42.652523 [info ] [MainThread]: Running with dbt=1.10.2
[0m10:16:42.653668 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/corentin.vanlandeghe@Digital-Grenoble.local/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/corentin.vanlandeghe@Digital-Grenoble.local/BI_DBT/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:16:43.011944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '86850b34-2b77-4738-864c-1614f18c7751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0c62b38950>]}
[0m10:16:43.137702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '86850b34-2b77-4738-864c-1614f18c7751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0c62426450>]}
[0m10:16:43.139161 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:16:43.321749 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m10:16:43.553112 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m10:16:43.555156 [debug] [MainThread]: Partial parsing: updated file: dbt_project_25://models/staging/schema.yml
[0m10:16:43.556066 [debug] [MainThread]: Partial parsing: updated file: dbt_project_25://models/staging/dateclean.sql
[0m10:16:44.322827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86850b34-2b77-4738-864c-1614f18c7751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0c609a2690>]}
[0m10:16:44.473837 [debug] [MainThread]: Wrote artifact WritableManifest to /home/corentin.vanlandeghe@Digital-Grenoble.local/BI_DBT/target/manifest.json
[0m10:16:44.476900 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/corentin.vanlandeghe@Digital-Grenoble.local/BI_DBT/target/semantic_manifest.json
[0m10:16:44.500198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '86850b34-2b77-4738-864c-1614f18c7751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0c609fea50>]}
[0m10:16:44.501202 [info ] [MainThread]: Found 10 models, 4 data tests, 8 sources, 549 macros
[0m10:16:44.502032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86850b34-2b77-4738-864c-1614f18c7751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0c61986810>]}
[0m10:16:44.505999 [info ] [MainThread]: 
[0m10:16:44.506833 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:16:44.507575 [info ] [MainThread]: 
[0m10:16:44.508615 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:16:44.517127 [debug] [ThreadPool]: Acquiring new postgres connection 'list_BI_group4'
[0m10:16:44.672476 [debug] [ThreadPool]: Using postgres connection "list_BI_group4"
[0m10:16:44.673391 [debug] [ThreadPool]: On list_BI_group4: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "connection_name": "list_BI_group4"} */

    select distinct nspname from pg_namespace
  
[0m10:16:44.674148 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:16:45.020949 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.347 seconds
[0m10:16:45.026327 [debug] [ThreadPool]: On list_BI_group4: Close
[0m10:16:45.034171 [debug] [ThreadPool]: Using postgres connection "list_BI_group4"
[0m10:16:45.035003 [debug] [ThreadPool]: On list_BI_group4: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "connection_name": "list_BI_group4"} */

    select distinct nspname from pg_namespace
  
[0m10:16:45.035752 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:16:45.222539 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.187 seconds
[0m10:16:45.227602 [debug] [ThreadPool]: On list_BI_group4: Close
[0m10:16:45.234165 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_BI_group4, now list_BI_group4__)
[0m10:16:45.249964 [debug] [ThreadPool]: Using postgres connection "list_BI_group4__"
[0m10:16:45.250777 [debug] [ThreadPool]: On list_BI_group4__: BEGIN
[0m10:16:45.251486 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:16:45.412108 [debug] [ThreadPool]: SQL status: BEGIN in 0.160 seconds
[0m10:16:45.413923 [debug] [ThreadPool]: Using postgres connection "list_BI_group4__"
[0m10:16:45.415645 [debug] [ThreadPool]: On list_BI_group4__: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "connection_name": "list_BI_group4__"} */
select
      'BI_group4' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike '_'
    union all
    select
      'BI_group4' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike '_'
    union all
    select
      'BI_group4' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike '_'
  
[0m10:16:45.434906 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.018 seconds
[0m10:16:45.440041 [debug] [ThreadPool]: On list_BI_group4__: ROLLBACK
[0m10:16:45.452140 [debug] [ThreadPool]: On list_BI_group4__: Close
[0m10:16:45.453754 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_BI_group4__, now list_BI_group4____staging)
[0m10:16:45.461186 [debug] [ThreadPool]: Using postgres connection "list_BI_group4____staging"
[0m10:16:45.462287 [debug] [ThreadPool]: On list_BI_group4____staging: BEGIN
[0m10:16:45.463298 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:16:45.622828 [debug] [ThreadPool]: SQL status: BEGIN in 0.159 seconds
[0m10:16:45.624442 [debug] [ThreadPool]: Using postgres connection "list_BI_group4____staging"
[0m10:16:45.625947 [debug] [ThreadPool]: On list_BI_group4____staging: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "connection_name": "list_BI_group4____staging"} */
select
      'BI_group4' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike '___staging'
    union all
    select
      'BI_group4' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike '___staging'
    union all
    select
      'BI_group4' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike '___staging'
  
[0m10:16:45.642212 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.015 seconds
[0m10:16:45.647931 [debug] [ThreadPool]: On list_BI_group4____staging: ROLLBACK
[0m10:16:45.658870 [debug] [ThreadPool]: On list_BI_group4____staging: Close
[0m10:16:45.675869 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:45.676678 [debug] [MainThread]: On master: BEGIN
[0m10:16:45.677379 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:16:45.850819 [debug] [MainThread]: SQL status: BEGIN in 0.173 seconds
[0m10:16:45.852647 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:45.854579 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:16:45.876404 [debug] [MainThread]: SQL status: SELECT 3 in 0.020 seconds
[0m10:16:45.882432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86850b34-2b77-4738-864c-1614f18c7751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0c6051ff50>]}
[0m10:16:45.884385 [debug] [MainThread]: On master: ROLLBACK
[0m10:16:45.895086 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:45.895898 [debug] [MainThread]: On master: BEGIN
[0m10:16:45.915932 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m10:16:45.917594 [debug] [MainThread]: On master: COMMIT
[0m10:16:45.919152 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:45.920697 [debug] [MainThread]: On master: COMMIT
[0m10:16:45.931719 [debug] [MainThread]: SQL status: COMMIT in 0.009 seconds
[0m10:16:45.932793 [debug] [MainThread]: On master: Close
[0m10:16:45.938775 [debug] [Thread-1 (]: Began running node model.dbt_project_25.customerclean
[0m10:16:45.941101 [info ] [Thread-1 (]: 1 of 10 START sql table model ___staging.customerclean ......................... [RUN]
[0m10:16:45.943161 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_BI_group4____staging, now model.dbt_project_25.customerclean)
[0m10:16:45.944980 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.customerclean
[0m10:16:45.960790 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.customerclean"
[0m10:16:45.962142 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.customerclean
[0m10:16:46.033365 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.customerclean"
[0m10:16:46.034790 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.customerclean"
[0m10:16:46.035683 [debug] [Thread-1 (]: On model.dbt_project_25.customerclean: BEGIN
[0m10:16:46.036489 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:16:46.203935 [debug] [Thread-1 (]: SQL status: BEGIN in 0.167 seconds
[0m10:16:46.205871 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.customerclean"
[0m10:16:46.207711 [debug] [Thread-1 (]: On model.dbt_project_25.customerclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.customerclean"} */

  
    

  create  table "BI_group4"."___staging"."customerclean__dbt_tmp"
  
  
    as
  
  (
    

select
    customerid, 
	storeid,
    territoryid,
from "BI_group4"."corentin"."customer"
  );
  
[0m10:16:46.219372 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "from"
LINE 18: from "BI_group4"."corentin"."customer"
         ^

[0m10:16:46.221279 [debug] [Thread-1 (]: On model.dbt_project_25.customerclean: ROLLBACK
[0m10:16:46.232951 [debug] [Thread-1 (]: On model.dbt_project_25.customerclean: Close
[0m10:16:46.241809 [debug] [Thread-1 (]: Database Error in model customerclean (models/staging/customerclean.sql)
  syntax error at or near "from"
  LINE 18: from "BI_group4"."corentin"."customer"
           ^
  compiled code at target/run/dbt_project_25/models/staging/customerclean.sql
[0m10:16:46.244856 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86850b34-2b77-4738-864c-1614f18c7751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0c634000e0>]}
[0m10:16:46.246233 [error] [Thread-1 (]: 1 of 10 ERROR creating sql table model ___staging.customerclean ................ [[31mERROR[0m in 0.30s]
[0m10:16:46.247592 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.customerclean
[0m10:16:46.248546 [debug] [Thread-1 (]: Began running node model.dbt_project_25.dateclean
[0m10:16:46.250284 [debug] [Thread-4 (]: Marking all children of 'model.dbt_project_25.customerclean' to be skipped because of status 'error'.  Reason: Database Error in model customerclean (models/staging/customerclean.sql)
  syntax error at or near "from"
  LINE 18: from "BI_group4"."corentin"."customer"
           ^
  compiled code at target/run/dbt_project_25/models/staging/customerclean.sql.
[0m10:16:46.252177 [info ] [Thread-1 (]: 2 of 10 START sql table model ___staging.dateclean ............................. [RUN]
[0m10:16:46.256210 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_25.customerclean, now model.dbt_project_25.dateclean)
[0m10:16:46.258103 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.dateclean
[0m10:16:46.271970 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.dateclean"
[0m10:16:46.273318 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.dateclean
[0m10:16:46.280469 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.dateclean"
[0m10:16:46.281785 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.dateclean"
[0m10:16:46.282677 [debug] [Thread-1 (]: On model.dbt_project_25.dateclean: BEGIN
[0m10:16:46.283521 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:16:46.447054 [debug] [Thread-1 (]: SQL status: BEGIN in 0.163 seconds
[0m10:16:46.449089 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.dateclean"
[0m10:16:46.450931 [debug] [Thread-1 (]: On model.dbt_project_25.dateclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.dateclean"} */

  
    

  create  table "BI_group4"."___staging"."dateclean__dbt_tmp"
  
  
    as
  
  (
    

select
    date_day,
    day_of_week as number_day_week,
    day_of_week_name as day_name
    
from "BI_group4"."corentin"."date"
  );
  
[0m10:16:46.468126 [debug] [Thread-1 (]: SQL status: SELECT 731 in 0.015 seconds
[0m10:16:46.492814 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.dateclean"
[0m10:16:46.493738 [debug] [Thread-1 (]: On model.dbt_project_25.dateclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.dateclean"} */
alter table "BI_group4"."___staging"."dateclean__dbt_tmp" rename to "dateclean"
[0m10:16:46.505390 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.011 seconds
[0m10:16:46.532156 [debug] [Thread-1 (]: On model.dbt_project_25.dateclean: COMMIT
[0m10:16:46.533061 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.dateclean"
[0m10:16:46.533891 [debug] [Thread-1 (]: On model.dbt_project_25.dateclean: COMMIT
[0m10:16:46.547670 [debug] [Thread-1 (]: SQL status: COMMIT in 0.013 seconds
[0m10:16:46.559401 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."___staging"."dateclean__dbt_backup"
[0m10:16:46.569459 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.dateclean"
[0m10:16:46.570356 [debug] [Thread-1 (]: On model.dbt_project_25.dateclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.dateclean"} */
drop table if exists "BI_group4"."___staging"."dateclean__dbt_backup" cascade
[0m10:16:46.581323 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.010 seconds
[0m10:16:46.590371 [debug] [Thread-1 (]: On model.dbt_project_25.dateclean: Close
[0m10:16:46.592358 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86850b34-2b77-4738-864c-1614f18c7751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0c61d61970>]}
[0m10:16:46.593685 [info ] [Thread-1 (]: 2 of 10 OK created sql table model ___staging.dateclean ........................ [[32mSELECT 731[0m in 0.34s]
[0m10:16:46.594970 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.dateclean
[0m10:16:46.595903 [debug] [Thread-1 (]: Began running node model.dbt_project_25.my_first_dbt_model
[0m10:16:46.597150 [info ] [Thread-1 (]: 3 of 10 START sql table model _.my_first_dbt_model ............................. [RUN]
[0m10:16:46.598141 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_25.dateclean, now model.dbt_project_25.my_first_dbt_model)
[0m10:16:46.599013 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.my_first_dbt_model
[0m10:16:46.603955 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.my_first_dbt_model"
[0m10:16:46.605121 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.my_first_dbt_model
[0m10:16:46.612091 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.my_first_dbt_model"
[0m10:16:46.613327 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_first_dbt_model"
[0m10:16:46.614194 [debug] [Thread-1 (]: On model.dbt_project_25.my_first_dbt_model: BEGIN
[0m10:16:46.615005 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:16:46.787531 [debug] [Thread-1 (]: SQL status: BEGIN in 0.172 seconds
[0m10:16:46.789539 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_first_dbt_model"
[0m10:16:46.791418 [debug] [Thread-1 (]: On model.dbt_project_25.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.my_first_dbt_model"} */

  
    

  create  table "BI_group4"."_"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m10:16:46.805792 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.013 seconds
[0m10:16:46.815984 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_first_dbt_model"
[0m10:16:46.816991 [debug] [Thread-1 (]: On model.dbt_project_25.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.my_first_dbt_model"} */
alter table "BI_group4"."_"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m10:16:46.827928 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m10:16:46.834090 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_first_dbt_model"
[0m10:16:46.834976 [debug] [Thread-1 (]: On model.dbt_project_25.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.my_first_dbt_model"} */
alter table "BI_group4"."_"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m10:16:46.846306 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m10:16:46.856139 [debug] [Thread-1 (]: On model.dbt_project_25.my_first_dbt_model: COMMIT
[0m10:16:46.857049 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_first_dbt_model"
[0m10:16:46.857889 [debug] [Thread-1 (]: On model.dbt_project_25.my_first_dbt_model: COMMIT
[0m10:16:46.870794 [debug] [Thread-1 (]: SQL status: COMMIT in 0.012 seconds
[0m10:16:46.876756 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."_"."my_first_dbt_model__dbt_backup"
[0m10:16:46.879220 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_first_dbt_model"
[0m10:16:46.880435 [debug] [Thread-1 (]: On model.dbt_project_25.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.my_first_dbt_model"} */
drop table if exists "BI_group4"."_"."my_first_dbt_model__dbt_backup" cascade
[0m10:16:46.902489 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.021 seconds
[0m10:16:46.907860 [debug] [Thread-1 (]: On model.dbt_project_25.my_first_dbt_model: Close
[0m10:16:46.910373 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86850b34-2b77-4738-864c-1614f18c7751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0c60dd7440>]}
[0m10:16:46.912997 [info ] [Thread-1 (]: 3 of 10 OK created sql table model _.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.31s]
[0m10:16:46.914279 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.my_first_dbt_model
[0m10:16:46.915216 [debug] [Thread-1 (]: Began running node model.dbt_project_25.salesorderdetailsclean
[0m10:16:46.916520 [info ] [Thread-1 (]: 4 of 10 START sql table model ___staging.salesorderdetailsclean ................ [RUN]
[0m10:16:46.917739 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_25.my_first_dbt_model, now model.dbt_project_25.salesorderdetailsclean)
[0m10:16:46.918692 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.salesorderdetailsclean
[0m10:16:46.927105 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.salesorderdetailsclean"
[0m10:16:46.928365 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.salesorderdetailsclean
[0m10:16:46.935675 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.salesorderdetailsclean"
[0m10:16:46.937002 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderdetailsclean"
[0m10:16:46.937903 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderdetailsclean: BEGIN
[0m10:16:46.938742 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:16:47.158278 [debug] [Thread-1 (]: SQL status: BEGIN in 0.219 seconds
[0m10:16:47.160280 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderdetailsclean"
[0m10:16:47.162135 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderdetailsclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.salesorderdetailsclean"} */

  
    

  create  table "BI_group4"."___staging"."salesorderdetailsclean__dbt_tmp"
  
  
    as
  
  (
    

select 
	salesorderid, 
	unitprice,
	orderqty as orderquantity,
	productid,
	unitpricediscount as discount

from "BI_group4"."corentin"."salesorderdetail"
  );
  
[0m10:16:47.189980 [debug] [Thread-1 (]: SQL status: SELECT 5716 in 0.026 seconds
[0m10:16:47.200982 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderdetailsclean"
[0m10:16:47.202352 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderdetailsclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.salesorderdetailsclean"} */
alter table "BI_group4"."___staging"."salesorderdetailsclean" rename to "salesorderdetailsclean__dbt_backup"
[0m10:16:47.214719 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.011 seconds
[0m10:16:47.225719 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderdetailsclean"
[0m10:16:47.226616 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderdetailsclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.salesorderdetailsclean"} */
alter table "BI_group4"."___staging"."salesorderdetailsclean__dbt_tmp" rename to "salesorderdetailsclean"
[0m10:16:47.239624 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.012 seconds
[0m10:16:47.245237 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderdetailsclean: COMMIT
[0m10:16:47.246244 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderdetailsclean"
[0m10:16:47.247223 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderdetailsclean: COMMIT
[0m10:16:47.287000 [debug] [Thread-1 (]: SQL status: COMMIT in 0.039 seconds
[0m10:16:47.293964 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."___staging"."salesorderdetailsclean__dbt_backup"
[0m10:16:47.296252 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderdetailsclean"
[0m10:16:47.297124 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderdetailsclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.salesorderdetailsclean"} */
drop table if exists "BI_group4"."___staging"."salesorderdetailsclean__dbt_backup" cascade
[0m10:16:47.314124 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.016 seconds
[0m10:16:47.319294 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderdetailsclean: Close
[0m10:16:47.321831 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86850b34-2b77-4738-864c-1614f18c7751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0c60dd0290>]}
[0m10:16:47.324492 [info ] [Thread-1 (]: 4 of 10 OK created sql table model ___staging.salesorderdetailsclean ........... [[32mSELECT 5716[0m in 0.40s]
[0m10:16:47.326154 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.salesorderdetailsclean
[0m10:16:47.327090 [debug] [Thread-1 (]: Began running node model.dbt_project_25.salesorderheaderclean
[0m10:16:47.328326 [info ] [Thread-1 (]: 5 of 10 START sql table model ___staging.salesorderheaderclean ................. [RUN]
[0m10:16:47.329333 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_25.salesorderdetailsclean, now model.dbt_project_25.salesorderheaderclean)
[0m10:16:47.330242 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.salesorderheaderclean
[0m10:16:47.335904 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.salesorderheaderclean"
[0m10:16:47.337125 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.salesorderheaderclean
[0m10:16:47.344435 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.salesorderheaderclean"
[0m10:16:47.345766 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderheaderclean"
[0m10:16:47.346663 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderheaderclean: BEGIN
[0m10:16:47.347483 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:16:47.511256 [debug] [Thread-1 (]: SQL status: BEGIN in 0.163 seconds
[0m10:16:47.513280 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderheaderclean"
[0m10:16:47.515139 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderheaderclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.salesorderheaderclean"} */

  
    

  create  table "BI_group4"."___staging"."salesorderheaderclean__dbt_tmp"
  
  
    as
  
  (
    

select
    orderdate,
    salesorderid,
    territoryid,
    salespersonid as salerid,
    billtoaddressid,
    customerid,
    salespersonid,
    shipdate
from "BI_group4"."corentin"."salesorderheader"
  );
  
[0m10:16:47.534427 [debug] [Thread-1 (]: SQL status: SELECT 1566 in 0.017 seconds
[0m10:16:47.546877 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderheaderclean"
[0m10:16:47.547774 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderheaderclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.salesorderheaderclean"} */
alter table "BI_group4"."___staging"."salesorderheaderclean" rename to "salesorderheaderclean__dbt_backup"
[0m10:16:47.559620 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.011 seconds
[0m10:16:47.569226 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderheaderclean"
[0m10:16:47.570190 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderheaderclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.salesorderheaderclean"} */
alter table "BI_group4"."___staging"."salesorderheaderclean__dbt_tmp" rename to "salesorderheaderclean"
[0m10:16:47.581231 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m10:16:47.585676 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderheaderclean: COMMIT
[0m10:16:47.586836 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderheaderclean"
[0m10:16:47.587688 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderheaderclean: COMMIT
[0m10:16:47.602489 [debug] [Thread-1 (]: SQL status: COMMIT in 0.014 seconds
[0m10:16:47.615084 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."___staging"."salesorderheaderclean__dbt_backup"
[0m10:16:47.617935 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderheaderclean"
[0m10:16:47.618838 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderheaderclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.salesorderheaderclean"} */
drop table if exists "BI_group4"."___staging"."salesorderheaderclean__dbt_backup" cascade
[0m10:16:47.641383 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.021 seconds
[0m10:16:47.646722 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderheaderclean: Close
[0m10:16:47.648670 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86850b34-2b77-4738-864c-1614f18c7751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0c5e302060>]}
[0m10:16:47.650372 [info ] [Thread-1 (]: 5 of 10 OK created sql table model ___staging.salesorderheaderclean ............ [[32mSELECT 1566[0m in 0.32s]
[0m10:16:47.652062 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.salesorderheaderclean
[0m10:16:47.653255 [debug] [Thread-1 (]: Began running node model.dbt_project_25.stg_product
[0m10:16:47.654771 [info ] [Thread-1 (]: 6 of 10 START sql table model ___staging.stg_product ........................... [RUN]
[0m10:16:47.656055 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_25.salesorderheaderclean, now model.dbt_project_25.stg_product)
[0m10:16:47.657205 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.stg_product
[0m10:16:47.663200 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.stg_product"
[0m10:16:47.664463 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.stg_product
[0m10:16:47.671518 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.stg_product"
[0m10:16:47.672799 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_product"
[0m10:16:47.673685 [debug] [Thread-1 (]: On model.dbt_project_25.stg_product: BEGIN
[0m10:16:47.674518 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:16:47.834231 [debug] [Thread-1 (]: SQL status: BEGIN in 0.159 seconds
[0m10:16:47.836210 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_product"
[0m10:16:47.838075 [debug] [Thread-1 (]: On model.dbt_project_25.stg_product: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_product"} */

  
    

  create  table "BI_group4"."___staging"."stg_product__dbt_tmp"
  
  
    as
  
  (
    

SELECT
  productid, 
  name AS itemname
FROM "BI_group4"."corentin"."product"

--run in terminal/shell: 
--dbt run --select stg_product

--(This will build the model as a new view/table in your dev schema, leaving the original data untouched)
  );
  
[0m10:16:47.852534 [debug] [Thread-1 (]: SQL status: SELECT 504 in 0.013 seconds
[0m10:16:47.862991 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_product"
[0m10:16:47.864158 [debug] [Thread-1 (]: On model.dbt_project_25.stg_product: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_product"} */
alter table "BI_group4"."___staging"."stg_product" rename to "stg_product__dbt_backup"
[0m10:16:47.875310 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m10:16:47.881077 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_product"
[0m10:16:47.881979 [debug] [Thread-1 (]: On model.dbt_project_25.stg_product: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_product"} */
alter table "BI_group4"."___staging"."stg_product__dbt_tmp" rename to "stg_product"
[0m10:16:47.893162 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m10:16:47.898384 [debug] [Thread-1 (]: On model.dbt_project_25.stg_product: COMMIT
[0m10:16:47.899346 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_product"
[0m10:16:47.900191 [debug] [Thread-1 (]: On model.dbt_project_25.stg_product: COMMIT
[0m10:16:47.912170 [debug] [Thread-1 (]: SQL status: COMMIT in 0.011 seconds
[0m10:16:47.920194 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."___staging"."stg_product__dbt_backup"
[0m10:16:47.922185 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_product"
[0m10:16:47.923178 [debug] [Thread-1 (]: On model.dbt_project_25.stg_product: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_product"} */
drop table if exists "BI_group4"."___staging"."stg_product__dbt_backup" cascade
[0m10:16:47.937599 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.013 seconds
[0m10:16:47.941096 [debug] [Thread-1 (]: On model.dbt_project_25.stg_product: Close
[0m10:16:47.942963 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86850b34-2b77-4738-864c-1614f18c7751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0c5e301f40>]}
[0m10:16:47.944928 [info ] [Thread-1 (]: 6 of 10 OK created sql table model ___staging.stg_product ...................... [[32mSELECT 504[0m in 0.29s]
[0m10:16:47.946852 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.stg_product
[0m10:16:47.948258 [debug] [Thread-1 (]: Began running node model.dbt_project_25.stg_productcat
[0m10:16:47.949575 [info ] [Thread-1 (]: 7 of 10 START sql table model ___staging.stg_productcat ........................ [RUN]
[0m10:16:47.950742 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_25.stg_product, now model.dbt_project_25.stg_productcat)
[0m10:16:47.951652 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.stg_productcat
[0m10:16:47.957301 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.stg_productcat"
[0m10:16:47.958555 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.stg_productcat
[0m10:16:47.965627 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.stg_productcat"
[0m10:16:47.966950 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_productcat"
[0m10:16:47.967849 [debug] [Thread-1 (]: On model.dbt_project_25.stg_productcat: BEGIN
[0m10:16:47.968693 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:16:48.202091 [debug] [Thread-1 (]: SQL status: BEGIN in 0.233 seconds
[0m10:16:48.204092 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_productcat"
[0m10:16:48.205957 [debug] [Thread-1 (]: On model.dbt_project_25.stg_productcat: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_productcat"} */

  
    

  create  table "BI_group4"."___staging"."stg_productcat__dbt_tmp"
  
  
    as
  
  (
    

SELECT
  productcategoryid, 
  name AS itemcategoryname
FROM "BI_group4"."corentin"."productcategory"

--run in terminal/shell: 
--dbt run --select stg_productcat

--(This will build the model as a new view/table in your dev schema, leaving the original data untouched)
  );
  
[0m10:16:48.221853 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.014 seconds
[0m10:16:48.232851 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_productcat"
[0m10:16:48.233767 [debug] [Thread-1 (]: On model.dbt_project_25.stg_productcat: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_productcat"} */
alter table "BI_group4"."___staging"."stg_productcat" rename to "stg_productcat__dbt_backup"
[0m10:16:48.245139 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m10:16:48.252510 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_productcat"
[0m10:16:48.253399 [debug] [Thread-1 (]: On model.dbt_project_25.stg_productcat: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_productcat"} */
alter table "BI_group4"."___staging"."stg_productcat__dbt_tmp" rename to "stg_productcat"
[0m10:16:48.264759 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m10:16:48.270005 [debug] [Thread-1 (]: On model.dbt_project_25.stg_productcat: COMMIT
[0m10:16:48.271048 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_productcat"
[0m10:16:48.271905 [debug] [Thread-1 (]: On model.dbt_project_25.stg_productcat: COMMIT
[0m10:16:48.286749 [debug] [Thread-1 (]: SQL status: COMMIT in 0.014 seconds
[0m10:16:48.299143 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."___staging"."stg_productcat__dbt_backup"
[0m10:16:48.301749 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_productcat"
[0m10:16:48.302636 [debug] [Thread-1 (]: On model.dbt_project_25.stg_productcat: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_productcat"} */
drop table if exists "BI_group4"."___staging"."stg_productcat__dbt_backup" cascade
[0m10:16:48.320877 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.017 seconds
[0m10:16:48.326127 [debug] [Thread-1 (]: On model.dbt_project_25.stg_productcat: Close
[0m10:16:48.328622 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86850b34-2b77-4738-864c-1614f18c7751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0c5e34d8b0>]}
[0m10:16:48.331262 [info ] [Thread-1 (]: 7 of 10 OK created sql table model ___staging.stg_productcat ................... [[32mSELECT 4[0m in 0.38s]
[0m10:16:48.332582 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.stg_productcat
[0m10:16:48.333522 [debug] [Thread-1 (]: Began running node model.dbt_project_25.stg_stateprovince
[0m10:16:48.334733 [info ] [Thread-1 (]: 8 of 10 START sql table model ___staging.stg_stateprovince ..................... [RUN]
[0m10:16:48.335737 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_25.stg_productcat, now model.dbt_project_25.stg_stateprovince)
[0m10:16:48.336623 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.stg_stateprovince
[0m10:16:48.342477 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.stg_stateprovince"
[0m10:16:48.343761 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.stg_stateprovince
[0m10:16:48.351083 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.stg_stateprovince"
[0m10:16:48.352402 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_stateprovince"
[0m10:16:48.353299 [debug] [Thread-1 (]: On model.dbt_project_25.stg_stateprovince: BEGIN
[0m10:16:48.354135 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:16:48.515300 [debug] [Thread-1 (]: SQL status: BEGIN in 0.161 seconds
[0m10:16:48.517347 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_stateprovince"
[0m10:16:48.533328 [debug] [Thread-1 (]: On model.dbt_project_25.stg_stateprovince: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_stateprovince"} */

  
    

  create  table "BI_group4"."___staging"."stg_stateprovince__dbt_tmp"
  
  
    as
  
  (
    

SELECT
  stateprovinceid, 
  countryregioncode,
  territoryid,
  name AS regionname,
  stateprovincecode
FROM "BI_group4"."corentin"."stateprovince"

--run in terminal/shell: 
--dbt run --select stg_stateprovince

--(This will build the model as a new view/table in your dev schema, leaving the original data untouched)
  );
  
[0m10:16:48.548169 [debug] [Thread-1 (]: SQL status: SELECT 181 in 0.013 seconds
[0m10:16:48.559756 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_stateprovince"
[0m10:16:48.561242 [debug] [Thread-1 (]: On model.dbt_project_25.stg_stateprovince: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_stateprovince"} */
alter table "BI_group4"."___staging"."stg_stateprovince" rename to "stg_stateprovince__dbt_backup"
[0m10:16:48.573319 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m10:16:48.583805 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_stateprovince"
[0m10:16:48.584703 [debug] [Thread-1 (]: On model.dbt_project_25.stg_stateprovince: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_stateprovince"} */
alter table "BI_group4"."___staging"."stg_stateprovince__dbt_tmp" rename to "stg_stateprovince"
[0m10:16:48.595744 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m10:16:48.599417 [debug] [Thread-1 (]: On model.dbt_project_25.stg_stateprovince: COMMIT
[0m10:16:48.600325 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_stateprovince"
[0m10:16:48.601175 [debug] [Thread-1 (]: On model.dbt_project_25.stg_stateprovince: COMMIT
[0m10:16:48.614344 [debug] [Thread-1 (]: SQL status: COMMIT in 0.012 seconds
[0m10:16:48.620669 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."___staging"."stg_stateprovince__dbt_backup"
[0m10:16:48.623083 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_stateprovince"
[0m10:16:48.623957 [debug] [Thread-1 (]: On model.dbt_project_25.stg_stateprovince: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_stateprovince"} */
drop table if exists "BI_group4"."___staging"."stg_stateprovince__dbt_backup" cascade
[0m10:16:48.639124 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.014 seconds
[0m10:16:48.644288 [debug] [Thread-1 (]: On model.dbt_project_25.stg_stateprovince: Close
[0m10:16:48.646576 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86850b34-2b77-4738-864c-1614f18c7751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0c64b686e0>]}
[0m10:16:48.648945 [info ] [Thread-1 (]: 8 of 10 OK created sql table model ___staging.stg_stateprovince ................ [[32mSELECT 181[0m in 0.31s]
[0m10:16:48.651289 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.stg_stateprovince
[0m10:16:48.653005 [debug] [Thread-1 (]: Began running node model.dbt_project_25.storeclean
[0m10:16:48.654341 [info ] [Thread-1 (]: 9 of 10 START sql table model ___staging.storeclean ............................ [RUN]
[0m10:16:48.655535 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_25.stg_stateprovince, now model.dbt_project_25.storeclean)
[0m10:16:48.656426 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.storeclean
[0m10:16:48.662053 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.storeclean"
[0m10:16:48.663285 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.storeclean
[0m10:16:48.670565 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.storeclean"
[0m10:16:48.671839 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.storeclean"
[0m10:16:48.672728 [debug] [Thread-1 (]: On model.dbt_project_25.storeclean: BEGIN
[0m10:16:48.673560 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:16:48.839260 [debug] [Thread-1 (]: SQL status: BEGIN in 0.165 seconds
[0m10:16:48.841250 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.storeclean"
[0m10:16:48.843098 [debug] [Thread-1 (]: On model.dbt_project_25.storeclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.storeclean"} */

  
    

  create  table "BI_group4"."___staging"."storeclean__dbt_tmp"
  
  
    as
  
  (
    

select
    salespersonid as salerid,
    storename,
    businessentityid
from "BI_group4"."corentin"."store1"
  );
  
[0m10:16:48.860276 [debug] [Thread-1 (]: SQL status: SELECT 701 in 0.015 seconds
[0m10:16:48.872283 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.storeclean"
[0m10:16:48.873928 [debug] [Thread-1 (]: On model.dbt_project_25.storeclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.storeclean"} */
alter table "BI_group4"."___staging"."storeclean" rename to "storeclean__dbt_backup"
[0m10:16:48.886903 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.012 seconds
[0m10:16:48.896510 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.storeclean"
[0m10:16:48.897404 [debug] [Thread-1 (]: On model.dbt_project_25.storeclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.storeclean"} */
alter table "BI_group4"."___staging"."storeclean__dbt_tmp" rename to "storeclean"
[0m10:16:48.908848 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.011 seconds
[0m10:16:48.912318 [debug] [Thread-1 (]: On model.dbt_project_25.storeclean: COMMIT
[0m10:16:48.913232 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.storeclean"
[0m10:16:48.914081 [debug] [Thread-1 (]: On model.dbt_project_25.storeclean: COMMIT
[0m10:16:48.927113 [debug] [Thread-1 (]: SQL status: COMMIT in 0.012 seconds
[0m10:16:48.938186 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."___staging"."storeclean__dbt_backup"
[0m10:16:48.939978 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.storeclean"
[0m10:16:48.940869 [debug] [Thread-1 (]: On model.dbt_project_25.storeclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.storeclean"} */
drop table if exists "BI_group4"."___staging"."storeclean__dbt_backup" cascade
[0m10:16:48.957101 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.015 seconds
[0m10:16:48.962383 [debug] [Thread-1 (]: On model.dbt_project_25.storeclean: Close
[0m10:16:48.964869 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86850b34-2b77-4738-864c-1614f18c7751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0c5e3483e0>]}
[0m10:16:48.966173 [info ] [Thread-1 (]: 9 of 10 OK created sql table model ___staging.storeclean ....................... [[32mSELECT 701[0m in 0.31s]
[0m10:16:48.967444 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.storeclean
[0m10:16:48.968370 [debug] [Thread-1 (]: Began running node model.dbt_project_25.my_second_dbt_model
[0m10:16:48.969584 [info ] [Thread-1 (]: 10 of 10 START sql view model _.my_second_dbt_model ............................ [RUN]
[0m10:16:48.970573 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_25.storeclean, now model.dbt_project_25.my_second_dbt_model)
[0m10:16:48.971451 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.my_second_dbt_model
[0m10:16:48.976485 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.my_second_dbt_model"
[0m10:16:48.977742 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.my_second_dbt_model
[0m10:16:49.012035 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.my_second_dbt_model"
[0m10:16:49.013377 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_second_dbt_model"
[0m10:16:49.014256 [debug] [Thread-1 (]: On model.dbt_project_25.my_second_dbt_model: BEGIN
[0m10:16:49.015056 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:16:49.210950 [debug] [Thread-1 (]: SQL status: BEGIN in 0.196 seconds
[0m10:16:49.212715 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_second_dbt_model"
[0m10:16:49.214307 [debug] [Thread-1 (]: On model.dbt_project_25.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.my_second_dbt_model"} */

  create view "BI_group4"."_"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "BI_group4"."_"."my_first_dbt_model"
where id = 1
  );
[0m10:16:49.228255 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m10:16:49.238541 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_second_dbt_model"
[0m10:16:49.239402 [debug] [Thread-1 (]: On model.dbt_project_25.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.my_second_dbt_model"} */
alter table "BI_group4"."_"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m10:16:49.250823 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m10:16:49.255313 [debug] [Thread-1 (]: On model.dbt_project_25.my_second_dbt_model: COMMIT
[0m10:16:49.256551 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_second_dbt_model"
[0m10:16:49.257469 [debug] [Thread-1 (]: On model.dbt_project_25.my_second_dbt_model: COMMIT
[0m10:16:49.269890 [debug] [Thread-1 (]: SQL status: COMMIT in 0.011 seconds
[0m10:16:49.278151 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."_"."my_second_dbt_model__dbt_backup"
[0m10:16:49.285134 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_second_dbt_model"
[0m10:16:49.286141 [debug] [Thread-1 (]: On model.dbt_project_25.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.my_second_dbt_model"} */
drop view if exists "BI_group4"."_"."my_second_dbt_model__dbt_backup" cascade
[0m10:16:49.297580 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.010 seconds
[0m10:16:49.301205 [debug] [Thread-1 (]: On model.dbt_project_25.my_second_dbt_model: Close
[0m10:16:49.303010 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86850b34-2b77-4738-864c-1614f18c7751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0c61974b00>]}
[0m10:16:49.304845 [info ] [Thread-1 (]: 10 of 10 OK created sql view model _.my_second_dbt_model ....................... [[32mCREATE VIEW[0m in 0.33s]
[0m10:16:49.306634 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.my_second_dbt_model
[0m10:16:49.310105 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:49.311790 [debug] [MainThread]: On master: BEGIN
[0m10:16:49.313319 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:16:49.472522 [debug] [MainThread]: SQL status: BEGIN in 0.159 seconds
[0m10:16:49.474331 [debug] [MainThread]: On master: COMMIT
[0m10:16:49.475940 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:49.477473 [debug] [MainThread]: On master: COMMIT
[0m10:16:49.488793 [debug] [MainThread]: SQL status: COMMIT in 0.010 seconds
[0m10:16:49.490295 [debug] [MainThread]: On master: Close
[0m10:16:49.492236 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:16:49.493648 [debug] [MainThread]: Connection 'model.dbt_project_25.my_second_dbt_model' was properly closed.
[0m10:16:49.495265 [info ] [MainThread]: 
[0m10:16:49.496808 [info ] [MainThread]: Finished running 9 table models, 1 view model in 0 hours 0 minutes and 4.99 seconds (4.99s).
[0m10:16:49.501263 [debug] [MainThread]: Command end result
[0m10:16:49.548865 [debug] [MainThread]: Wrote artifact WritableManifest to /home/corentin.vanlandeghe@Digital-Grenoble.local/BI_DBT/target/manifest.json
[0m10:16:49.552159 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/corentin.vanlandeghe@Digital-Grenoble.local/BI_DBT/target/semantic_manifest.json
[0m10:16:49.563142 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/corentin.vanlandeghe@Digital-Grenoble.local/BI_DBT/target/run_results.json
[0m10:16:49.563933 [info ] [MainThread]: 
[0m10:16:49.564772 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:16:49.565549 [info ] [MainThread]: 
[0m10:16:49.566445 [error] [MainThread]: [31mFailure in model customerclean (models/staging/customerclean.sql)[0m
[0m10:16:49.567351 [error] [MainThread]:   Database Error in model customerclean (models/staging/customerclean.sql)
  syntax error at or near "from"
  LINE 18: from "BI_group4"."corentin"."customer"
           ^
  compiled code at target/run/dbt_project_25/models/staging/customerclean.sql
[0m10:16:49.568114 [info ] [MainThread]: 
[0m10:16:49.568978 [info ] [MainThread]:   compiled code at target/compiled/dbt_project_25/models/staging/customerclean.sql
[0m10:16:49.569739 [info ] [MainThread]: 
[0m10:16:49.570550 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=10
[0m10:16:49.572289 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.0346107, "process_in_blocks": "0", "process_kernel_time": 0.520823, "process_mem_max_rss": "129040", "process_out_blocks": "3840", "process_user_time": 5.851011}
[0m10:16:49.573308 [debug] [MainThread]: Command `dbt run` failed at 10:16:49.573119 after 7.04 seconds
[0m10:16:49.574153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0c5e4e4620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0c5e35c6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0c637f53d0>]}
[0m10:16:49.575011 [debug] [MainThread]: Flushing usage events
[0m10:16:50.088188 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:17:23.475847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e3aa2e9a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e3aa1b2240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e3aa2e96a0>]}


============================== 10:17:23.481611 | e468b667-7412-452b-b2c6-991cd6341119 ==============================
[0m10:17:23.481611 [info ] [MainThread]: Running with dbt=1.10.2
[0m10:17:23.482758 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/corentin.vanlandeghe@Digital-Grenoble.local/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/corentin.vanlandeghe@Digital-Grenoble.local/BI_DBT/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:17:23.806337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e468b667-7412-452b-b2c6-991cd6341119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e3a97bfd40>]}
[0m10:17:23.932683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e468b667-7412-452b-b2c6-991cd6341119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e3a9a13590>]}
[0m10:17:23.934178 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:17:24.114667 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m10:17:24.345154 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:17:24.346407 [debug] [MainThread]: Partial parsing: updated file: dbt_project_25://models/staging/schema.yml
[0m10:17:24.533403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e468b667-7412-452b-b2c6-991cd6341119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e3a9325880>]}
[0m10:17:24.689135 [debug] [MainThread]: Wrote artifact WritableManifest to /home/corentin.vanlandeghe@Digital-Grenoble.local/BI_DBT/target/manifest.json
[0m10:17:24.692165 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/corentin.vanlandeghe@Digital-Grenoble.local/BI_DBT/target/semantic_manifest.json
[0m10:17:24.715165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e468b667-7412-452b-b2c6-991cd6341119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e3a8fcd4c0>]}
[0m10:17:24.716135 [info ] [MainThread]: Found 10 models, 4 data tests, 8 sources, 549 macros
[0m10:17:24.716945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e468b667-7412-452b-b2c6-991cd6341119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e3a8b55610>]}
[0m10:17:24.720918 [info ] [MainThread]: 
[0m10:17:24.721758 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:17:24.722484 [info ] [MainThread]: 
[0m10:17:24.723555 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:17:24.732189 [debug] [ThreadPool]: Acquiring new postgres connection 'list_BI_group4'
[0m10:17:24.803138 [debug] [ThreadPool]: Using postgres connection "list_BI_group4"
[0m10:17:24.804050 [debug] [ThreadPool]: On list_BI_group4: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "connection_name": "list_BI_group4"} */

    select distinct nspname from pg_namespace
  
[0m10:17:24.804806 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:17:24.978946 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.174 seconds
[0m10:17:24.984222 [debug] [ThreadPool]: On list_BI_group4: Close
[0m10:17:24.991110 [debug] [ThreadPool]: Using postgres connection "list_BI_group4"
[0m10:17:24.992093 [debug] [ThreadPool]: On list_BI_group4: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "connection_name": "list_BI_group4"} */

    select distinct nspname from pg_namespace
  
[0m10:17:24.992854 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:17:25.157060 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.164 seconds
[0m10:17:25.162082 [debug] [ThreadPool]: On list_BI_group4: Close
[0m10:17:25.168709 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_BI_group4, now list_BI_group4__)
[0m10:17:25.185279 [debug] [ThreadPool]: Using postgres connection "list_BI_group4__"
[0m10:17:25.186069 [debug] [ThreadPool]: On list_BI_group4__: BEGIN
[0m10:17:25.186801 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:17:25.379217 [debug] [ThreadPool]: SQL status: BEGIN in 0.192 seconds
[0m10:17:25.380913 [debug] [ThreadPool]: Using postgres connection "list_BI_group4__"
[0m10:17:25.382554 [debug] [ThreadPool]: On list_BI_group4__: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "connection_name": "list_BI_group4__"} */
select
      'BI_group4' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike '_'
    union all
    select
      'BI_group4' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike '_'
    union all
    select
      'BI_group4' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike '_'
  
[0m10:17:25.400918 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.017 seconds
[0m10:17:25.406043 [debug] [ThreadPool]: On list_BI_group4__: ROLLBACK
[0m10:17:25.417698 [debug] [ThreadPool]: On list_BI_group4__: Close
[0m10:17:25.418999 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_BI_group4__, now list_BI_group4____staging)
[0m10:17:25.425578 [debug] [ThreadPool]: Using postgres connection "list_BI_group4____staging"
[0m10:17:25.426569 [debug] [ThreadPool]: On list_BI_group4____staging: BEGIN
[0m10:17:25.427471 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:17:25.588695 [debug] [ThreadPool]: SQL status: BEGIN in 0.161 seconds
[0m10:17:25.590333 [debug] [ThreadPool]: Using postgres connection "list_BI_group4____staging"
[0m10:17:25.591972 [debug] [ThreadPool]: On list_BI_group4____staging: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "connection_name": "list_BI_group4____staging"} */
select
      'BI_group4' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike '___staging'
    union all
    select
      'BI_group4' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike '___staging'
    union all
    select
      'BI_group4' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike '___staging'
  
[0m10:17:25.610605 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.017 seconds
[0m10:17:25.615863 [debug] [ThreadPool]: On list_BI_group4____staging: ROLLBACK
[0m10:17:25.627593 [debug] [ThreadPool]: On list_BI_group4____staging: Close
[0m10:17:25.645623 [debug] [MainThread]: Using postgres connection "master"
[0m10:17:25.646408 [debug] [MainThread]: On master: BEGIN
[0m10:17:25.647127 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:17:25.810180 [debug] [MainThread]: SQL status: BEGIN in 0.163 seconds
[0m10:17:25.811969 [debug] [MainThread]: Using postgres connection "master"
[0m10:17:25.874220 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:17:25.899577 [debug] [MainThread]: SQL status: SELECT 3 in 0.023 seconds
[0m10:17:25.905448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e468b667-7412-452b-b2c6-991cd6341119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e3a97bdbe0>]}
[0m10:17:25.906915 [debug] [MainThread]: On master: ROLLBACK
[0m10:17:25.918110 [debug] [MainThread]: Using postgres connection "master"
[0m10:17:25.919122 [debug] [MainThread]: On master: BEGIN
[0m10:17:25.940148 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m10:17:25.941877 [debug] [MainThread]: On master: COMMIT
[0m10:17:25.943431 [debug] [MainThread]: Using postgres connection "master"
[0m10:17:25.944904 [debug] [MainThread]: On master: COMMIT
[0m10:17:25.956197 [debug] [MainThread]: SQL status: COMMIT in 0.010 seconds
[0m10:17:25.957855 [debug] [MainThread]: On master: Close
[0m10:17:25.966048 [debug] [Thread-1 (]: Began running node model.dbt_project_25.customerclean
[0m10:17:25.968370 [info ] [Thread-1 (]: 1 of 10 START sql table model ___staging.customerclean ......................... [RUN]
[0m10:17:25.970445 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_BI_group4____staging, now model.dbt_project_25.customerclean)
[0m10:17:25.972532 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.customerclean
[0m10:17:25.988007 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.customerclean"
[0m10:17:25.989332 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.customerclean
[0m10:17:26.064484 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.customerclean"
[0m10:17:26.065923 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.customerclean"
[0m10:17:26.066814 [debug] [Thread-1 (]: On model.dbt_project_25.customerclean: BEGIN
[0m10:17:26.067617 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:17:26.281797 [debug] [Thread-1 (]: SQL status: BEGIN in 0.214 seconds
[0m10:17:26.283811 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.customerclean"
[0m10:17:26.285639 [debug] [Thread-1 (]: On model.dbt_project_25.customerclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.customerclean"} */

  
    

  create  table "BI_group4"."___staging"."customerclean__dbt_tmp"
  
  
    as
  
  (
    

select
    customerid, 
	storeid,
    territoryid,
from "BI_group4"."corentin"."customer"
  );
  
[0m10:17:26.297933 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "from"
LINE 18: from "BI_group4"."corentin"."customer"
         ^

[0m10:17:26.299604 [debug] [Thread-1 (]: On model.dbt_project_25.customerclean: ROLLBACK
[0m10:17:26.311596 [debug] [Thread-1 (]: On model.dbt_project_25.customerclean: Close
[0m10:17:26.321040 [debug] [Thread-1 (]: Database Error in model customerclean (models/staging/customerclean.sql)
  syntax error at or near "from"
  LINE 18: from "BI_group4"."corentin"."customer"
           ^
  compiled code at target/run/dbt_project_25/models/staging/customerclean.sql
[0m10:17:26.324466 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e468b667-7412-452b-b2c6-991cd6341119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e3a6b0ee40>]}
[0m10:17:26.326042 [error] [Thread-1 (]: 1 of 10 ERROR creating sql table model ___staging.customerclean ................ [[31mERROR[0m in 0.35s]
[0m10:17:26.327461 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.customerclean
[0m10:17:26.328417 [debug] [Thread-1 (]: Began running node model.dbt_project_25.dateclean
[0m10:17:26.330168 [debug] [Thread-4 (]: Marking all children of 'model.dbt_project_25.customerclean' to be skipped because of status 'error'.  Reason: Database Error in model customerclean (models/staging/customerclean.sql)
  syntax error at or near "from"
  LINE 18: from "BI_group4"."corentin"."customer"
           ^
  compiled code at target/run/dbt_project_25/models/staging/customerclean.sql.
[0m10:17:26.332118 [info ] [Thread-1 (]: 2 of 10 START sql table model ___staging.dateclean ............................. [RUN]
[0m10:17:26.336132 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_25.customerclean, now model.dbt_project_25.dateclean)
[0m10:17:26.338245 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.dateclean
[0m10:17:26.349103 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.dateclean"
[0m10:17:26.350694 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.dateclean
[0m10:17:26.362438 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.dateclean"
[0m10:17:26.363821 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.dateclean"
[0m10:17:26.364962 [debug] [Thread-1 (]: On model.dbt_project_25.dateclean: BEGIN
[0m10:17:26.365817 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:17:26.573573 [debug] [Thread-1 (]: SQL status: BEGIN in 0.207 seconds
[0m10:17:26.575595 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.dateclean"
[0m10:17:26.577431 [debug] [Thread-1 (]: On model.dbt_project_25.dateclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.dateclean"} */

  
    

  create  table "BI_group4"."___staging"."dateclean__dbt_tmp"
  
  
    as
  
  (
    

select
    date_day,
    day_of_week as number_day_week,
    day_of_week_name as day_name
    
from "BI_group4"."corentin"."date"
  );
  
[0m10:17:26.592843 [debug] [Thread-1 (]: SQL status: SELECT 731 in 0.014 seconds
[0m10:17:26.615171 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.dateclean"
[0m10:17:26.616091 [debug] [Thread-1 (]: On model.dbt_project_25.dateclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.dateclean"} */
alter table "BI_group4"."___staging"."dateclean" rename to "dateclean__dbt_backup"
[0m10:17:26.627059 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m10:17:26.634091 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.dateclean"
[0m10:17:26.635324 [debug] [Thread-1 (]: On model.dbt_project_25.dateclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.dateclean"} */
alter table "BI_group4"."___staging"."dateclean__dbt_tmp" rename to "dateclean"
[0m10:17:26.646897 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m10:17:26.679045 [debug] [Thread-1 (]: On model.dbt_project_25.dateclean: COMMIT
[0m10:17:26.679966 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.dateclean"
[0m10:17:26.680812 [debug] [Thread-1 (]: On model.dbt_project_25.dateclean: COMMIT
[0m10:17:26.694653 [debug] [Thread-1 (]: SQL status: COMMIT in 0.013 seconds
[0m10:17:26.710809 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."___staging"."dateclean__dbt_backup"
[0m10:17:26.721128 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.dateclean"
[0m10:17:26.722026 [debug] [Thread-1 (]: On model.dbt_project_25.dateclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.dateclean"} */
drop table if exists "BI_group4"."___staging"."dateclean__dbt_backup" cascade
[0m10:17:26.741154 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.018 seconds
[0m10:17:26.750167 [debug] [Thread-1 (]: On model.dbt_project_25.dateclean: Close
[0m10:17:26.751535 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e468b667-7412-452b-b2c6-991cd6341119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e3ac203ec0>]}
[0m10:17:26.752878 [info ] [Thread-1 (]: 2 of 10 OK created sql table model ___staging.dateclean ........................ [[32mSELECT 731[0m in 0.42s]
[0m10:17:26.754178 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.dateclean
[0m10:17:26.755125 [debug] [Thread-1 (]: Began running node model.dbt_project_25.my_first_dbt_model
[0m10:17:26.756394 [info ] [Thread-1 (]: 3 of 10 START sql table model _.my_first_dbt_model ............................. [RUN]
[0m10:17:26.757401 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_25.dateclean, now model.dbt_project_25.my_first_dbt_model)
[0m10:17:26.758288 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.my_first_dbt_model
[0m10:17:26.763285 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.my_first_dbt_model"
[0m10:17:26.764511 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.my_first_dbt_model
[0m10:17:26.771277 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.my_first_dbt_model"
[0m10:17:26.772576 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_first_dbt_model"
[0m10:17:26.773465 [debug] [Thread-1 (]: On model.dbt_project_25.my_first_dbt_model: BEGIN
[0m10:17:26.774284 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:17:26.946727 [debug] [Thread-1 (]: SQL status: BEGIN in 0.172 seconds
[0m10:17:26.948744 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_first_dbt_model"
[0m10:17:26.950591 [debug] [Thread-1 (]: On model.dbt_project_25.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.my_first_dbt_model"} */

  
    

  create  table "BI_group4"."_"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m10:17:26.963431 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.011 seconds
[0m10:17:26.973757 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_first_dbt_model"
[0m10:17:26.974657 [debug] [Thread-1 (]: On model.dbt_project_25.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.my_first_dbt_model"} */
alter table "BI_group4"."_"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m10:17:26.985238 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m10:17:26.990962 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_first_dbt_model"
[0m10:17:26.991854 [debug] [Thread-1 (]: On model.dbt_project_25.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.my_first_dbt_model"} */
alter table "BI_group4"."_"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m10:17:27.003079 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m10:17:27.010658 [debug] [Thread-1 (]: On model.dbt_project_25.my_first_dbt_model: COMMIT
[0m10:17:27.011868 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_first_dbt_model"
[0m10:17:27.012708 [debug] [Thread-1 (]: On model.dbt_project_25.my_first_dbt_model: COMMIT
[0m10:17:27.025369 [debug] [Thread-1 (]: SQL status: COMMIT in 0.012 seconds
[0m10:17:27.032303 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."_"."my_first_dbt_model__dbt_backup"
[0m10:17:27.034088 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_first_dbt_model"
[0m10:17:27.034970 [debug] [Thread-1 (]: On model.dbt_project_25.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.my_first_dbt_model"} */
drop table if exists "BI_group4"."_"."my_first_dbt_model__dbt_backup" cascade
[0m10:17:27.054432 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.018 seconds
[0m10:17:27.059748 [debug] [Thread-1 (]: On model.dbt_project_25.my_first_dbt_model: Close
[0m10:17:27.061750 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e468b667-7412-452b-b2c6-991cd6341119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e3a6bf4290>]}
[0m10:17:27.063137 [info ] [Thread-1 (]: 3 of 10 OK created sql table model _.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.30s]
[0m10:17:27.064526 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.my_first_dbt_model
[0m10:17:27.065492 [debug] [Thread-1 (]: Began running node model.dbt_project_25.salesorderdetailsclean
[0m10:17:27.067051 [info ] [Thread-1 (]: 4 of 10 START sql table model ___staging.salesorderdetailsclean ................ [RUN]
[0m10:17:27.068171 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_25.my_first_dbt_model, now model.dbt_project_25.salesorderdetailsclean)
[0m10:17:27.069118 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.salesorderdetailsclean
[0m10:17:27.155778 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.salesorderdetailsclean"
[0m10:17:27.157061 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.salesorderdetailsclean
[0m10:17:27.164055 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.salesorderdetailsclean"
[0m10:17:27.165258 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderdetailsclean"
[0m10:17:27.166127 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderdetailsclean: BEGIN
[0m10:17:27.166937 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:17:27.390077 [debug] [Thread-1 (]: SQL status: BEGIN in 0.223 seconds
[0m10:17:27.392014 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderdetailsclean"
[0m10:17:27.393840 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderdetailsclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.salesorderdetailsclean"} */

  
    

  create  table "BI_group4"."___staging"."salesorderdetailsclean__dbt_tmp"
  
  
    as
  
  (
    

select 
	salesorderid, 
	unitprice,
	orderqty as orderquantity,
	productid,
	unitpricediscount as discount

from "BI_group4"."corentin"."salesorderdetail"
  );
  
[0m10:17:27.420921 [debug] [Thread-1 (]: SQL status: SELECT 5716 in 0.025 seconds
[0m10:17:27.433534 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderdetailsclean"
[0m10:17:27.434430 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderdetailsclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.salesorderdetailsclean"} */
alter table "BI_group4"."___staging"."salesorderdetailsclean" rename to "salesorderdetailsclean__dbt_backup"
[0m10:17:27.448388 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.013 seconds
[0m10:17:27.457794 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderdetailsclean"
[0m10:17:27.458957 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderdetailsclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.salesorderdetailsclean"} */
alter table "BI_group4"."___staging"."salesorderdetailsclean__dbt_tmp" rename to "salesorderdetailsclean"
[0m10:17:27.470059 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m10:17:27.473523 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderdetailsclean: COMMIT
[0m10:17:27.474413 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderdetailsclean"
[0m10:17:27.475268 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderdetailsclean: COMMIT
[0m10:17:27.492527 [debug] [Thread-1 (]: SQL status: COMMIT in 0.016 seconds
[0m10:17:27.501951 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."___staging"."salesorderdetailsclean__dbt_backup"
[0m10:17:27.504925 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderdetailsclean"
[0m10:17:27.505821 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderdetailsclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.salesorderdetailsclean"} */
drop table if exists "BI_group4"."___staging"."salesorderdetailsclean__dbt_backup" cascade
[0m10:17:27.523215 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.016 seconds
[0m10:17:27.528858 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderdetailsclean: Close
[0m10:17:27.531334 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e468b667-7412-452b-b2c6-991cd6341119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e3a520da60>]}
[0m10:17:27.534001 [info ] [Thread-1 (]: 4 of 10 OK created sql table model ___staging.salesorderdetailsclean ........... [[32mSELECT 5716[0m in 0.46s]
[0m10:17:27.535728 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.salesorderdetailsclean
[0m10:17:27.536676 [debug] [Thread-1 (]: Began running node model.dbt_project_25.salesorderheaderclean
[0m10:17:27.537894 [info ] [Thread-1 (]: 5 of 10 START sql table model ___staging.salesorderheaderclean ................. [RUN]
[0m10:17:27.538903 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_25.salesorderdetailsclean, now model.dbt_project_25.salesorderheaderclean)
[0m10:17:27.539807 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.salesorderheaderclean
[0m10:17:27.545383 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.salesorderheaderclean"
[0m10:17:27.546630 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.salesorderheaderclean
[0m10:17:27.553486 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.salesorderheaderclean"
[0m10:17:27.554772 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderheaderclean"
[0m10:17:27.555653 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderheaderclean: BEGIN
[0m10:17:27.556474 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:17:27.719186 [debug] [Thread-1 (]: SQL status: BEGIN in 0.162 seconds
[0m10:17:27.721200 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderheaderclean"
[0m10:17:27.723071 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderheaderclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.salesorderheaderclean"} */

  
    

  create  table "BI_group4"."___staging"."salesorderheaderclean__dbt_tmp"
  
  
    as
  
  (
    

select
    orderdate,
    salesorderid,
    territoryid,
    salespersonid as salerid,
    billtoaddressid,
    customerid,
    salespersonid,
    shipdate
from "BI_group4"."corentin"."salesorderheader"
  );
  
[0m10:17:27.743154 [debug] [Thread-1 (]: SQL status: SELECT 1566 in 0.018 seconds
[0m10:17:27.755929 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderheaderclean"
[0m10:17:27.756838 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderheaderclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.salesorderheaderclean"} */
alter table "BI_group4"."___staging"."salesorderheaderclean" rename to "salesorderheaderclean__dbt_backup"
[0m10:17:27.768781 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.011 seconds
[0m10:17:27.777936 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderheaderclean"
[0m10:17:27.778896 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderheaderclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.salesorderheaderclean"} */
alter table "BI_group4"."___staging"."salesorderheaderclean__dbt_tmp" rename to "salesorderheaderclean"
[0m10:17:27.790296 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m10:17:27.795060 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderheaderclean: COMMIT
[0m10:17:27.796255 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderheaderclean"
[0m10:17:27.797098 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderheaderclean: COMMIT
[0m10:17:27.812493 [debug] [Thread-1 (]: SQL status: COMMIT in 0.014 seconds
[0m10:17:27.825188 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."___staging"."salesorderheaderclean__dbt_backup"
[0m10:17:27.827342 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderheaderclean"
[0m10:17:27.828239 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderheaderclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.salesorderheaderclean"} */
drop table if exists "BI_group4"."___staging"."salesorderheaderclean__dbt_backup" cascade
[0m10:17:27.844422 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.015 seconds
[0m10:17:27.849267 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderheaderclean: Close
[0m10:17:27.851761 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e468b667-7412-452b-b2c6-991cd6341119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e3a6b44560>]}
[0m10:17:27.854412 [info ] [Thread-1 (]: 5 of 10 OK created sql table model ___staging.salesorderheaderclean ............ [[32mSELECT 1566[0m in 0.31s]
[0m10:17:27.856529 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.salesorderheaderclean
[0m10:17:27.857453 [debug] [Thread-1 (]: Began running node model.dbt_project_25.stg_product
[0m10:17:27.858670 [info ] [Thread-1 (]: 6 of 10 START sql table model ___staging.stg_product ........................... [RUN]
[0m10:17:27.859682 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_25.salesorderheaderclean, now model.dbt_project_25.stg_product)
[0m10:17:27.860588 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.stg_product
[0m10:17:27.866107 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.stg_product"
[0m10:17:27.867327 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.stg_product
[0m10:17:27.874243 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.stg_product"
[0m10:17:27.875528 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_product"
[0m10:17:27.876403 [debug] [Thread-1 (]: On model.dbt_project_25.stg_product: BEGIN
[0m10:17:27.877235 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:17:28.042775 [debug] [Thread-1 (]: SQL status: BEGIN in 0.165 seconds
[0m10:17:28.044783 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_product"
[0m10:17:28.046669 [debug] [Thread-1 (]: On model.dbt_project_25.stg_product: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_product"} */

  
    

  create  table "BI_group4"."___staging"."stg_product__dbt_tmp"
  
  
    as
  
  (
    

SELECT
  productid, 
  name AS itemname
FROM "BI_group4"."corentin"."product"

--run in terminal/shell: 
--dbt run --select stg_product

--(This will build the model as a new view/table in your dev schema, leaving the original data untouched)
  );
  
[0m10:17:28.060811 [debug] [Thread-1 (]: SQL status: SELECT 504 in 0.012 seconds
[0m10:17:28.071522 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_product"
[0m10:17:28.072471 [debug] [Thread-1 (]: On model.dbt_project_25.stg_product: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_product"} */
alter table "BI_group4"."___staging"."stg_product" rename to "stg_product__dbt_backup"
[0m10:17:28.083344 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m10:17:28.089452 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_product"
[0m10:17:28.090352 [debug] [Thread-1 (]: On model.dbt_project_25.stg_product: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_product"} */
alter table "BI_group4"."___staging"."stg_product__dbt_tmp" rename to "stg_product"
[0m10:17:28.101403 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m10:17:28.107198 [debug] [Thread-1 (]: On model.dbt_project_25.stg_product: COMMIT
[0m10:17:28.108511 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_product"
[0m10:17:28.109341 [debug] [Thread-1 (]: On model.dbt_project_25.stg_product: COMMIT
[0m10:17:28.124001 [debug] [Thread-1 (]: SQL status: COMMIT in 0.014 seconds
[0m10:17:28.132414 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."___staging"."stg_product__dbt_backup"
[0m10:17:28.135378 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_product"
[0m10:17:28.136862 [debug] [Thread-1 (]: On model.dbt_project_25.stg_product: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_product"} */
drop table if exists "BI_group4"."___staging"."stg_product__dbt_backup" cascade
[0m10:17:28.152472 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.014 seconds
[0m10:17:28.157756 [debug] [Thread-1 (]: On model.dbt_project_25.stg_product: Close
[0m10:17:28.159616 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e468b667-7412-452b-b2c6-991cd6341119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e3a775a7e0>]}
[0m10:17:28.161298 [info ] [Thread-1 (]: 6 of 10 OK created sql table model ___staging.stg_product ...................... [[32mSELECT 504[0m in 0.30s]
[0m10:17:28.162959 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.stg_product
[0m10:17:28.164173 [debug] [Thread-1 (]: Began running node model.dbt_project_25.stg_productcat
[0m10:17:28.165707 [info ] [Thread-1 (]: 7 of 10 START sql table model ___staging.stg_productcat ........................ [RUN]
[0m10:17:28.166996 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_25.stg_product, now model.dbt_project_25.stg_productcat)
[0m10:17:28.168150 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.stg_productcat
[0m10:17:28.173927 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.stg_productcat"
[0m10:17:28.175146 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.stg_productcat
[0m10:17:28.182326 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.stg_productcat"
[0m10:17:28.183631 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_productcat"
[0m10:17:28.184526 [debug] [Thread-1 (]: On model.dbt_project_25.stg_productcat: BEGIN
[0m10:17:28.185347 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:17:28.394685 [debug] [Thread-1 (]: SQL status: BEGIN in 0.209 seconds
[0m10:17:28.396667 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_productcat"
[0m10:17:28.398553 [debug] [Thread-1 (]: On model.dbt_project_25.stg_productcat: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_productcat"} */

  
    

  create  table "BI_group4"."___staging"."stg_productcat__dbt_tmp"
  
  
    as
  
  (
    

SELECT
  productcategoryid, 
  name AS itemcategoryname
FROM "BI_group4"."corentin"."productcategory"

--run in terminal/shell: 
--dbt run --select stg_productcat

--(This will build the model as a new view/table in your dev schema, leaving the original data untouched)
  );
  
[0m10:17:28.413666 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.013 seconds
[0m10:17:28.423967 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_productcat"
[0m10:17:28.425041 [debug] [Thread-1 (]: On model.dbt_project_25.stg_productcat: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_productcat"} */
alter table "BI_group4"."___staging"."stg_productcat" rename to "stg_productcat__dbt_backup"
[0m10:17:28.436454 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m10:17:28.442143 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_productcat"
[0m10:17:28.443038 [debug] [Thread-1 (]: On model.dbt_project_25.stg_productcat: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_productcat"} */
alter table "BI_group4"."___staging"."stg_productcat__dbt_tmp" rename to "stg_productcat"
[0m10:17:28.454111 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m10:17:28.459330 [debug] [Thread-1 (]: On model.dbt_project_25.stg_productcat: COMMIT
[0m10:17:28.460350 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_productcat"
[0m10:17:28.461191 [debug] [Thread-1 (]: On model.dbt_project_25.stg_productcat: COMMIT
[0m10:17:28.473071 [debug] [Thread-1 (]: SQL status: COMMIT in 0.011 seconds
[0m10:17:28.481002 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."___staging"."stg_productcat__dbt_backup"
[0m10:17:28.482755 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_productcat"
[0m10:17:28.483637 [debug] [Thread-1 (]: On model.dbt_project_25.stg_productcat: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_productcat"} */
drop table if exists "BI_group4"."___staging"."stg_productcat__dbt_backup" cascade
[0m10:17:28.502902 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.018 seconds
[0m10:17:28.508155 [debug] [Thread-1 (]: On model.dbt_project_25.stg_productcat: Close
[0m10:17:28.510578 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e468b667-7412-452b-b2c6-991cd6341119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e3a6bf71d0>]}
[0m10:17:28.511981 [info ] [Thread-1 (]: 7 of 10 OK created sql table model ___staging.stg_productcat ................... [[32mSELECT 4[0m in 0.34s]
[0m10:17:28.513329 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.stg_productcat
[0m10:17:28.514310 [debug] [Thread-1 (]: Began running node model.dbt_project_25.stg_stateprovince
[0m10:17:28.515601 [info ] [Thread-1 (]: 8 of 10 START sql table model ___staging.stg_stateprovince ..................... [RUN]
[0m10:17:28.516653 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_25.stg_productcat, now model.dbt_project_25.stg_stateprovince)
[0m10:17:28.517582 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.stg_stateprovince
[0m10:17:28.523362 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.stg_stateprovince"
[0m10:17:28.524609 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.stg_stateprovince
[0m10:17:28.531726 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.stg_stateprovince"
[0m10:17:28.533013 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_stateprovince"
[0m10:17:28.533930 [debug] [Thread-1 (]: On model.dbt_project_25.stg_stateprovince: BEGIN
[0m10:17:28.534773 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:17:28.698465 [debug] [Thread-1 (]: SQL status: BEGIN in 0.163 seconds
[0m10:17:28.700490 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_stateprovince"
[0m10:17:28.702401 [debug] [Thread-1 (]: On model.dbt_project_25.stg_stateprovince: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_stateprovince"} */

  
    

  create  table "BI_group4"."___staging"."stg_stateprovince__dbt_tmp"
  
  
    as
  
  (
    

SELECT
  stateprovinceid, 
  countryregioncode,
  territoryid,
  name AS regionname,
  stateprovincecode
FROM "BI_group4"."corentin"."stateprovince"

--run in terminal/shell: 
--dbt run --select stg_stateprovince

--(This will build the model as a new view/table in your dev schema, leaving the original data untouched)
  );
  
[0m10:17:28.717397 [debug] [Thread-1 (]: SQL status: SELECT 181 in 0.013 seconds
[0m10:17:28.728836 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_stateprovince"
[0m10:17:28.730330 [debug] [Thread-1 (]: On model.dbt_project_25.stg_stateprovince: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_stateprovince"} */
alter table "BI_group4"."___staging"."stg_stateprovince" rename to "stg_stateprovince__dbt_backup"
[0m10:17:28.742269 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m10:17:28.752811 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_stateprovince"
[0m10:17:28.753716 [debug] [Thread-1 (]: On model.dbt_project_25.stg_stateprovince: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_stateprovince"} */
alter table "BI_group4"."___staging"."stg_stateprovince__dbt_tmp" rename to "stg_stateprovince"
[0m10:17:28.764898 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m10:17:28.770648 [debug] [Thread-1 (]: On model.dbt_project_25.stg_stateprovince: COMMIT
[0m10:17:28.771920 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_stateprovince"
[0m10:17:28.772767 [debug] [Thread-1 (]: On model.dbt_project_25.stg_stateprovince: COMMIT
[0m10:17:28.785926 [debug] [Thread-1 (]: SQL status: COMMIT in 0.012 seconds
[0m10:17:28.793937 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."___staging"."stg_stateprovince__dbt_backup"
[0m10:17:28.796102 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_stateprovince"
[0m10:17:28.797194 [debug] [Thread-1 (]: On model.dbt_project_25.stg_stateprovince: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_stateprovince"} */
drop table if exists "BI_group4"."___staging"."stg_stateprovince__dbt_backup" cascade
[0m10:17:28.814937 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.016 seconds
[0m10:17:28.820200 [debug] [Thread-1 (]: On model.dbt_project_25.stg_stateprovince: Close
[0m10:17:28.822669 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e468b667-7412-452b-b2c6-991cd6341119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e3a6bf5640>]}
[0m10:17:28.824051 [info ] [Thread-1 (]: 8 of 10 OK created sql table model ___staging.stg_stateprovince ................ [[32mSELECT 181[0m in 0.31s]
[0m10:17:28.825413 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.stg_stateprovince
[0m10:17:28.826399 [debug] [Thread-1 (]: Began running node model.dbt_project_25.storeclean
[0m10:17:28.827698 [info ] [Thread-1 (]: 9 of 10 START sql table model ___staging.storeclean ............................ [RUN]
[0m10:17:28.828764 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_25.stg_stateprovince, now model.dbt_project_25.storeclean)
[0m10:17:28.829709 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.storeclean
[0m10:17:28.835353 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.storeclean"
[0m10:17:28.836592 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.storeclean
[0m10:17:28.843687 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.storeclean"
[0m10:17:28.844954 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.storeclean"
[0m10:17:28.845862 [debug] [Thread-1 (]: On model.dbt_project_25.storeclean: BEGIN
[0m10:17:28.846681 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:17:29.022715 [debug] [Thread-1 (]: SQL status: BEGIN in 0.176 seconds
[0m10:17:29.024730 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.storeclean"
[0m10:17:29.026574 [debug] [Thread-1 (]: On model.dbt_project_25.storeclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.storeclean"} */

  
    

  create  table "BI_group4"."___staging"."storeclean__dbt_tmp"
  
  
    as
  
  (
    

select
    salespersonid as salerid,
    storename,
    businessentityid
from "BI_group4"."corentin"."store1"
  );
  
[0m10:17:29.040072 [debug] [Thread-1 (]: SQL status: SELECT 701 in 0.012 seconds
[0m10:17:29.048672 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.storeclean"
[0m10:17:29.049842 [debug] [Thread-1 (]: On model.dbt_project_25.storeclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.storeclean"} */
alter table "BI_group4"."___staging"."storeclean" rename to "storeclean__dbt_backup"
[0m10:17:29.060871 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m10:17:29.066714 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.storeclean"
[0m10:17:29.067623 [debug] [Thread-1 (]: On model.dbt_project_25.storeclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.storeclean"} */
alter table "BI_group4"."___staging"."storeclean__dbt_tmp" rename to "storeclean"
[0m10:17:29.078016 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.009 seconds
[0m10:17:29.082537 [debug] [Thread-1 (]: On model.dbt_project_25.storeclean: COMMIT
[0m10:17:29.083655 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.storeclean"
[0m10:17:29.084494 [debug] [Thread-1 (]: On model.dbt_project_25.storeclean: COMMIT
[0m10:17:29.099450 [debug] [Thread-1 (]: SQL status: COMMIT in 0.014 seconds
[0m10:17:29.111087 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."___staging"."storeclean__dbt_backup"
[0m10:17:29.113944 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.storeclean"
[0m10:17:29.114853 [debug] [Thread-1 (]: On model.dbt_project_25.storeclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.storeclean"} */
drop table if exists "BI_group4"."___staging"."storeclean__dbt_backup" cascade
[0m10:17:29.130534 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.015 seconds
[0m10:17:29.135701 [debug] [Thread-1 (]: On model.dbt_project_25.storeclean: Close
[0m10:17:29.137932 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e468b667-7412-452b-b2c6-991cd6341119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e3a8320770>]}
[0m10:17:29.140279 [info ] [Thread-1 (]: 9 of 10 OK created sql table model ___staging.storeclean ....................... [[32mSELECT 701[0m in 0.31s]
[0m10:17:29.142648 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.storeclean
[0m10:17:29.144340 [debug] [Thread-1 (]: Began running node model.dbt_project_25.my_second_dbt_model
[0m10:17:29.145614 [info ] [Thread-1 (]: 10 of 10 START sql view model _.my_second_dbt_model ............................ [RUN]
[0m10:17:29.146648 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_25.storeclean, now model.dbt_project_25.my_second_dbt_model)
[0m10:17:29.147543 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.my_second_dbt_model
[0m10:17:29.152689 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.my_second_dbt_model"
[0m10:17:29.153987 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.my_second_dbt_model
[0m10:17:29.188236 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.my_second_dbt_model"
[0m10:17:29.189608 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_second_dbt_model"
[0m10:17:29.190482 [debug] [Thread-1 (]: On model.dbt_project_25.my_second_dbt_model: BEGIN
[0m10:17:29.191302 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:17:29.413074 [debug] [Thread-1 (]: SQL status: BEGIN in 0.221 seconds
[0m10:17:29.415066 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_second_dbt_model"
[0m10:17:29.416913 [debug] [Thread-1 (]: On model.dbt_project_25.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.my_second_dbt_model"} */

  create view "BI_group4"."_"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "BI_group4"."_"."my_first_dbt_model"
where id = 1
  );
[0m10:17:29.432361 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m10:17:29.443459 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_second_dbt_model"
[0m10:17:29.445124 [debug] [Thread-1 (]: On model.dbt_project_25.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.my_second_dbt_model"} */
alter table "BI_group4"."_"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m10:17:29.456901 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m10:17:29.463172 [debug] [Thread-1 (]: On model.dbt_project_25.my_second_dbt_model: COMMIT
[0m10:17:29.465032 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_second_dbt_model"
[0m10:17:29.466588 [debug] [Thread-1 (]: On model.dbt_project_25.my_second_dbt_model: COMMIT
[0m10:17:29.480300 [debug] [Thread-1 (]: SQL status: COMMIT in 0.013 seconds
[0m10:17:29.488095 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."_"."my_second_dbt_model__dbt_backup"
[0m10:17:29.495699 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_second_dbt_model"
[0m10:17:29.496681 [debug] [Thread-1 (]: On model.dbt_project_25.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.my_second_dbt_model"} */
drop view if exists "BI_group4"."_"."my_second_dbt_model__dbt_backup" cascade
[0m10:17:29.508186 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.010 seconds
[0m10:17:29.513600 [debug] [Thread-1 (]: On model.dbt_project_25.my_second_dbt_model: Close
[0m10:17:29.516144 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e468b667-7412-452b-b2c6-991cd6341119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e3a9a107a0>]}
[0m10:17:29.518004 [info ] [Thread-1 (]: 10 of 10 OK created sql view model _.my_second_dbt_model ....................... [[32mCREATE VIEW[0m in 0.37s]
[0m10:17:29.519290 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.my_second_dbt_model
[0m10:17:29.522853 [debug] [MainThread]: Using postgres connection "master"
[0m10:17:29.524582 [debug] [MainThread]: On master: BEGIN
[0m10:17:29.526240 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:17:29.694732 [debug] [MainThread]: SQL status: BEGIN in 0.168 seconds
[0m10:17:29.696568 [debug] [MainThread]: On master: COMMIT
[0m10:17:29.698186 [debug] [MainThread]: Using postgres connection "master"
[0m10:17:29.699755 [debug] [MainThread]: On master: COMMIT
[0m10:17:29.711861 [debug] [MainThread]: SQL status: COMMIT in 0.011 seconds
[0m10:17:29.713338 [debug] [MainThread]: On master: Close
[0m10:17:29.715067 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:17:29.716325 [debug] [MainThread]: Connection 'model.dbt_project_25.my_second_dbt_model' was properly closed.
[0m10:17:29.717801 [info ] [MainThread]: 
[0m10:17:29.718853 [info ] [MainThread]: Finished running 9 table models, 1 view model in 0 hours 0 minutes and 4.99 seconds (4.99s).
[0m10:17:29.722455 [debug] [MainThread]: Command end result
[0m10:17:29.770550 [debug] [MainThread]: Wrote artifact WritableManifest to /home/corentin.vanlandeghe@Digital-Grenoble.local/BI_DBT/target/manifest.json
[0m10:17:29.773683 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/corentin.vanlandeghe@Digital-Grenoble.local/BI_DBT/target/semantic_manifest.json
[0m10:17:29.784709 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/corentin.vanlandeghe@Digital-Grenoble.local/BI_DBT/target/run_results.json
[0m10:17:29.785471 [info ] [MainThread]: 
[0m10:17:29.786306 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:17:29.787095 [info ] [MainThread]: 
[0m10:17:29.788005 [error] [MainThread]: [31mFailure in model customerclean (models/staging/customerclean.sql)[0m
[0m10:17:29.788908 [error] [MainThread]:   Database Error in model customerclean (models/staging/customerclean.sql)
  syntax error at or near "from"
  LINE 18: from "BI_group4"."corentin"."customer"
           ^
  compiled code at target/run/dbt_project_25/models/staging/customerclean.sql
[0m10:17:29.789660 [info ] [MainThread]: 
[0m10:17:29.790518 [info ] [MainThread]:   compiled code at target/compiled/dbt_project_25/models/staging/customerclean.sql
[0m10:17:29.791267 [info ] [MainThread]: 
[0m10:17:29.792079 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=10
[0m10:17:29.793833 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.4272084, "process_in_blocks": "0", "process_kernel_time": 0.488973, "process_mem_max_rss": "125212", "process_out_blocks": "3840", "process_user_time": 5.274711}
[0m10:17:29.794853 [debug] [MainThread]: Command `dbt run` failed at 10:17:29.794660 after 6.43 seconds
[0m10:17:29.795699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e3aa9f1fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e3aaa2cb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e3a8f72150>]}
[0m10:17:29.796586 [debug] [MainThread]: Flushing usage events
[0m10:17:30.243898 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:20:01.523846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b61184b380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b6150969c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b61176d580>]}


============================== 10:20:01.529674 | 231a72a6-c2b1-4781-936a-bce242ebc9a4 ==============================
[0m10:20:01.529674 [info ] [MainThread]: Running with dbt=1.10.2
[0m10:20:01.530859 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/corentin.vanlandeghe@Digital-Grenoble.local/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/corentin.vanlandeghe@Digital-Grenoble.local/BI_DBT/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:20:01.852394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '231a72a6-c2b1-4781-936a-bce242ebc9a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b613928a70>]}
[0m10:20:01.978034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '231a72a6-c2b1-4781-936a-bce242ebc9a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b6120ffef0>]}
[0m10:20:01.979477 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:20:02.160141 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m10:20:02.389509 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:20:02.390731 [debug] [MainThread]: Partial parsing: updated file: dbt_project_25://models/staging/customerclean.sql
[0m10:20:02.913592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '231a72a6-c2b1-4781-936a-bce242ebc9a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b60f386cc0>]}
[0m10:20:03.071223 [debug] [MainThread]: Wrote artifact WritableManifest to /home/corentin.vanlandeghe@Digital-Grenoble.local/BI_DBT/target/manifest.json
[0m10:20:03.074290 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/corentin.vanlandeghe@Digital-Grenoble.local/BI_DBT/target/semantic_manifest.json
[0m10:20:03.097601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '231a72a6-c2b1-4781-936a-bce242ebc9a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b60f333c50>]}
[0m10:20:03.098594 [info ] [MainThread]: Found 10 models, 4 data tests, 8 sources, 549 macros
[0m10:20:03.099397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '231a72a6-c2b1-4781-936a-bce242ebc9a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b60ffdc3b0>]}
[0m10:20:03.103452 [info ] [MainThread]: 
[0m10:20:03.104285 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:20:03.105018 [info ] [MainThread]: 
[0m10:20:03.106050 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:20:03.114627 [debug] [ThreadPool]: Acquiring new postgres connection 'list_BI_group4'
[0m10:20:03.185933 [debug] [ThreadPool]: Using postgres connection "list_BI_group4"
[0m10:20:03.186847 [debug] [ThreadPool]: On list_BI_group4: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "connection_name": "list_BI_group4"} */

    select distinct nspname from pg_namespace
  
[0m10:20:03.187608 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:20:03.363960 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.176 seconds
[0m10:20:03.369474 [debug] [ThreadPool]: On list_BI_group4: Close
[0m10:20:03.375666 [debug] [ThreadPool]: Using postgres connection "list_BI_group4"
[0m10:20:03.376800 [debug] [ThreadPool]: On list_BI_group4: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "connection_name": "list_BI_group4"} */

    select distinct nspname from pg_namespace
  
[0m10:20:03.377706 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:20:03.536917 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.159 seconds
[0m10:20:03.541841 [debug] [ThreadPool]: On list_BI_group4: Close
[0m10:20:03.547862 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_BI_group4, now list_BI_group4__)
[0m10:20:03.560274 [debug] [ThreadPool]: Using postgres connection "list_BI_group4__"
[0m10:20:03.561069 [debug] [ThreadPool]: On list_BI_group4__: BEGIN
[0m10:20:03.561788 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:20:03.718929 [debug] [ThreadPool]: SQL status: BEGIN in 0.157 seconds
[0m10:20:03.720470 [debug] [ThreadPool]: Using postgres connection "list_BI_group4__"
[0m10:20:03.721944 [debug] [ThreadPool]: On list_BI_group4__: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "connection_name": "list_BI_group4__"} */
select
      'BI_group4' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike '_'
    union all
    select
      'BI_group4' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike '_'
    union all
    select
      'BI_group4' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike '_'
  
[0m10:20:03.736057 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.013 seconds
[0m10:20:03.741149 [debug] [ThreadPool]: On list_BI_group4__: ROLLBACK
[0m10:20:03.752693 [debug] [ThreadPool]: On list_BI_group4__: Close
[0m10:20:03.755222 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_BI_group4__, now list_BI_group4____staging)
[0m10:20:03.763912 [debug] [ThreadPool]: Using postgres connection "list_BI_group4____staging"
[0m10:20:03.764722 [debug] [ThreadPool]: On list_BI_group4____staging: BEGIN
[0m10:20:03.765428 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:20:03.922672 [debug] [ThreadPool]: SQL status: BEGIN in 0.157 seconds
[0m10:20:03.924330 [debug] [ThreadPool]: Using postgres connection "list_BI_group4____staging"
[0m10:20:03.925995 [debug] [ThreadPool]: On list_BI_group4____staging: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "connection_name": "list_BI_group4____staging"} */
select
      'BI_group4' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike '___staging'
    union all
    select
      'BI_group4' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike '___staging'
    union all
    select
      'BI_group4' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike '___staging'
  
[0m10:20:03.940088 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.012 seconds
[0m10:20:03.943974 [debug] [ThreadPool]: On list_BI_group4____staging: ROLLBACK
[0m10:20:03.954735 [debug] [ThreadPool]: On list_BI_group4____staging: Close
[0m10:20:03.971430 [debug] [MainThread]: Using postgres connection "master"
[0m10:20:03.972365 [debug] [MainThread]: On master: BEGIN
[0m10:20:03.973215 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:20:04.120338 [debug] [MainThread]: SQL status: BEGIN in 0.147 seconds
[0m10:20:04.122102 [debug] [MainThread]: Using postgres connection "master"
[0m10:20:04.124007 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:20:04.147320 [debug] [MainThread]: SQL status: SELECT 3 in 0.022 seconds
[0m10:20:04.153251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '231a72a6-c2b1-4781-936a-bce242ebc9a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b60f3a37d0>]}
[0m10:20:04.155082 [debug] [MainThread]: On master: ROLLBACK
[0m10:20:04.165923 [debug] [MainThread]: Using postgres connection "master"
[0m10:20:04.167590 [debug] [MainThread]: On master: BEGIN
[0m10:20:04.190004 [debug] [MainThread]: SQL status: BEGIN in 0.021 seconds
[0m10:20:04.191654 [debug] [MainThread]: On master: COMMIT
[0m10:20:04.193199 [debug] [MainThread]: Using postgres connection "master"
[0m10:20:04.194710 [debug] [MainThread]: On master: COMMIT
[0m10:20:04.206151 [debug] [MainThread]: SQL status: COMMIT in 0.010 seconds
[0m10:20:04.207831 [debug] [MainThread]: On master: Close
[0m10:20:04.216359 [debug] [Thread-1 (]: Began running node model.dbt_project_25.customerclean
[0m10:20:04.218728 [info ] [Thread-1 (]: 1 of 10 START sql table model ___staging.customerclean ......................... [RUN]
[0m10:20:04.220805 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_BI_group4____staging, now model.dbt_project_25.customerclean)
[0m10:20:04.222598 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.customerclean
[0m10:20:04.238233 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.customerclean"
[0m10:20:04.239553 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.customerclean
[0m10:20:04.309565 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.customerclean"
[0m10:20:04.310940 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.customerclean"
[0m10:20:04.311818 [debug] [Thread-1 (]: On model.dbt_project_25.customerclean: BEGIN
[0m10:20:04.312609 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:20:04.470605 [debug] [Thread-1 (]: SQL status: BEGIN in 0.158 seconds
[0m10:20:04.472470 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.customerclean"
[0m10:20:04.474265 [debug] [Thread-1 (]: On model.dbt_project_25.customerclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.customerclean"} */

  
    

  create  table "BI_group4"."___staging"."customerclean__dbt_tmp"
  
  
    as
  
  (
    

select
    customerid, 
	storeid,
    territoryid
from "BI_group4"."corentin"."customer"
  );
  
[0m10:20:04.503161 [debug] [Thread-1 (]: SQL status: SELECT 19820 in 0.027 seconds
[0m10:20:04.527929 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.customerclean"
[0m10:20:04.528825 [debug] [Thread-1 (]: On model.dbt_project_25.customerclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.customerclean"} */
alter table "BI_group4"."___staging"."customerclean__dbt_tmp" rename to "customerclean"
[0m10:20:04.539834 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m10:20:04.569819 [debug] [Thread-1 (]: On model.dbt_project_25.customerclean: COMMIT
[0m10:20:04.570731 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.customerclean"
[0m10:20:04.571555 [debug] [Thread-1 (]: On model.dbt_project_25.customerclean: COMMIT
[0m10:20:04.589016 [debug] [Thread-1 (]: SQL status: COMMIT in 0.016 seconds
[0m10:20:04.605922 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."___staging"."customerclean__dbt_backup"
[0m10:20:04.695783 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.customerclean"
[0m10:20:04.696766 [debug] [Thread-1 (]: On model.dbt_project_25.customerclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.customerclean"} */
drop table if exists "BI_group4"."___staging"."customerclean__dbt_backup" cascade
[0m10:20:04.707963 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.010 seconds
[0m10:20:04.716109 [debug] [Thread-1 (]: On model.dbt_project_25.customerclean: Close
[0m10:20:04.720743 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '231a72a6-c2b1-4781-936a-bce242ebc9a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b60f7736e0>]}
[0m10:20:04.722057 [info ] [Thread-1 (]: 1 of 10 OK created sql table model ___staging.customerclean .................... [[32mSELECT 19820[0m in 0.50s]
[0m10:20:04.723335 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.customerclean
[0m10:20:04.724244 [debug] [Thread-1 (]: Began running node model.dbt_project_25.dateclean
[0m10:20:04.725453 [info ] [Thread-1 (]: 2 of 10 START sql table model ___staging.dateclean ............................. [RUN]
[0m10:20:04.726439 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_25.customerclean, now model.dbt_project_25.dateclean)
[0m10:20:04.727314 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.dateclean
[0m10:20:04.732781 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.dateclean"
[0m10:20:04.733960 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.dateclean
[0m10:20:04.740905 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.dateclean"
[0m10:20:04.742151 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.dateclean"
[0m10:20:04.743008 [debug] [Thread-1 (]: On model.dbt_project_25.dateclean: BEGIN
[0m10:20:04.743837 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:20:04.896638 [debug] [Thread-1 (]: SQL status: BEGIN in 0.152 seconds
[0m10:20:04.898648 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.dateclean"
[0m10:20:04.900442 [debug] [Thread-1 (]: On model.dbt_project_25.dateclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.dateclean"} */

  
    

  create  table "BI_group4"."___staging"."dateclean__dbt_tmp"
  
  
    as
  
  (
    

select
    date_day,
    day_of_week as number_day_week,
    day_of_week_name as day_name
    
from "BI_group4"."corentin"."date"
  );
  
[0m10:20:04.915431 [debug] [Thread-1 (]: SQL status: SELECT 731 in 0.013 seconds
[0m10:20:04.927301 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.dateclean"
[0m10:20:04.928774 [debug] [Thread-1 (]: On model.dbt_project_25.dateclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.dateclean"} */
alter table "BI_group4"."___staging"."dateclean" rename to "dateclean__dbt_backup"
[0m10:20:04.940237 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m10:20:04.948007 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.dateclean"
[0m10:20:04.949220 [debug] [Thread-1 (]: On model.dbt_project_25.dateclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.dateclean"} */
alter table "BI_group4"."___staging"."dateclean__dbt_tmp" rename to "dateclean"
[0m10:20:04.960277 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m10:20:04.972520 [debug] [Thread-1 (]: On model.dbt_project_25.dateclean: COMMIT
[0m10:20:04.973410 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.dateclean"
[0m10:20:04.974251 [debug] [Thread-1 (]: On model.dbt_project_25.dateclean: COMMIT
[0m10:20:04.988091 [debug] [Thread-1 (]: SQL status: COMMIT in 0.013 seconds
[0m10:20:04.993508 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."___staging"."dateclean__dbt_backup"
[0m10:20:04.995786 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.dateclean"
[0m10:20:04.996907 [debug] [Thread-1 (]: On model.dbt_project_25.dateclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.dateclean"} */
drop table if exists "BI_group4"."___staging"."dateclean__dbt_backup" cascade
[0m10:20:05.018330 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.020 seconds
[0m10:20:05.023694 [debug] [Thread-1 (]: On model.dbt_project_25.dateclean: Close
[0m10:20:05.026231 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '231a72a6-c2b1-4781-936a-bce242ebc9a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b610747e60>]}
[0m10:20:05.028916 [info ] [Thread-1 (]: 2 of 10 OK created sql table model ___staging.dateclean ........................ [[32mSELECT 731[0m in 0.30s]
[0m10:20:05.031046 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.dateclean
[0m10:20:05.031986 [debug] [Thread-1 (]: Began running node model.dbt_project_25.my_first_dbt_model
[0m10:20:05.033234 [info ] [Thread-1 (]: 3 of 10 START sql table model _.my_first_dbt_model ............................. [RUN]
[0m10:20:05.034245 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_25.dateclean, now model.dbt_project_25.my_first_dbt_model)
[0m10:20:05.035137 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.my_first_dbt_model
[0m10:20:05.040060 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.my_first_dbt_model"
[0m10:20:05.041294 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.my_first_dbt_model
[0m10:20:05.048413 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.my_first_dbt_model"
[0m10:20:05.049736 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_first_dbt_model"
[0m10:20:05.050664 [debug] [Thread-1 (]: On model.dbt_project_25.my_first_dbt_model: BEGIN
[0m10:20:05.051535 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:20:05.285192 [debug] [Thread-1 (]: SQL status: BEGIN in 0.233 seconds
[0m10:20:05.287189 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_first_dbt_model"
[0m10:20:05.289129 [debug] [Thread-1 (]: On model.dbt_project_25.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.my_first_dbt_model"} */

  
    

  create  table "BI_group4"."_"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m10:20:05.302259 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.011 seconds
[0m10:20:05.313346 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_first_dbt_model"
[0m10:20:05.314250 [debug] [Thread-1 (]: On model.dbt_project_25.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.my_first_dbt_model"} */
alter table "BI_group4"."_"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m10:20:05.325014 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m10:20:05.333003 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_first_dbt_model"
[0m10:20:05.333886 [debug] [Thread-1 (]: On model.dbt_project_25.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.my_first_dbt_model"} */
alter table "BI_group4"."_"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m10:20:05.344648 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m10:20:05.350956 [debug] [Thread-1 (]: On model.dbt_project_25.my_first_dbt_model: COMMIT
[0m10:20:05.352372 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_first_dbt_model"
[0m10:20:05.353206 [debug] [Thread-1 (]: On model.dbt_project_25.my_first_dbt_model: COMMIT
[0m10:20:05.365890 [debug] [Thread-1 (]: SQL status: COMMIT in 0.012 seconds
[0m10:20:05.376487 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."_"."my_first_dbt_model__dbt_backup"
[0m10:20:05.378668 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_first_dbt_model"
[0m10:20:05.379652 [debug] [Thread-1 (]: On model.dbt_project_25.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.my_first_dbt_model"} */
drop table if exists "BI_group4"."_"."my_first_dbt_model__dbt_backup" cascade
[0m10:20:05.394540 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.014 seconds
[0m10:20:05.399855 [debug] [Thread-1 (]: On model.dbt_project_25.my_first_dbt_model: Close
[0m10:20:05.402185 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '231a72a6-c2b1-4781-936a-bce242ebc9a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b60d0fc200>]}
[0m10:20:05.403489 [info ] [Thread-1 (]: 3 of 10 OK created sql table model _.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.37s]
[0m10:20:05.404765 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.my_first_dbt_model
[0m10:20:05.405687 [debug] [Thread-1 (]: Began running node model.dbt_project_25.salesorderdetailsclean
[0m10:20:05.407201 [info ] [Thread-1 (]: 4 of 10 START sql table model ___staging.salesorderdetailsclean ................ [RUN]
[0m10:20:05.408242 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_25.my_first_dbt_model, now model.dbt_project_25.salesorderdetailsclean)
[0m10:20:05.409128 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.salesorderdetailsclean
[0m10:20:05.414628 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.salesorderdetailsclean"
[0m10:20:05.415899 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.salesorderdetailsclean
[0m10:20:05.422835 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.salesorderdetailsclean"
[0m10:20:05.424141 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderdetailsclean"
[0m10:20:05.425039 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderdetailsclean: BEGIN
[0m10:20:05.425888 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:20:05.582576 [debug] [Thread-1 (]: SQL status: BEGIN in 0.156 seconds
[0m10:20:05.584583 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderdetailsclean"
[0m10:20:05.586409 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderdetailsclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.salesorderdetailsclean"} */

  
    

  create  table "BI_group4"."___staging"."salesorderdetailsclean__dbt_tmp"
  
  
    as
  
  (
    

select 
	salesorderid, 
	unitprice,
	orderqty as orderquantity,
	productid,
	unitpricediscount as discount

from "BI_group4"."corentin"."salesorderdetail"
  );
  
[0m10:20:05.607267 [debug] [Thread-1 (]: SQL status: SELECT 5716 in 0.019 seconds
[0m10:20:05.616858 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderdetailsclean"
[0m10:20:05.617811 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderdetailsclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.salesorderdetailsclean"} */
alter table "BI_group4"."___staging"."salesorderdetailsclean" rename to "salesorderdetailsclean__dbt_backup"
[0m10:20:05.629212 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m10:20:05.635670 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderdetailsclean"
[0m10:20:05.636559 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderdetailsclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.salesorderdetailsclean"} */
alter table "BI_group4"."___staging"."salesorderdetailsclean__dbt_tmp" rename to "salesorderdetailsclean"
[0m10:20:05.647381 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m10:20:05.652901 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderdetailsclean: COMMIT
[0m10:20:05.654169 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderdetailsclean"
[0m10:20:05.655020 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderdetailsclean: COMMIT
[0m10:20:05.672299 [debug] [Thread-1 (]: SQL status: COMMIT in 0.016 seconds
[0m10:20:05.681649 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."___staging"."salesorderdetailsclean__dbt_backup"
[0m10:20:05.684730 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderdetailsclean"
[0m10:20:05.685620 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderdetailsclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.salesorderdetailsclean"} */
drop table if exists "BI_group4"."___staging"."salesorderdetailsclean__dbt_backup" cascade
[0m10:20:05.703369 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.017 seconds
[0m10:20:05.708650 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderdetailsclean: Close
[0m10:20:05.711119 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '231a72a6-c2b1-4781-936a-bce242ebc9a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b60d2d69f0>]}
[0m10:20:05.713809 [info ] [Thread-1 (]: 4 of 10 OK created sql table model ___staging.salesorderdetailsclean ........... [[32mSELECT 5716[0m in 0.30s]
[0m10:20:05.715204 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.salesorderdetailsclean
[0m10:20:05.716152 [debug] [Thread-1 (]: Began running node model.dbt_project_25.salesorderheaderclean
[0m10:20:05.717367 [info ] [Thread-1 (]: 5 of 10 START sql table model ___staging.salesorderheaderclean ................. [RUN]
[0m10:20:05.718379 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_25.salesorderdetailsclean, now model.dbt_project_25.salesorderheaderclean)
[0m10:20:05.719281 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.salesorderheaderclean
[0m10:20:05.724753 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.salesorderheaderclean"
[0m10:20:05.725970 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.salesorderheaderclean
[0m10:20:05.732869 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.salesorderheaderclean"
[0m10:20:05.734140 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderheaderclean"
[0m10:20:05.735025 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderheaderclean: BEGIN
[0m10:20:05.735847 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:20:05.904369 [debug] [Thread-1 (]: SQL status: BEGIN in 0.168 seconds
[0m10:20:05.906394 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderheaderclean"
[0m10:20:05.908230 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderheaderclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.salesorderheaderclean"} */

  
    

  create  table "BI_group4"."___staging"."salesorderheaderclean__dbt_tmp"
  
  
    as
  
  (
    

select
    orderdate,
    salesorderid,
    territoryid,
    salespersonid as salerid,
    billtoaddressid,
    customerid,
    salespersonid,
    shipdate
from "BI_group4"."corentin"."salesorderheader"
  );
  
[0m10:20:05.930395 [debug] [Thread-1 (]: SQL status: SELECT 1566 in 0.020 seconds
[0m10:20:05.940202 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderheaderclean"
[0m10:20:05.941359 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderheaderclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.salesorderheaderclean"} */
alter table "BI_group4"."___staging"."salesorderheaderclean" rename to "salesorderheaderclean__dbt_backup"
[0m10:20:05.952232 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m10:20:05.960556 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderheaderclean"
[0m10:20:05.961450 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderheaderclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.salesorderheaderclean"} */
alter table "BI_group4"."___staging"."salesorderheaderclean__dbt_tmp" rename to "salesorderheaderclean"
[0m10:20:05.972400 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m10:20:05.979557 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderheaderclean: COMMIT
[0m10:20:05.981368 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderheaderclean"
[0m10:20:05.983127 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderheaderclean: COMMIT
[0m10:20:05.998858 [debug] [Thread-1 (]: SQL status: COMMIT in 0.014 seconds
[0m10:20:06.007355 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."___staging"."salesorderheaderclean__dbt_backup"
[0m10:20:06.009261 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderheaderclean"
[0m10:20:06.010211 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderheaderclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.salesorderheaderclean"} */
drop table if exists "BI_group4"."___staging"."salesorderheaderclean__dbt_backup" cascade
[0m10:20:06.024319 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.013 seconds
[0m10:20:06.027172 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderheaderclean: Close
[0m10:20:06.028784 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '231a72a6-c2b1-4781-936a-bce242ebc9a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b60fba6f60>]}
[0m10:20:06.030477 [info ] [Thread-1 (]: 5 of 10 OK created sql table model ___staging.salesorderheaderclean ............ [[32mSELECT 1566[0m in 0.31s]
[0m10:20:06.032150 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.salesorderheaderclean
[0m10:20:06.033344 [debug] [Thread-1 (]: Began running node model.dbt_project_25.stg_product
[0m10:20:06.034852 [info ] [Thread-1 (]: 6 of 10 START sql table model ___staging.stg_product ........................... [RUN]
[0m10:20:06.036111 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_25.salesorderheaderclean, now model.dbt_project_25.stg_product)
[0m10:20:06.036999 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.stg_product
[0m10:20:06.042723 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.stg_product"
[0m10:20:06.044007 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.stg_product
[0m10:20:06.051059 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.stg_product"
[0m10:20:06.052325 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_product"
[0m10:20:06.053209 [debug] [Thread-1 (]: On model.dbt_project_25.stg_product: BEGIN
[0m10:20:06.054044 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:20:06.291992 [debug] [Thread-1 (]: SQL status: BEGIN in 0.238 seconds
[0m10:20:06.293971 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_product"
[0m10:20:06.295848 [debug] [Thread-1 (]: On model.dbt_project_25.stg_product: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_product"} */

  
    

  create  table "BI_group4"."___staging"."stg_product__dbt_tmp"
  
  
    as
  
  (
    

SELECT
  productid, 
  name AS itemname
FROM "BI_group4"."corentin"."product"

--run in terminal/shell: 
--dbt run --select stg_product

--(This will build the model as a new view/table in your dev schema, leaving the original data untouched)
  );
  
[0m10:20:06.309761 [debug] [Thread-1 (]: SQL status: SELECT 504 in 0.012 seconds
[0m10:20:06.320231 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_product"
[0m10:20:06.321134 [debug] [Thread-1 (]: On model.dbt_project_25.stg_product: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_product"} */
alter table "BI_group4"."___staging"."stg_product" rename to "stg_product__dbt_backup"
[0m10:20:06.332477 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m10:20:06.339177 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_product"
[0m10:20:06.340070 [debug] [Thread-1 (]: On model.dbt_project_25.stg_product: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_product"} */
alter table "BI_group4"."___staging"."stg_product__dbt_tmp" rename to "stg_product"
[0m10:20:06.350368 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.009 seconds
[0m10:20:06.356130 [debug] [Thread-1 (]: On model.dbt_project_25.stg_product: COMMIT
[0m10:20:06.357630 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_product"
[0m10:20:06.358663 [debug] [Thread-1 (]: On model.dbt_project_25.stg_product: COMMIT
[0m10:20:06.371410 [debug] [Thread-1 (]: SQL status: COMMIT in 0.012 seconds
[0m10:20:06.379645 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."___staging"."stg_product__dbt_backup"
[0m10:20:06.381476 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_product"
[0m10:20:06.382396 [debug] [Thread-1 (]: On model.dbt_project_25.stg_product: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_product"} */
drop table if exists "BI_group4"."___staging"."stg_product__dbt_backup" cascade
[0m10:20:06.396837 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.014 seconds
[0m10:20:06.399658 [debug] [Thread-1 (]: On model.dbt_project_25.stg_product: Close
[0m10:20:06.401353 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '231a72a6-c2b1-4781-936a-bce242ebc9a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b61184b260>]}
[0m10:20:06.403172 [info ] [Thread-1 (]: 6 of 10 OK created sql table model ___staging.stg_product ...................... [[32mSELECT 504[0m in 0.37s]
[0m10:20:06.404951 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.stg_product
[0m10:20:06.406235 [debug] [Thread-1 (]: Began running node model.dbt_project_25.stg_productcat
[0m10:20:06.407903 [info ] [Thread-1 (]: 7 of 10 START sql table model ___staging.stg_productcat ........................ [RUN]
[0m10:20:06.409100 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_25.stg_product, now model.dbt_project_25.stg_productcat)
[0m10:20:06.409996 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.stg_productcat
[0m10:20:06.415699 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.stg_productcat"
[0m10:20:06.416933 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.stg_productcat
[0m10:20:06.424052 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.stg_productcat"
[0m10:20:06.425302 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_productcat"
[0m10:20:06.426202 [debug] [Thread-1 (]: On model.dbt_project_25.stg_productcat: BEGIN
[0m10:20:06.427028 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:20:06.595244 [debug] [Thread-1 (]: SQL status: BEGIN in 0.168 seconds
[0m10:20:06.597269 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_productcat"
[0m10:20:06.635130 [debug] [Thread-1 (]: On model.dbt_project_25.stg_productcat: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_productcat"} */

  
    

  create  table "BI_group4"."___staging"."stg_productcat__dbt_tmp"
  
  
    as
  
  (
    

SELECT
  productcategoryid, 
  name AS itemcategoryname
FROM "BI_group4"."corentin"."productcategory"

--run in terminal/shell: 
--dbt run --select stg_productcat

--(This will build the model as a new view/table in your dev schema, leaving the original data untouched)
  );
  
[0m10:20:06.651534 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.014 seconds
[0m10:20:06.662320 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_productcat"
[0m10:20:06.663233 [debug] [Thread-1 (]: On model.dbt_project_25.stg_productcat: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_productcat"} */
alter table "BI_group4"."___staging"."stg_productcat" rename to "stg_productcat__dbt_backup"
[0m10:20:06.674736 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m10:20:06.684488 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_productcat"
[0m10:20:06.685382 [debug] [Thread-1 (]: On model.dbt_project_25.stg_productcat: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_productcat"} */
alter table "BI_group4"."___staging"."stg_productcat__dbt_tmp" rename to "stg_productcat"
[0m10:20:06.697281 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.011 seconds
[0m10:20:06.701095 [debug] [Thread-1 (]: On model.dbt_project_25.stg_productcat: COMMIT
[0m10:20:06.702042 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_productcat"
[0m10:20:06.702925 [debug] [Thread-1 (]: On model.dbt_project_25.stg_productcat: COMMIT
[0m10:20:06.715712 [debug] [Thread-1 (]: SQL status: COMMIT in 0.012 seconds
[0m10:20:06.720282 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."___staging"."stg_productcat__dbt_backup"
[0m10:20:06.722046 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_productcat"
[0m10:20:06.722929 [debug] [Thread-1 (]: On model.dbt_project_25.stg_productcat: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_productcat"} */
drop table if exists "BI_group4"."___staging"."stg_productcat__dbt_backup" cascade
[0m10:20:06.738491 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.014 seconds
[0m10:20:06.743303 [debug] [Thread-1 (]: On model.dbt_project_25.stg_productcat: Close
[0m10:20:06.745865 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '231a72a6-c2b1-4781-936a-bce242ebc9a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b5df70fad0>]}
[0m10:20:06.748482 [info ] [Thread-1 (]: 7 of 10 OK created sql table model ___staging.stg_productcat ................... [[32mSELECT 4[0m in 0.34s]
[0m10:20:06.750747 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.stg_productcat
[0m10:20:06.751669 [debug] [Thread-1 (]: Began running node model.dbt_project_25.stg_stateprovince
[0m10:20:06.752859 [info ] [Thread-1 (]: 8 of 10 START sql table model ___staging.stg_stateprovince ..................... [RUN]
[0m10:20:06.753847 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_25.stg_productcat, now model.dbt_project_25.stg_stateprovince)
[0m10:20:06.754716 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.stg_stateprovince
[0m10:20:06.760285 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.stg_stateprovince"
[0m10:20:06.761553 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.stg_stateprovince
[0m10:20:06.768704 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.stg_stateprovince"
[0m10:20:06.769961 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_stateprovince"
[0m10:20:06.770848 [debug] [Thread-1 (]: On model.dbt_project_25.stg_stateprovince: BEGIN
[0m10:20:06.771683 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:20:06.928543 [debug] [Thread-1 (]: SQL status: BEGIN in 0.156 seconds
[0m10:20:06.930528 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_stateprovince"
[0m10:20:06.932388 [debug] [Thread-1 (]: On model.dbt_project_25.stg_stateprovince: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_stateprovince"} */

  
    

  create  table "BI_group4"."___staging"."stg_stateprovince__dbt_tmp"
  
  
    as
  
  (
    

SELECT
  stateprovinceid, 
  countryregioncode,
  territoryid,
  name AS regionname,
  stateprovincecode
FROM "BI_group4"."corentin"."stateprovince"

--run in terminal/shell: 
--dbt run --select stg_stateprovince

--(This will build the model as a new view/table in your dev schema, leaving the original data untouched)
  );
  
[0m10:20:06.946104 [debug] [Thread-1 (]: SQL status: SELECT 181 in 0.012 seconds
[0m10:20:06.956834 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_stateprovince"
[0m10:20:06.957982 [debug] [Thread-1 (]: On model.dbt_project_25.stg_stateprovince: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_stateprovince"} */
alter table "BI_group4"."___staging"."stg_stateprovince" rename to "stg_stateprovince__dbt_backup"
[0m10:20:06.968867 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m10:20:06.974703 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_stateprovince"
[0m10:20:06.975636 [debug] [Thread-1 (]: On model.dbt_project_25.stg_stateprovince: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_stateprovince"} */
alter table "BI_group4"."___staging"."stg_stateprovince__dbt_tmp" rename to "stg_stateprovince"
[0m10:20:06.986596 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m10:20:06.991351 [debug] [Thread-1 (]: On model.dbt_project_25.stg_stateprovince: COMMIT
[0m10:20:06.992519 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_stateprovince"
[0m10:20:06.993354 [debug] [Thread-1 (]: On model.dbt_project_25.stg_stateprovince: COMMIT
[0m10:20:07.005699 [debug] [Thread-1 (]: SQL status: COMMIT in 0.011 seconds
[0m10:20:07.013449 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."___staging"."stg_stateprovince__dbt_backup"
[0m10:20:07.015445 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_stateprovince"
[0m10:20:07.016437 [debug] [Thread-1 (]: On model.dbt_project_25.stg_stateprovince: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_stateprovince"} */
drop table if exists "BI_group4"."___staging"."stg_stateprovince__dbt_backup" cascade
[0m10:20:07.031227 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.014 seconds
[0m10:20:07.034989 [debug] [Thread-1 (]: On model.dbt_project_25.stg_stateprovince: Close
[0m10:20:07.036849 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '231a72a6-c2b1-4781-936a-bce242ebc9a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b6139d9f70>]}
[0m10:20:07.038821 [info ] [Thread-1 (]: 8 of 10 OK created sql table model ___staging.stg_stateprovince ................ [[32mSELECT 181[0m in 0.28s]
[0m10:20:07.040769 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.stg_stateprovince
[0m10:20:07.042025 [debug] [Thread-1 (]: Began running node model.dbt_project_25.storeclean
[0m10:20:07.043250 [info ] [Thread-1 (]: 9 of 10 START sql table model ___staging.storeclean ............................ [RUN]
[0m10:20:07.044270 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_25.stg_stateprovince, now model.dbt_project_25.storeclean)
[0m10:20:07.045165 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.storeclean
[0m10:20:07.050788 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.storeclean"
[0m10:20:07.052065 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.storeclean
[0m10:20:07.059290 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.storeclean"
[0m10:20:07.060586 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.storeclean"
[0m10:20:07.061454 [debug] [Thread-1 (]: On model.dbt_project_25.storeclean: BEGIN
[0m10:20:07.062297 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:20:07.307752 [debug] [Thread-1 (]: SQL status: BEGIN in 0.245 seconds
[0m10:20:07.309741 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.storeclean"
[0m10:20:07.311560 [debug] [Thread-1 (]: On model.dbt_project_25.storeclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.storeclean"} */

  
    

  create  table "BI_group4"."___staging"."storeclean__dbt_tmp"
  
  
    as
  
  (
    

select
    salespersonid as salerid,
    storename,
    businessentityid
from "BI_group4"."corentin"."store1"
  );
  
[0m10:20:07.328224 [debug] [Thread-1 (]: SQL status: SELECT 701 in 0.015 seconds
[0m10:20:07.338861 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.storeclean"
[0m10:20:07.340023 [debug] [Thread-1 (]: On model.dbt_project_25.storeclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.storeclean"} */
alter table "BI_group4"."___staging"."storeclean" rename to "storeclean__dbt_backup"
[0m10:20:07.351308 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m10:20:07.360307 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.storeclean"
[0m10:20:07.361271 [debug] [Thread-1 (]: On model.dbt_project_25.storeclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.storeclean"} */
alter table "BI_group4"."___staging"."storeclean__dbt_tmp" rename to "storeclean"
[0m10:20:07.372349 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m10:20:07.376242 [debug] [Thread-1 (]: On model.dbt_project_25.storeclean: COMMIT
[0m10:20:07.377267 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.storeclean"
[0m10:20:07.378231 [debug] [Thread-1 (]: On model.dbt_project_25.storeclean: COMMIT
[0m10:20:07.392124 [debug] [Thread-1 (]: SQL status: COMMIT in 0.013 seconds
[0m10:20:07.397457 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."___staging"."storeclean__dbt_backup"
[0m10:20:07.399837 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.storeclean"
[0m10:20:07.400900 [debug] [Thread-1 (]: On model.dbt_project_25.storeclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.storeclean"} */
drop table if exists "BI_group4"."___staging"."storeclean__dbt_backup" cascade
[0m10:20:07.416172 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.014 seconds
[0m10:20:07.419874 [debug] [Thread-1 (]: On model.dbt_project_25.storeclean: Close
[0m10:20:07.421625 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '231a72a6-c2b1-4781-936a-bce242ebc9a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b60fbcbec0>]}
[0m10:20:07.423427 [info ] [Thread-1 (]: 9 of 10 OK created sql table model ___staging.storeclean ....................... [[32mSELECT 701[0m in 0.38s]
[0m10:20:07.425038 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.storeclean
[0m10:20:07.425966 [debug] [Thread-1 (]: Began running node model.dbt_project_25.my_second_dbt_model
[0m10:20:07.427182 [info ] [Thread-1 (]: 10 of 10 START sql view model _.my_second_dbt_model ............................ [RUN]
[0m10:20:07.428181 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_25.storeclean, now model.dbt_project_25.my_second_dbt_model)
[0m10:20:07.429075 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.my_second_dbt_model
[0m10:20:07.434331 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.my_second_dbt_model"
[0m10:20:07.435651 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.my_second_dbt_model
[0m10:20:07.469706 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.my_second_dbt_model"
[0m10:20:07.471058 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_second_dbt_model"
[0m10:20:07.471954 [debug] [Thread-1 (]: On model.dbt_project_25.my_second_dbt_model: BEGIN
[0m10:20:07.472765 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:20:07.634364 [debug] [Thread-1 (]: SQL status: BEGIN in 0.161 seconds
[0m10:20:07.636337 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_second_dbt_model"
[0m10:20:07.638161 [debug] [Thread-1 (]: On model.dbt_project_25.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.my_second_dbt_model"} */

  create view "BI_group4"."_"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "BI_group4"."_"."my_first_dbt_model"
where id = 1
  );
[0m10:20:07.651735 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m10:20:07.660249 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_second_dbt_model"
[0m10:20:07.661397 [debug] [Thread-1 (]: On model.dbt_project_25.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.my_second_dbt_model"} */
alter table "BI_group4"."_"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m10:20:07.672723 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m10:20:07.675926 [debug] [Thread-1 (]: On model.dbt_project_25.my_second_dbt_model: COMMIT
[0m10:20:07.676821 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_second_dbt_model"
[0m10:20:07.677649 [debug] [Thread-1 (]: On model.dbt_project_25.my_second_dbt_model: COMMIT
[0m10:20:07.691015 [debug] [Thread-1 (]: SQL status: COMMIT in 0.012 seconds
[0m10:20:07.699089 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."_"."my_second_dbt_model__dbt_backup"
[0m10:20:07.707436 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_second_dbt_model"
[0m10:20:07.708355 [debug] [Thread-1 (]: On model.dbt_project_25.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.my_second_dbt_model"} */
drop view if exists "BI_group4"."_"."my_second_dbt_model__dbt_backup" cascade
[0m10:20:07.719321 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.010 seconds
[0m10:20:07.723637 [debug] [Thread-1 (]: On model.dbt_project_25.my_second_dbt_model: Close
[0m10:20:07.725666 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '231a72a6-c2b1-4781-936a-bce242ebc9a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b60fbcbd40>]}
[0m10:20:07.727599 [info ] [Thread-1 (]: 10 of 10 OK created sql view model _.my_second_dbt_model ....................... [[32mCREATE VIEW[0m in 0.30s]
[0m10:20:07.728883 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.my_second_dbt_model
[0m10:20:07.732348 [debug] [MainThread]: Using postgres connection "master"
[0m10:20:07.734039 [debug] [MainThread]: On master: BEGIN
[0m10:20:07.735621 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:20:07.897353 [debug] [MainThread]: SQL status: BEGIN in 0.162 seconds
[0m10:20:07.899196 [debug] [MainThread]: On master: COMMIT
[0m10:20:07.900816 [debug] [MainThread]: Using postgres connection "master"
[0m10:20:07.902349 [debug] [MainThread]: On master: COMMIT
[0m10:20:07.913053 [debug] [MainThread]: SQL status: COMMIT in 0.009 seconds
[0m10:20:07.914148 [debug] [MainThread]: On master: Close
[0m10:20:07.915394 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:20:07.916254 [debug] [MainThread]: Connection 'model.dbt_project_25.my_second_dbt_model' was properly closed.
[0m10:20:07.917255 [info ] [MainThread]: 
[0m10:20:07.918167 [info ] [MainThread]: Finished running 9 table models, 1 view model in 0 hours 0 minutes and 4.81 seconds (4.81s).
[0m10:20:07.921784 [debug] [MainThread]: Command end result
[0m10:20:07.969991 [debug] [MainThread]: Wrote artifact WritableManifest to /home/corentin.vanlandeghe@Digital-Grenoble.local/BI_DBT/target/manifest.json
[0m10:20:07.973150 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/corentin.vanlandeghe@Digital-Grenoble.local/BI_DBT/target/semantic_manifest.json
[0m10:20:07.984229 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/corentin.vanlandeghe@Digital-Grenoble.local/BI_DBT/target/run_results.json
[0m10:20:07.985008 [info ] [MainThread]: 
[0m10:20:07.985853 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:20:07.986632 [info ] [MainThread]: 
[0m10:20:07.987422 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=10
[0m10:20:07.989130 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.574269, "process_in_blocks": "0", "process_kernel_time": 0.502251, "process_mem_max_rss": "127688", "process_out_blocks": "3840", "process_user_time": 5.568793}
[0m10:20:07.990142 [debug] [MainThread]: Command `dbt run` succeeded at 10:20:07.989954 after 6.58 seconds
[0m10:20:07.990966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b611c164b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b611569c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b60f3a1550>]}
[0m10:20:07.991825 [debug] [MainThread]: Flushing usage events
[0m10:20:08.452662 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:25:37.250949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2cf0606240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2cf0606d20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2cf00564b0>]}


============================== 10:25:37.256663 | 75ea5d53-ad74-421b-b167-47154c0d4d8b ==============================
[0m10:25:37.256663 [info ] [MainThread]: Running with dbt=1.10.2
[0m10:25:37.277669 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/corentin.vanlandeghe@Digital-Grenoble.local/.dbt', 'log_path': '/home/corentin.vanlandeghe@Digital-Grenoble.local/BI_DBT/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:25:37.606638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '75ea5d53-ad74-421b-b167-47154c0d4d8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2cefce7b00>]}
[0m10:25:37.733390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '75ea5d53-ad74-421b-b167-47154c0d4d8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2cf0ae1a90>]}
[0m10:25:37.734903 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:25:37.914957 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m10:25:38.147037 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m10:25:38.148208 [debug] [MainThread]: Partial parsing: added file: dbt_project_25://models/staging/productsubcategoryclean.sql
[0m10:25:38.149975 [debug] [MainThread]: Partial parsing: updated file: dbt_project_25://models/staging/schema.yml
[0m10:25:38.782074 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_project_25.productsubcategoryclean' (models/staging/productsubcategoryclean.sql) depends on a source named 'corentin.productsubcategory' which was not found
[0m10:25:38.784027 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.6423886, "process_in_blocks": "0", "process_kernel_time": 0.341004, "process_mem_max_rss": "117564", "process_out_blocks": "16", "process_user_time": 3.900055}
[0m10:25:38.785091 [debug] [MainThread]: Command `dbt run` failed at 10:25:38.784897 after 1.64 seconds
[0m10:25:38.785946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2cefe1f8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2cedf5b0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2cedf58290>]}
[0m10:25:38.786812 [debug] [MainThread]: Flushing usage events
[0m10:25:39.149427 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:26:12.805856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711abf533500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711abf7f81d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711ac15dfda0>]}


============================== 10:26:12.811608 | 264058a6-07ba-4db9-8a10-8229571a3b5f ==============================
[0m10:26:12.811608 [info ] [MainThread]: Running with dbt=1.10.2
[0m10:26:12.834984 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/corentin.vanlandeghe@Digital-Grenoble.local/.dbt', 'log_path': '/home/corentin.vanlandeghe@Digital-Grenoble.local/BI_DBT/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:26:13.160268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '264058a6-07ba-4db9-8a10-8229571a3b5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711abf7f81d0>]}
[0m10:26:13.286191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '264058a6-07ba-4db9-8a10-8229571a3b5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711abf5570e0>]}
[0m10:26:13.287673 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:26:13.467663 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m10:26:13.697688 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m10:26:13.698820 [debug] [MainThread]: Partial parsing: added file: dbt_project_25://models/staging/productsubcategoryclean.sql
[0m10:26:13.700569 [debug] [MainThread]: Partial parsing: updated file: dbt_project_25://models/staging/schema.yml
[0m10:26:14.466344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '264058a6-07ba-4db9-8a10-8229571a3b5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711abd3c4290>]}
[0m10:26:14.617138 [debug] [MainThread]: Wrote artifact WritableManifest to /home/corentin.vanlandeghe@Digital-Grenoble.local/BI_DBT/target/manifest.json
[0m10:26:14.620142 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/corentin.vanlandeghe@Digital-Grenoble.local/BI_DBT/target/semantic_manifest.json
[0m10:26:14.643258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '264058a6-07ba-4db9-8a10-8229571a3b5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711abdb73f20>]}
[0m10:26:14.644240 [info ] [MainThread]: Found 11 models, 4 data tests, 9 sources, 549 macros
[0m10:26:14.645066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '264058a6-07ba-4db9-8a10-8229571a3b5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711abe367230>]}
[0m10:26:14.649098 [info ] [MainThread]: 
[0m10:26:14.649935 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:26:14.650669 [info ] [MainThread]: 
[0m10:26:14.651687 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:26:14.660301 [debug] [ThreadPool]: Acquiring new postgres connection 'list_BI_group4'
[0m10:26:14.813842 [debug] [ThreadPool]: Using postgres connection "list_BI_group4"
[0m10:26:14.814763 [debug] [ThreadPool]: On list_BI_group4: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "connection_name": "list_BI_group4"} */

    select distinct nspname from pg_namespace
  
[0m10:26:14.815515 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:26:15.060990 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.245 seconds
[0m10:26:15.066367 [debug] [ThreadPool]: On list_BI_group4: Close
[0m10:26:15.074099 [debug] [ThreadPool]: Using postgres connection "list_BI_group4"
[0m10:26:15.074916 [debug] [ThreadPool]: On list_BI_group4: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "connection_name": "list_BI_group4"} */

    select distinct nspname from pg_namespace
  
[0m10:26:15.075659 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:26:15.238997 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.163 seconds
[0m10:26:15.244110 [debug] [ThreadPool]: On list_BI_group4: Close
[0m10:26:15.250558 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_BI_group4, now list_BI_group4__)
[0m10:26:15.262944 [debug] [ThreadPool]: Using postgres connection "list_BI_group4__"
[0m10:26:15.263746 [debug] [ThreadPool]: On list_BI_group4__: BEGIN
[0m10:26:15.264446 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:26:15.429217 [debug] [ThreadPool]: SQL status: BEGIN in 0.165 seconds
[0m10:26:15.430928 [debug] [ThreadPool]: Using postgres connection "list_BI_group4__"
[0m10:26:15.432579 [debug] [ThreadPool]: On list_BI_group4__: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "connection_name": "list_BI_group4__"} */
select
      'BI_group4' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike '_'
    union all
    select
      'BI_group4' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike '_'
    union all
    select
      'BI_group4' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike '_'
  
[0m10:26:15.451737 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.017 seconds
[0m10:26:15.456802 [debug] [ThreadPool]: On list_BI_group4__: ROLLBACK
[0m10:26:15.468598 [debug] [ThreadPool]: On list_BI_group4__: Close
[0m10:26:15.470564 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_BI_group4__, now list_BI_group4____staging)
[0m10:26:15.477583 [debug] [ThreadPool]: Using postgres connection "list_BI_group4____staging"
[0m10:26:15.478536 [debug] [ThreadPool]: On list_BI_group4____staging: BEGIN
[0m10:26:15.479390 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:26:15.641233 [debug] [ThreadPool]: SQL status: BEGIN in 0.162 seconds
[0m10:26:15.642971 [debug] [ThreadPool]: Using postgres connection "list_BI_group4____staging"
[0m10:26:15.644624 [debug] [ThreadPool]: On list_BI_group4____staging: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "connection_name": "list_BI_group4____staging"} */
select
      'BI_group4' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike '___staging'
    union all
    select
      'BI_group4' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike '___staging'
    union all
    select
      'BI_group4' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike '___staging'
  
[0m10:26:15.659826 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.014 seconds
[0m10:26:15.665479 [debug] [ThreadPool]: On list_BI_group4____staging: ROLLBACK
[0m10:26:15.676232 [debug] [ThreadPool]: On list_BI_group4____staging: Close
[0m10:26:15.693351 [debug] [MainThread]: Using postgres connection "master"
[0m10:26:15.694267 [debug] [MainThread]: On master: BEGIN
[0m10:26:15.695243 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:26:15.850735 [debug] [MainThread]: SQL status: BEGIN in 0.155 seconds
[0m10:26:15.852459 [debug] [MainThread]: Using postgres connection "master"
[0m10:26:15.854388 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:26:15.877857 [debug] [MainThread]: SQL status: SELECT 3 in 0.021 seconds
[0m10:26:15.884040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '264058a6-07ba-4db9-8a10-8229571a3b5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711abcb31190>]}
[0m10:26:15.886009 [debug] [MainThread]: On master: ROLLBACK
[0m10:26:15.896657 [debug] [MainThread]: Using postgres connection "master"
[0m10:26:15.898283 [debug] [MainThread]: On master: BEGIN
[0m10:26:15.918363 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m10:26:15.920055 [debug] [MainThread]: On master: COMMIT
[0m10:26:15.921645 [debug] [MainThread]: Using postgres connection "master"
[0m10:26:15.923146 [debug] [MainThread]: On master: COMMIT
[0m10:26:15.934189 [debug] [MainThread]: SQL status: COMMIT in 0.010 seconds
[0m10:26:15.935122 [debug] [MainThread]: On master: Close
[0m10:26:15.940918 [debug] [Thread-1 (]: Began running node model.dbt_project_25.customerclean
[0m10:26:15.943238 [info ] [Thread-1 (]: 1 of 11 START sql table model ___staging.customerclean ......................... [RUN]
[0m10:26:15.945309 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_BI_group4____staging, now model.dbt_project_25.customerclean)
[0m10:26:15.947124 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.customerclean
[0m10:26:15.962906 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.customerclean"
[0m10:26:15.964266 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.customerclean
[0m10:26:16.035015 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.customerclean"
[0m10:26:16.036381 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.customerclean"
[0m10:26:16.037279 [debug] [Thread-1 (]: On model.dbt_project_25.customerclean: BEGIN
[0m10:26:16.038086 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:26:16.195308 [debug] [Thread-1 (]: SQL status: BEGIN in 0.157 seconds
[0m10:26:16.197294 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.customerclean"
[0m10:26:16.199107 [debug] [Thread-1 (]: On model.dbt_project_25.customerclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.customerclean"} */

  
    

  create  table "BI_group4"."___staging"."customerclean__dbt_tmp"
  
  
    as
  
  (
    

select
    customerid, 
	storeid,
    territoryid
from "BI_group4"."corentin"."customer"
  );
  
[0m10:26:16.229477 [debug] [Thread-1 (]: SQL status: SELECT 19820 in 0.029 seconds
[0m10:26:16.255804 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.customerclean"
[0m10:26:16.256717 [debug] [Thread-1 (]: On model.dbt_project_25.customerclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.customerclean"} */
alter table "BI_group4"."___staging"."customerclean" rename to "customerclean__dbt_backup"
[0m10:26:16.267865 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m10:26:16.275147 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.customerclean"
[0m10:26:16.276371 [debug] [Thread-1 (]: On model.dbt_project_25.customerclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.customerclean"} */
alter table "BI_group4"."___staging"."customerclean__dbt_tmp" rename to "customerclean"
[0m10:26:16.286957 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.009 seconds
[0m10:26:16.318705 [debug] [Thread-1 (]: On model.dbt_project_25.customerclean: COMMIT
[0m10:26:16.319612 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.customerclean"
[0m10:26:16.320449 [debug] [Thread-1 (]: On model.dbt_project_25.customerclean: COMMIT
[0m10:26:16.342803 [debug] [Thread-1 (]: SQL status: COMMIT in 0.021 seconds
[0m10:26:16.358613 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."___staging"."customerclean__dbt_backup"
[0m10:26:16.368772 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.customerclean"
[0m10:26:16.369678 [debug] [Thread-1 (]: On model.dbt_project_25.customerclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.customerclean"} */
drop table if exists "BI_group4"."___staging"."customerclean__dbt_backup" cascade
[0m10:26:16.403823 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.033 seconds
[0m10:26:16.411768 [debug] [Thread-1 (]: On model.dbt_project_25.customerclean: Close
[0m10:26:16.415545 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '264058a6-07ba-4db9-8a10-8229571a3b5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711abe715ac0>]}
[0m10:26:16.417137 [info ] [Thread-1 (]: 1 of 11 OK created sql table model ___staging.customerclean .................... [[32mSELECT 19820[0m in 0.47s]
[0m10:26:16.418723 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.customerclean
[0m10:26:16.419856 [debug] [Thread-1 (]: Began running node model.dbt_project_25.dateclean
[0m10:26:16.421257 [info ] [Thread-1 (]: 2 of 11 START sql table model ___staging.dateclean ............................. [RUN]
[0m10:26:16.422271 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_25.customerclean, now model.dbt_project_25.dateclean)
[0m10:26:16.423156 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.dateclean
[0m10:26:16.428690 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.dateclean"
[0m10:26:16.429920 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.dateclean
[0m10:26:16.437182 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.dateclean"
[0m10:26:16.438459 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.dateclean"
[0m10:26:16.439344 [debug] [Thread-1 (]: On model.dbt_project_25.dateclean: BEGIN
[0m10:26:16.440169 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:26:16.607129 [debug] [Thread-1 (]: SQL status: BEGIN in 0.167 seconds
[0m10:26:16.609104 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.dateclean"
[0m10:26:16.610910 [debug] [Thread-1 (]: On model.dbt_project_25.dateclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.dateclean"} */

  
    

  create  table "BI_group4"."___staging"."dateclean__dbt_tmp"
  
  
    as
  
  (
    

select
    date_day,
    day_of_week as number_day_week,
    day_of_week_name as day_name
    
from "BI_group4"."corentin"."date"
  );
  
[0m10:26:16.625663 [debug] [Thread-1 (]: SQL status: SELECT 731 in 0.013 seconds
[0m10:26:16.636157 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.dateclean"
[0m10:26:16.637215 [debug] [Thread-1 (]: On model.dbt_project_25.dateclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.dateclean"} */
alter table "BI_group4"."___staging"."dateclean" rename to "dateclean__dbt_backup"
[0m10:26:16.648251 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m10:26:16.654176 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.dateclean"
[0m10:26:16.655064 [debug] [Thread-1 (]: On model.dbt_project_25.dateclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.dateclean"} */
alter table "BI_group4"."___staging"."dateclean__dbt_tmp" rename to "dateclean"
[0m10:26:16.665669 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.009 seconds
[0m10:26:16.669264 [debug] [Thread-1 (]: On model.dbt_project_25.dateclean: COMMIT
[0m10:26:16.670163 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.dateclean"
[0m10:26:16.671001 [debug] [Thread-1 (]: On model.dbt_project_25.dateclean: COMMIT
[0m10:26:16.684378 [debug] [Thread-1 (]: SQL status: COMMIT in 0.012 seconds
[0m10:26:16.692916 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."___staging"."dateclean__dbt_backup"
[0m10:26:16.694847 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.dateclean"
[0m10:26:16.695728 [debug] [Thread-1 (]: On model.dbt_project_25.dateclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.dateclean"} */
drop table if exists "BI_group4"."___staging"."dateclean__dbt_backup" cascade
[0m10:26:16.711383 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.015 seconds
[0m10:26:16.714668 [debug] [Thread-1 (]: On model.dbt_project_25.dateclean: Close
[0m10:26:16.716409 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '264058a6-07ba-4db9-8a10-8229571a3b5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711abd7c75f0>]}
[0m10:26:16.718240 [info ] [Thread-1 (]: 2 of 11 OK created sql table model ___staging.dateclean ........................ [[32mSELECT 731[0m in 0.29s]
[0m10:26:16.720035 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.dateclean
[0m10:26:16.721331 [debug] [Thread-1 (]: Began running node model.dbt_project_25.my_first_dbt_model
[0m10:26:16.722980 [info ] [Thread-1 (]: 3 of 11 START sql table model _.my_first_dbt_model ............................. [RUN]
[0m10:26:16.723981 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_25.dateclean, now model.dbt_project_25.my_first_dbt_model)
[0m10:26:16.724882 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.my_first_dbt_model
[0m10:26:16.729859 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.my_first_dbt_model"
[0m10:26:16.731083 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.my_first_dbt_model
[0m10:26:16.740782 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.my_first_dbt_model"
[0m10:26:16.742090 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_first_dbt_model"
[0m10:26:16.742976 [debug] [Thread-1 (]: On model.dbt_project_25.my_first_dbt_model: BEGIN
[0m10:26:16.743806 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:26:16.907862 [debug] [Thread-1 (]: SQL status: BEGIN in 0.164 seconds
[0m10:26:16.909867 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_first_dbt_model"
[0m10:26:16.911744 [debug] [Thread-1 (]: On model.dbt_project_25.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.my_first_dbt_model"} */

  
    

  create  table "BI_group4"."_"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m10:26:16.925420 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.012 seconds
[0m10:26:16.936206 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_first_dbt_model"
[0m10:26:16.937109 [debug] [Thread-1 (]: On model.dbt_project_25.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.my_first_dbt_model"} */
alter table "BI_group4"."_"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m10:26:16.948053 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m10:26:16.955371 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_first_dbt_model"
[0m10:26:16.956271 [debug] [Thread-1 (]: On model.dbt_project_25.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.my_first_dbt_model"} */
alter table "BI_group4"."_"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m10:26:16.967002 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m10:26:16.972734 [debug] [Thread-1 (]: On model.dbt_project_25.my_first_dbt_model: COMMIT
[0m10:26:16.974070 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_first_dbt_model"
[0m10:26:16.974923 [debug] [Thread-1 (]: On model.dbt_project_25.my_first_dbt_model: COMMIT
[0m10:26:16.987832 [debug] [Thread-1 (]: SQL status: COMMIT in 0.012 seconds
[0m10:26:16.996227 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."_"."my_first_dbt_model__dbt_backup"
[0m10:26:16.998190 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_first_dbt_model"
[0m10:26:16.999175 [debug] [Thread-1 (]: On model.dbt_project_25.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.my_first_dbt_model"} */
drop table if exists "BI_group4"."_"."my_first_dbt_model__dbt_backup" cascade
[0m10:26:17.016159 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.016 seconds
[0m10:26:17.021389 [debug] [Thread-1 (]: On model.dbt_project_25.my_first_dbt_model: Close
[0m10:26:17.023884 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '264058a6-07ba-4db9-8a10-8229571a3b5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711abd3d5ee0>]}
[0m10:26:17.025730 [info ] [Thread-1 (]: 3 of 11 OK created sql table model _.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.30s]
[0m10:26:17.027017 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.my_first_dbt_model
[0m10:26:17.027951 [debug] [Thread-1 (]: Began running node model.dbt_project_25.productsubcategoryclean
[0m10:26:17.029411 [info ] [Thread-1 (]: 4 of 11 START sql table model ___staging.productsubcategoryclean ............... [RUN]
[0m10:26:17.030430 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_25.my_first_dbt_model, now model.dbt_project_25.productsubcategoryclean)
[0m10:26:17.031374 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.productsubcategoryclean
[0m10:26:17.036866 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.productsubcategoryclean"
[0m10:26:17.038054 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.productsubcategoryclean
[0m10:26:17.044996 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.productsubcategoryclean"
[0m10:26:17.046206 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.productsubcategoryclean"
[0m10:26:17.047105 [debug] [Thread-1 (]: On model.dbt_project_25.productsubcategoryclean: BEGIN
[0m10:26:17.047977 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:26:17.208646 [debug] [Thread-1 (]: SQL status: BEGIN in 0.160 seconds
[0m10:26:17.210661 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.productsubcategoryclean"
[0m10:26:17.212763 [debug] [Thread-1 (]: On model.dbt_project_25.productsubcategoryclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.productsubcategoryclean"} */

  
    

  create  table "BI_group4"."___staging"."productsubcategoryclean__dbt_tmp"
  
  
    as
  
  (
    

select
    productsubcategoryid, 
	productcategoryid,
    name as subcategoryname
from "BI_group4"."corentin"."productsubcategory"
  );
  
[0m10:26:17.226204 [debug] [Thread-1 (]: SQL status: SELECT 37 in 0.012 seconds
[0m10:26:17.237387 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.productsubcategoryclean"
[0m10:26:17.238295 [debug] [Thread-1 (]: On model.dbt_project_25.productsubcategoryclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.productsubcategoryclean"} */
alter table "BI_group4"."___staging"."productsubcategoryclean__dbt_tmp" rename to "productsubcategoryclean"
[0m10:26:17.249246 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m10:26:17.253884 [debug] [Thread-1 (]: On model.dbt_project_25.productsubcategoryclean: COMMIT
[0m10:26:17.255252 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.productsubcategoryclean"
[0m10:26:17.256370 [debug] [Thread-1 (]: On model.dbt_project_25.productsubcategoryclean: COMMIT
[0m10:26:17.269545 [debug] [Thread-1 (]: SQL status: COMMIT in 0.012 seconds
[0m10:26:17.277542 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."___staging"."productsubcategoryclean__dbt_backup"
[0m10:26:17.279673 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.productsubcategoryclean"
[0m10:26:17.280666 [debug] [Thread-1 (]: On model.dbt_project_25.productsubcategoryclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.productsubcategoryclean"} */
drop table if exists "BI_group4"."___staging"."productsubcategoryclean__dbt_backup" cascade
[0m10:26:17.291606 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.010 seconds
[0m10:26:17.294516 [debug] [Thread-1 (]: On model.dbt_project_25.productsubcategoryclean: Close
[0m10:26:17.296088 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '264058a6-07ba-4db9-8a10-8229571a3b5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711abcf00890>]}
[0m10:26:17.297469 [info ] [Thread-1 (]: 4 of 11 OK created sql table model ___staging.productsubcategoryclean .......... [[32mSELECT 37[0m in 0.27s]
[0m10:26:17.298775 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.productsubcategoryclean
[0m10:26:17.299722 [debug] [Thread-1 (]: Began running node model.dbt_project_25.salesorderdetailsclean
[0m10:26:17.300945 [info ] [Thread-1 (]: 5 of 11 START sql table model ___staging.salesorderdetailsclean ................ [RUN]
[0m10:26:17.301958 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_25.productsubcategoryclean, now model.dbt_project_25.salesorderdetailsclean)
[0m10:26:17.302857 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.salesorderdetailsclean
[0m10:26:17.308345 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.salesorderdetailsclean"
[0m10:26:17.309625 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.salesorderdetailsclean
[0m10:26:17.316695 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.salesorderdetailsclean"
[0m10:26:17.317989 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderdetailsclean"
[0m10:26:17.318892 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderdetailsclean: BEGIN
[0m10:26:17.319764 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:26:17.478551 [debug] [Thread-1 (]: SQL status: BEGIN in 0.158 seconds
[0m10:26:17.480569 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderdetailsclean"
[0m10:26:17.482400 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderdetailsclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.salesorderdetailsclean"} */

  
    

  create  table "BI_group4"."___staging"."salesorderdetailsclean__dbt_tmp"
  
  
    as
  
  (
    

select 
	salesorderid, 
	unitprice,
	orderqty as orderquantity,
	productid,
	unitpricediscount as discount

from "BI_group4"."corentin"."salesorderdetail"
  );
  
[0m10:26:17.503615 [debug] [Thread-1 (]: SQL status: SELECT 5716 in 0.019 seconds
[0m10:26:17.519196 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderdetailsclean"
[0m10:26:17.520275 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderdetailsclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.salesorderdetailsclean"} */
alter table "BI_group4"."___staging"."salesorderdetailsclean" rename to "salesorderdetailsclean__dbt_backup"
[0m10:26:17.532422 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.011 seconds
[0m10:26:17.539102 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderdetailsclean"
[0m10:26:17.540006 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderdetailsclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.salesorderdetailsclean"} */
alter table "BI_group4"."___staging"."salesorderdetailsclean__dbt_tmp" rename to "salesorderdetailsclean"
[0m10:26:17.551487 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m10:26:17.557299 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderdetailsclean: COMMIT
[0m10:26:17.558210 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderdetailsclean"
[0m10:26:17.559063 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderdetailsclean: COMMIT
[0m10:26:17.574594 [debug] [Thread-1 (]: SQL status: COMMIT in 0.014 seconds
[0m10:26:17.583841 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."___staging"."salesorderdetailsclean__dbt_backup"
[0m10:26:17.587513 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderdetailsclean"
[0m10:26:17.588589 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderdetailsclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.salesorderdetailsclean"} */
drop table if exists "BI_group4"."___staging"."salesorderdetailsclean__dbt_backup" cascade
[0m10:26:17.603744 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.014 seconds
[0m10:26:17.608824 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderdetailsclean: Close
[0m10:26:17.610901 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '264058a6-07ba-4db9-8a10-8229571a3b5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711abadda960>]}
[0m10:26:17.613061 [info ] [Thread-1 (]: 5 of 11 OK created sql table model ___staging.salesorderdetailsclean ........... [[32mSELECT 5716[0m in 0.31s]
[0m10:26:17.615191 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.salesorderdetailsclean
[0m10:26:17.616738 [debug] [Thread-1 (]: Began running node model.dbt_project_25.salesorderheaderclean
[0m10:26:17.618527 [info ] [Thread-1 (]: 6 of 11 START sql table model ___staging.salesorderheaderclean ................. [RUN]
[0m10:26:17.619542 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_25.salesorderdetailsclean, now model.dbt_project_25.salesorderheaderclean)
[0m10:26:17.620437 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.salesorderheaderclean
[0m10:26:17.625996 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.salesorderheaderclean"
[0m10:26:17.627238 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.salesorderheaderclean
[0m10:26:17.634454 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.salesorderheaderclean"
[0m10:26:17.635743 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderheaderclean"
[0m10:26:17.636642 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderheaderclean: BEGIN
[0m10:26:17.637472 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:26:17.794720 [debug] [Thread-1 (]: SQL status: BEGIN in 0.157 seconds
[0m10:26:17.796948 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderheaderclean"
[0m10:26:17.798764 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderheaderclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.salesorderheaderclean"} */

  
    

  create  table "BI_group4"."___staging"."salesorderheaderclean__dbt_tmp"
  
  
    as
  
  (
    

select
    orderdate,
    salesorderid,
    territoryid,
    salespersonid as salerid,
    billtoaddressid,
    customerid,
    salespersonid,
    shipdate
from "BI_group4"."corentin"."salesorderheader"
  );
  
[0m10:26:17.815690 [debug] [Thread-1 (]: SQL status: SELECT 1566 in 0.015 seconds
[0m10:26:17.827804 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderheaderclean"
[0m10:26:17.829361 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderheaderclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.salesorderheaderclean"} */
alter table "BI_group4"."___staging"."salesorderheaderclean" rename to "salesorderheaderclean__dbt_backup"
[0m10:26:17.840121 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m10:26:17.850634 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderheaderclean"
[0m10:26:17.851528 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderheaderclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.salesorderheaderclean"} */
alter table "BI_group4"."___staging"."salesorderheaderclean__dbt_tmp" rename to "salesorderheaderclean"
[0m10:26:17.862080 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.009 seconds
[0m10:26:17.867320 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderheaderclean: COMMIT
[0m10:26:17.868686 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderheaderclean"
[0m10:26:17.869936 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderheaderclean: COMMIT
[0m10:26:17.882200 [debug] [Thread-1 (]: SQL status: COMMIT in 0.011 seconds
[0m10:26:17.890261 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."___staging"."salesorderheaderclean__dbt_backup"
[0m10:26:17.892040 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderheaderclean"
[0m10:26:17.892926 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderheaderclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.salesorderheaderclean"} */
drop table if exists "BI_group4"."___staging"."salesorderheaderclean__dbt_backup" cascade
[0m10:26:17.908006 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.014 seconds
[0m10:26:17.910771 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderheaderclean: Close
[0m10:26:17.912431 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '264058a6-07ba-4db9-8a10-8229571a3b5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711abd7c6450>]}
[0m10:26:17.914026 [info ] [Thread-1 (]: 6 of 11 OK created sql table model ___staging.salesorderheaderclean ............ [[32mSELECT 1566[0m in 0.29s]
[0m10:26:17.915588 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.salesorderheaderclean
[0m10:26:17.916718 [debug] [Thread-1 (]: Began running node model.dbt_project_25.stg_product
[0m10:26:17.918141 [info ] [Thread-1 (]: 7 of 11 START sql table model ___staging.stg_product ........................... [RUN]
[0m10:26:17.919335 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_25.salesorderheaderclean, now model.dbt_project_25.stg_product)
[0m10:26:17.920314 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.stg_product
[0m10:26:17.925892 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.stg_product"
[0m10:26:17.927147 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.stg_product
[0m10:26:17.937597 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.stg_product"
[0m10:26:17.938870 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_product"
[0m10:26:17.939754 [debug] [Thread-1 (]: On model.dbt_project_25.stg_product: BEGIN
[0m10:26:17.940569 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:26:18.097889 [debug] [Thread-1 (]: SQL status: BEGIN in 0.157 seconds
[0m10:26:18.099858 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_product"
[0m10:26:18.101713 [debug] [Thread-1 (]: On model.dbt_project_25.stg_product: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_product"} */

  
    

  create  table "BI_group4"."___staging"."stg_product__dbt_tmp"
  
  
    as
  
  (
    

SELECT
  productid, 
  name AS itemname
FROM "BI_group4"."corentin"."product"

--run in terminal/shell: 
--dbt run --select stg_product

--(This will build the model as a new view/table in your dev schema, leaving the original data untouched)
  );
  
[0m10:26:18.116091 [debug] [Thread-1 (]: SQL status: SELECT 504 in 0.013 seconds
[0m10:26:18.126477 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_product"
[0m10:26:18.127736 [debug] [Thread-1 (]: On model.dbt_project_25.stg_product: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_product"} */
alter table "BI_group4"."___staging"."stg_product" rename to "stg_product__dbt_backup"
[0m10:26:18.138848 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m10:26:18.145051 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_product"
[0m10:26:18.146057 [debug] [Thread-1 (]: On model.dbt_project_25.stg_product: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_product"} */
alter table "BI_group4"."___staging"."stg_product__dbt_tmp" rename to "stg_product"
[0m10:26:18.156821 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m10:26:18.160872 [debug] [Thread-1 (]: On model.dbt_project_25.stg_product: COMMIT
[0m10:26:18.161890 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_product"
[0m10:26:18.162733 [debug] [Thread-1 (]: On model.dbt_project_25.stg_product: COMMIT
[0m10:26:18.175455 [debug] [Thread-1 (]: SQL status: COMMIT in 0.012 seconds
[0m10:26:18.183566 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."___staging"."stg_product__dbt_backup"
[0m10:26:18.185728 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_product"
[0m10:26:18.186805 [debug] [Thread-1 (]: On model.dbt_project_25.stg_product: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_product"} */
drop table if exists "BI_group4"."___staging"."stg_product__dbt_backup" cascade
[0m10:26:18.200770 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.013 seconds
[0m10:26:18.204061 [debug] [Thread-1 (]: On model.dbt_project_25.stg_product: Close
[0m10:26:18.205819 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '264058a6-07ba-4db9-8a10-8229571a3b5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711abd3e7530>]}
[0m10:26:18.207625 [info ] [Thread-1 (]: 7 of 11 OK created sql table model ___staging.stg_product ...................... [[32mSELECT 504[0m in 0.29s]
[0m10:26:18.209396 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.stg_product
[0m10:26:18.210709 [debug] [Thread-1 (]: Began running node model.dbt_project_25.stg_productcat
[0m10:26:18.212180 [info ] [Thread-1 (]: 8 of 11 START sql table model ___staging.stg_productcat ........................ [RUN]
[0m10:26:18.213202 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_25.stg_product, now model.dbt_project_25.stg_productcat)
[0m10:26:18.214093 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.stg_productcat
[0m10:26:18.219722 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.stg_productcat"
[0m10:26:18.220956 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.stg_productcat
[0m10:26:18.228203 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.stg_productcat"
[0m10:26:18.229460 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_productcat"
[0m10:26:18.230355 [debug] [Thread-1 (]: On model.dbt_project_25.stg_productcat: BEGIN
[0m10:26:18.231180 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:26:18.392414 [debug] [Thread-1 (]: SQL status: BEGIN in 0.161 seconds
[0m10:26:18.394421 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_productcat"
[0m10:26:18.396306 [debug] [Thread-1 (]: On model.dbt_project_25.stg_productcat: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_productcat"} */

  
    

  create  table "BI_group4"."___staging"."stg_productcat__dbt_tmp"
  
  
    as
  
  (
    

SELECT
  productcategoryid, 
  name AS itemcategoryname
FROM "BI_group4"."corentin"."productcategory"

--run in terminal/shell: 
--dbt run --select stg_productcat

--(This will build the model as a new view/table in your dev schema, leaving the original data untouched)
  );
  
[0m10:26:18.410927 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.013 seconds
[0m10:26:18.421775 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_productcat"
[0m10:26:18.423091 [debug] [Thread-1 (]: On model.dbt_project_25.stg_productcat: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_productcat"} */
alter table "BI_group4"."___staging"."stg_productcat" rename to "stg_productcat__dbt_backup"
[0m10:26:18.434131 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m10:26:18.444025 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_productcat"
[0m10:26:18.444913 [debug] [Thread-1 (]: On model.dbt_project_25.stg_productcat: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_productcat"} */
alter table "BI_group4"."___staging"."stg_productcat__dbt_tmp" rename to "stg_productcat"
[0m10:26:18.455966 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m10:26:18.461705 [debug] [Thread-1 (]: On model.dbt_project_25.stg_productcat: COMMIT
[0m10:26:18.463018 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_productcat"
[0m10:26:18.463867 [debug] [Thread-1 (]: On model.dbt_project_25.stg_productcat: COMMIT
[0m10:26:18.476428 [debug] [Thread-1 (]: SQL status: COMMIT in 0.011 seconds
[0m10:26:18.484769 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."___staging"."stg_productcat__dbt_backup"
[0m10:26:18.486749 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_productcat"
[0m10:26:18.487735 [debug] [Thread-1 (]: On model.dbt_project_25.stg_productcat: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_productcat"} */
drop table if exists "BI_group4"."___staging"."stg_productcat__dbt_backup" cascade
[0m10:26:18.503175 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.014 seconds
[0m10:26:18.508461 [debug] [Thread-1 (]: On model.dbt_project_25.stg_productcat: Close
[0m10:26:18.511008 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '264058a6-07ba-4db9-8a10-8229571a3b5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711abadda600>]}
[0m10:26:18.513533 [info ] [Thread-1 (]: 8 of 11 OK created sql table model ___staging.stg_productcat ................... [[32mSELECT 4[0m in 0.30s]
[0m10:26:18.514800 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.stg_productcat
[0m10:26:18.515732 [debug] [Thread-1 (]: Began running node model.dbt_project_25.stg_stateprovince
[0m10:26:18.516932 [info ] [Thread-1 (]: 9 of 11 START sql table model ___staging.stg_stateprovince ..................... [RUN]
[0m10:26:18.517937 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_25.stg_productcat, now model.dbt_project_25.stg_stateprovince)
[0m10:26:18.518835 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.stg_stateprovince
[0m10:26:18.524454 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.stg_stateprovince"
[0m10:26:18.525686 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.stg_stateprovince
[0m10:26:18.535729 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.stg_stateprovince"
[0m10:26:18.537041 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_stateprovince"
[0m10:26:18.537926 [debug] [Thread-1 (]: On model.dbt_project_25.stg_stateprovince: BEGIN
[0m10:26:18.538742 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:26:18.708739 [debug] [Thread-1 (]: SQL status: BEGIN in 0.170 seconds
[0m10:26:18.710531 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_stateprovince"
[0m10:26:18.712252 [debug] [Thread-1 (]: On model.dbt_project_25.stg_stateprovince: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_stateprovince"} */

  
    

  create  table "BI_group4"."___staging"."stg_stateprovince__dbt_tmp"
  
  
    as
  
  (
    

SELECT
  stateprovinceid, 
  countryregioncode,
  territoryid,
  name AS regionname,
  stateprovincecode
FROM "BI_group4"."corentin"."stateprovince"

--run in terminal/shell: 
--dbt run --select stg_stateprovince

--(This will build the model as a new view/table in your dev schema, leaving the original data untouched)
  );
  
[0m10:26:18.726784 [debug] [Thread-1 (]: SQL status: SELECT 181 in 0.013 seconds
[0m10:26:18.737107 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_stateprovince"
[0m10:26:18.738004 [debug] [Thread-1 (]: On model.dbt_project_25.stg_stateprovince: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_stateprovince"} */
alter table "BI_group4"."___staging"."stg_stateprovince" rename to "stg_stateprovince__dbt_backup"
[0m10:26:18.749196 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m10:26:18.755027 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_stateprovince"
[0m10:26:18.755914 [debug] [Thread-1 (]: On model.dbt_project_25.stg_stateprovince: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_stateprovince"} */
alter table "BI_group4"."___staging"."stg_stateprovince__dbt_tmp" rename to "stg_stateprovince"
[0m10:26:18.766973 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m10:26:18.774131 [debug] [Thread-1 (]: On model.dbt_project_25.stg_stateprovince: COMMIT
[0m10:26:18.775245 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_stateprovince"
[0m10:26:18.776136 [debug] [Thread-1 (]: On model.dbt_project_25.stg_stateprovince: COMMIT
[0m10:26:18.788833 [debug] [Thread-1 (]: SQL status: COMMIT in 0.012 seconds
[0m10:26:18.797096 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."___staging"."stg_stateprovince__dbt_backup"
[0m10:26:18.799401 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_stateprovince"
[0m10:26:18.800473 [debug] [Thread-1 (]: On model.dbt_project_25.stg_stateprovince: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_stateprovince"} */
drop table if exists "BI_group4"."___staging"."stg_stateprovince__dbt_backup" cascade
[0m10:26:18.815579 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.014 seconds
[0m10:26:18.820837 [debug] [Thread-1 (]: On model.dbt_project_25.stg_stateprovince: Close
[0m10:26:18.823358 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '264058a6-07ba-4db9-8a10-8229571a3b5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711abac5d280>]}
[0m10:26:18.825561 [info ] [Thread-1 (]: 9 of 11 OK created sql table model ___staging.stg_stateprovince ................ [[32mSELECT 181[0m in 0.31s]
[0m10:26:18.826840 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.stg_stateprovince
[0m10:26:18.827771 [debug] [Thread-1 (]: Began running node model.dbt_project_25.storeclean
[0m10:26:18.828973 [info ] [Thread-1 (]: 10 of 11 START sql table model ___staging.storeclean ........................... [RUN]
[0m10:26:18.829972 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_25.stg_stateprovince, now model.dbt_project_25.storeclean)
[0m10:26:18.830850 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.storeclean
[0m10:26:18.836423 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.storeclean"
[0m10:26:18.837662 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.storeclean
[0m10:26:18.844656 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.storeclean"
[0m10:26:18.845929 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.storeclean"
[0m10:26:18.846822 [debug] [Thread-1 (]: On model.dbt_project_25.storeclean: BEGIN
[0m10:26:18.847651 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:26:19.013786 [debug] [Thread-1 (]: SQL status: BEGIN in 0.166 seconds
[0m10:26:19.015755 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.storeclean"
[0m10:26:19.017571 [debug] [Thread-1 (]: On model.dbt_project_25.storeclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.storeclean"} */

  
    

  create  table "BI_group4"."___staging"."storeclean__dbt_tmp"
  
  
    as
  
  (
    

select
    salespersonid as salerid,
    storename,
    businessentityid
from "BI_group4"."corentin"."store1"
  );
  
[0m10:26:19.034839 [debug] [Thread-1 (]: SQL status: SELECT 701 in 0.015 seconds
[0m10:26:19.047072 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.storeclean"
[0m10:26:19.047964 [debug] [Thread-1 (]: On model.dbt_project_25.storeclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.storeclean"} */
alter table "BI_group4"."___staging"."storeclean" rename to "storeclean__dbt_backup"
[0m10:26:19.059331 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m10:26:19.068398 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.storeclean"
[0m10:26:19.069281 [debug] [Thread-1 (]: On model.dbt_project_25.storeclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.storeclean"} */
alter table "BI_group4"."___staging"."storeclean__dbt_tmp" rename to "storeclean"
[0m10:26:19.082549 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.012 seconds
[0m10:26:19.087769 [debug] [Thread-1 (]: On model.dbt_project_25.storeclean: COMMIT
[0m10:26:19.088831 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.storeclean"
[0m10:26:19.089832 [debug] [Thread-1 (]: On model.dbt_project_25.storeclean: COMMIT
[0m10:26:19.102450 [debug] [Thread-1 (]: SQL status: COMMIT in 0.011 seconds
[0m10:26:19.108331 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."___staging"."storeclean__dbt_backup"
[0m10:26:19.110195 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.storeclean"
[0m10:26:19.111140 [debug] [Thread-1 (]: On model.dbt_project_25.storeclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.storeclean"} */
drop table if exists "BI_group4"."___staging"."storeclean__dbt_backup" cascade
[0m10:26:19.126193 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.014 seconds
[0m10:26:19.131456 [debug] [Thread-1 (]: On model.dbt_project_25.storeclean: Close
[0m10:26:19.134019 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '264058a6-07ba-4db9-8a10-8229571a3b5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711abadb63c0>]}
[0m10:26:19.136704 [info ] [Thread-1 (]: 10 of 11 OK created sql table model ___staging.storeclean ...................... [[32mSELECT 701[0m in 0.30s]
[0m10:26:19.138073 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.storeclean
[0m10:26:19.139008 [debug] [Thread-1 (]: Began running node model.dbt_project_25.my_second_dbt_model
[0m10:26:19.140208 [info ] [Thread-1 (]: 11 of 11 START sql view model _.my_second_dbt_model ............................ [RUN]
[0m10:26:19.141213 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_25.storeclean, now model.dbt_project_25.my_second_dbt_model)
[0m10:26:19.142115 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.my_second_dbt_model
[0m10:26:19.147026 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.my_second_dbt_model"
[0m10:26:19.148253 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.my_second_dbt_model
[0m10:26:19.185108 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.my_second_dbt_model"
[0m10:26:19.186464 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_second_dbt_model"
[0m10:26:19.187365 [debug] [Thread-1 (]: On model.dbt_project_25.my_second_dbt_model: BEGIN
[0m10:26:19.188176 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:26:19.371312 [debug] [Thread-1 (]: SQL status: BEGIN in 0.183 seconds
[0m10:26:19.373275 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_second_dbt_model"
[0m10:26:19.375098 [debug] [Thread-1 (]: On model.dbt_project_25.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.my_second_dbt_model"} */

  create view "BI_group4"."_"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "BI_group4"."_"."my_first_dbt_model"
where id = 1
  );
[0m10:26:19.389138 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m10:26:19.399743 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_second_dbt_model"
[0m10:26:19.400638 [debug] [Thread-1 (]: On model.dbt_project_25.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.my_second_dbt_model"} */
alter table "BI_group4"."_"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m10:26:19.411658 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m10:26:19.416733 [debug] [Thread-1 (]: On model.dbt_project_25.my_second_dbt_model: COMMIT
[0m10:26:19.418213 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_second_dbt_model"
[0m10:26:19.419600 [debug] [Thread-1 (]: On model.dbt_project_25.my_second_dbt_model: COMMIT
[0m10:26:19.432161 [debug] [Thread-1 (]: SQL status: COMMIT in 0.011 seconds
[0m10:26:19.440408 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."_"."my_second_dbt_model__dbt_backup"
[0m10:26:19.447466 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_second_dbt_model"
[0m10:26:19.448485 [debug] [Thread-1 (]: On model.dbt_project_25.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.my_second_dbt_model"} */
drop view if exists "BI_group4"."_"."my_second_dbt_model__dbt_backup" cascade
[0m10:26:19.459868 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.010 seconds
[0m10:26:19.465242 [debug] [Thread-1 (]: On model.dbt_project_25.my_second_dbt_model: Close
[0m10:26:19.467831 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '264058a6-07ba-4db9-8a10-8229571a3b5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711abac0c9e0>]}
[0m10:26:19.469778 [info ] [Thread-1 (]: 11 of 11 OK created sql view model _.my_second_dbt_model ....................... [[32mCREATE VIEW[0m in 0.33s]
[0m10:26:19.471042 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.my_second_dbt_model
[0m10:26:19.474619 [debug] [MainThread]: Using postgres connection "master"
[0m10:26:19.476284 [debug] [MainThread]: On master: BEGIN
[0m10:26:19.477831 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:26:19.640968 [debug] [MainThread]: SQL status: BEGIN in 0.163 seconds
[0m10:26:19.642790 [debug] [MainThread]: On master: COMMIT
[0m10:26:19.644395 [debug] [MainThread]: Using postgres connection "master"
[0m10:26:19.645942 [debug] [MainThread]: On master: COMMIT
[0m10:26:19.657390 [debug] [MainThread]: SQL status: COMMIT in 0.010 seconds
[0m10:26:19.658439 [debug] [MainThread]: On master: Close
[0m10:26:19.659611 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:26:19.660395 [debug] [MainThread]: Connection 'model.dbt_project_25.my_second_dbt_model' was properly closed.
[0m10:26:19.661394 [info ] [MainThread]: 
[0m10:26:19.662331 [info ] [MainThread]: Finished running 10 table models, 1 view model in 0 hours 0 minutes and 5.01 seconds (5.01s).
[0m10:26:19.666662 [debug] [MainThread]: Command end result
[0m10:26:19.714985 [debug] [MainThread]: Wrote artifact WritableManifest to /home/corentin.vanlandeghe@Digital-Grenoble.local/BI_DBT/target/manifest.json
[0m10:26:19.718182 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/corentin.vanlandeghe@Digital-Grenoble.local/BI_DBT/target/semantic_manifest.json
[0m10:26:19.729446 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/corentin.vanlandeghe@Digital-Grenoble.local/BI_DBT/target/run_results.json
[0m10:26:19.730229 [info ] [MainThread]: 
[0m10:26:19.731078 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:26:19.731864 [info ] [MainThread]: 
[0m10:26:19.732684 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=11
[0m10:26:19.734416 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.0378437, "process_in_blocks": "0", "process_kernel_time": 0.5233, "process_mem_max_rss": "128888", "process_out_blocks": "3896", "process_user_time": 5.953422}
[0m10:26:19.735425 [debug] [MainThread]: Command `dbt run` succeeded at 10:26:19.735239 after 7.04 seconds
[0m10:26:19.736262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711abf538bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711abf503410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711abcb76d80>]}
[0m10:26:19.737119 [debug] [MainThread]: Flushing usage events
[0m10:26:20.242646 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:40:38.271204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7df3e65f0200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7df3e8b0e9c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7df3e65b9c40>]}


============================== 10:40:38.276965 | e0132c10-12ac-4768-ba24-1548ea52050f ==============================
[0m10:40:38.276965 [info ] [MainThread]: Running with dbt=1.10.2
[0m10:40:38.278136 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/corentin.vanlandeghe@Digital-Grenoble.local/.dbt', 'log_path': '/home/corentin.vanlandeghe@Digital-Grenoble.local/BI_DBT/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:40:38.602003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e0132c10-12ac-4768-ba24-1548ea52050f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7df3e5d12b10>]}
[0m10:40:38.727948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e0132c10-12ac-4768-ba24-1548ea52050f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7df3e8592510>]}
[0m10:40:38.729428 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:40:38.910899 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m10:40:39.142820 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m10:40:39.143964 [debug] [MainThread]: Partial parsing: added file: dbt_project_25://models/staging/personclean.sql
[0m10:40:39.145805 [debug] [MainThread]: Partial parsing: updated file: dbt_project_25://models/staging/schema.yml
[0m10:40:39.925111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e0132c10-12ac-4768-ba24-1548ea52050f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7df3e5dcf410>]}
[0m10:40:40.076433 [debug] [MainThread]: Wrote artifact WritableManifest to /home/corentin.vanlandeghe@Digital-Grenoble.local/BI_DBT/target/manifest.json
[0m10:40:40.079458 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/corentin.vanlandeghe@Digital-Grenoble.local/BI_DBT/target/semantic_manifest.json
[0m10:40:40.103108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e0132c10-12ac-4768-ba24-1548ea52050f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7df3e4ffdb80>]}
[0m10:40:40.104095 [info ] [MainThread]: Found 12 models, 4 data tests, 10 sources, 549 macros
[0m10:40:40.104924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0132c10-12ac-4768-ba24-1548ea52050f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7df3e3b48470>]}
[0m10:40:40.109062 [info ] [MainThread]: 
[0m10:40:40.109903 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:40:40.110661 [info ] [MainThread]: 
[0m10:40:40.111706 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:40:40.120443 [debug] [ThreadPool]: Acquiring new postgres connection 'list_BI_group4'
[0m10:40:40.281665 [debug] [ThreadPool]: Using postgres connection "list_BI_group4"
[0m10:40:40.282568 [debug] [ThreadPool]: On list_BI_group4: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "connection_name": "list_BI_group4"} */

    select distinct nspname from pg_namespace
  
[0m10:40:40.283305 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:40:40.638907 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.355 seconds
[0m10:40:40.644197 [debug] [ThreadPool]: On list_BI_group4: Close
[0m10:40:40.651356 [debug] [ThreadPool]: Using postgres connection "list_BI_group4"
[0m10:40:40.652596 [debug] [ThreadPool]: On list_BI_group4: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "connection_name": "list_BI_group4"} */

    select distinct nspname from pg_namespace
  
[0m10:40:40.653717 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:40:40.876423 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.223 seconds
[0m10:40:40.881681 [debug] [ThreadPool]: On list_BI_group4: Close
[0m10:40:40.888358 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_BI_group4, now list_BI_group4____staging)
[0m10:40:40.899685 [debug] [ThreadPool]: Using postgres connection "list_BI_group4____staging"
[0m10:40:40.900470 [debug] [ThreadPool]: On list_BI_group4____staging: BEGIN
[0m10:40:40.901246 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:40:41.059878 [debug] [ThreadPool]: SQL status: BEGIN in 0.158 seconds
[0m10:40:41.061591 [debug] [ThreadPool]: Using postgres connection "list_BI_group4____staging"
[0m10:40:41.063234 [debug] [ThreadPool]: On list_BI_group4____staging: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "connection_name": "list_BI_group4____staging"} */
select
      'BI_group4' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike '___staging'
    union all
    select
      'BI_group4' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike '___staging'
    union all
    select
      'BI_group4' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike '___staging'
  
[0m10:40:41.078158 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.013 seconds
[0m10:40:41.083877 [debug] [ThreadPool]: On list_BI_group4____staging: ROLLBACK
[0m10:40:41.095007 [debug] [ThreadPool]: On list_BI_group4____staging: Close
[0m10:40:41.096280 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_BI_group4____staging, now list_BI_group4__)
[0m10:40:41.106849 [debug] [ThreadPool]: Using postgres connection "list_BI_group4__"
[0m10:40:41.108657 [debug] [ThreadPool]: On list_BI_group4__: BEGIN
[0m10:40:41.109400 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:40:41.263229 [debug] [ThreadPool]: SQL status: BEGIN in 0.154 seconds
[0m10:40:41.264987 [debug] [ThreadPool]: Using postgres connection "list_BI_group4__"
[0m10:40:41.266647 [debug] [ThreadPool]: On list_BI_group4__: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "connection_name": "list_BI_group4__"} */
select
      'BI_group4' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike '_'
    union all
    select
      'BI_group4' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike '_'
    union all
    select
      'BI_group4' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike '_'
  
[0m10:40:41.280976 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.013 seconds
[0m10:40:41.286102 [debug] [ThreadPool]: On list_BI_group4__: ROLLBACK
[0m10:40:41.296694 [debug] [ThreadPool]: On list_BI_group4__: Close
[0m10:40:41.311837 [debug] [MainThread]: Using postgres connection "master"
[0m10:40:41.312634 [debug] [MainThread]: On master: BEGIN
[0m10:40:41.313341 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:40:41.471284 [debug] [MainThread]: SQL status: BEGIN in 0.158 seconds
[0m10:40:41.472961 [debug] [MainThread]: Using postgres connection "master"
[0m10:40:41.649963 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:40:41.689594 [debug] [MainThread]: SQL status: SELECT 3 in 0.037 seconds
[0m10:40:41.695606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0132c10-12ac-4768-ba24-1548ea52050f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7df3e3b88920>]}
[0m10:40:41.697611 [debug] [MainThread]: On master: ROLLBACK
[0m10:40:41.708729 [debug] [MainThread]: Using postgres connection "master"
[0m10:40:41.709550 [debug] [MainThread]: On master: BEGIN
[0m10:40:41.731272 [debug] [MainThread]: SQL status: BEGIN in 0.021 seconds
[0m10:40:41.732919 [debug] [MainThread]: On master: COMMIT
[0m10:40:41.734527 [debug] [MainThread]: Using postgres connection "master"
[0m10:40:41.736053 [debug] [MainThread]: On master: COMMIT
[0m10:40:41.747294 [debug] [MainThread]: SQL status: COMMIT in 0.010 seconds
[0m10:40:41.748280 [debug] [MainThread]: On master: Close
[0m10:40:41.753938 [debug] [Thread-1 (]: Began running node model.dbt_project_25.customerclean
[0m10:40:41.756243 [info ] [Thread-1 (]: 1 of 12 START sql table model ___staging.customerclean ......................... [RUN]
[0m10:40:41.758301 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_BI_group4__, now model.dbt_project_25.customerclean)
[0m10:40:41.760118 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.customerclean
[0m10:40:41.775941 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.customerclean"
[0m10:40:41.777290 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.customerclean
[0m10:40:41.850263 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.customerclean"
[0m10:40:41.851667 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.customerclean"
[0m10:40:41.852552 [debug] [Thread-1 (]: On model.dbt_project_25.customerclean: BEGIN
[0m10:40:41.853346 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:40:42.019550 [debug] [Thread-1 (]: SQL status: BEGIN in 0.166 seconds
[0m10:40:42.021454 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.customerclean"
[0m10:40:42.023270 [debug] [Thread-1 (]: On model.dbt_project_25.customerclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.customerclean"} */

  
    

  create  table "BI_group4"."___staging"."customerclean__dbt_tmp"
  
  
    as
  
  (
    

select
    customerid, 
	storeid,
    territoryid
from "BI_group4"."corentin"."customer"
  );
  
[0m10:40:42.068299 [debug] [Thread-1 (]: SQL status: SELECT 19820 in 0.043 seconds
[0m10:40:42.092847 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.customerclean"
[0m10:40:42.093767 [debug] [Thread-1 (]: On model.dbt_project_25.customerclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.customerclean"} */
alter table "BI_group4"."___staging"."customerclean" rename to "customerclean__dbt_backup"
[0m10:40:42.105492 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.011 seconds
[0m10:40:42.114951 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.customerclean"
[0m10:40:42.115847 [debug] [Thread-1 (]: On model.dbt_project_25.customerclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.customerclean"} */
alter table "BI_group4"."___staging"."customerclean__dbt_tmp" rename to "customerclean"
[0m10:40:42.126790 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m10:40:42.159700 [debug] [Thread-1 (]: On model.dbt_project_25.customerclean: COMMIT
[0m10:40:42.160658 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.customerclean"
[0m10:40:42.161512 [debug] [Thread-1 (]: On model.dbt_project_25.customerclean: COMMIT
[0m10:40:42.184163 [debug] [Thread-1 (]: SQL status: COMMIT in 0.022 seconds
[0m10:40:42.200732 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."___staging"."customerclean__dbt_backup"
[0m10:40:42.210785 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.customerclean"
[0m10:40:42.211710 [debug] [Thread-1 (]: On model.dbt_project_25.customerclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.customerclean"} */
drop table if exists "BI_group4"."___staging"."customerclean__dbt_backup" cascade
[0m10:40:42.232763 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.020 seconds
[0m10:40:42.241762 [debug] [Thread-1 (]: On model.dbt_project_25.customerclean: Close
[0m10:40:42.246030 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0132c10-12ac-4768-ba24-1548ea52050f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7df3e3f82de0>]}
[0m10:40:42.247384 [info ] [Thread-1 (]: 1 of 12 OK created sql table model ___staging.customerclean .................... [[32mSELECT 19820[0m in 0.49s]
[0m10:40:42.248718 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.customerclean
[0m10:40:42.249671 [debug] [Thread-1 (]: Began running node model.dbt_project_25.dateclean
[0m10:40:42.250957 [info ] [Thread-1 (]: 2 of 12 START sql table model ___staging.dateclean ............................. [RUN]
[0m10:40:42.251980 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_25.customerclean, now model.dbt_project_25.dateclean)
[0m10:40:42.252873 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.dateclean
[0m10:40:42.258416 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.dateclean"
[0m10:40:42.259660 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.dateclean
[0m10:40:42.267075 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.dateclean"
[0m10:40:42.268339 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.dateclean"
[0m10:40:42.269207 [debug] [Thread-1 (]: On model.dbt_project_25.dateclean: BEGIN
[0m10:40:42.270023 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:40:42.433428 [debug] [Thread-1 (]: SQL status: BEGIN in 0.163 seconds
[0m10:40:42.435188 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.dateclean"
[0m10:40:42.437013 [debug] [Thread-1 (]: On model.dbt_project_25.dateclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.dateclean"} */

  
    

  create  table "BI_group4"."___staging"."dateclean__dbt_tmp"
  
  
    as
  
  (
    

select
    date_day,
    day_of_week as number_day_week,
    day_of_week_name as day_name
    
from "BI_group4"."corentin"."date"
  );
  
[0m10:40:42.453858 [debug] [Thread-1 (]: SQL status: SELECT 731 in 0.015 seconds
[0m10:40:42.466065 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.dateclean"
[0m10:40:42.466962 [debug] [Thread-1 (]: On model.dbt_project_25.dateclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.dateclean"} */
alter table "BI_group4"."___staging"."dateclean" rename to "dateclean__dbt_backup"
[0m10:40:42.478359 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m10:40:42.486641 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.dateclean"
[0m10:40:42.487532 [debug] [Thread-1 (]: On model.dbt_project_25.dateclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.dateclean"} */
alter table "BI_group4"."___staging"."dateclean__dbt_tmp" rename to "dateclean"
[0m10:40:42.499196 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.011 seconds
[0m10:40:42.504976 [debug] [Thread-1 (]: On model.dbt_project_25.dateclean: COMMIT
[0m10:40:42.506025 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.dateclean"
[0m10:40:42.506853 [debug] [Thread-1 (]: On model.dbt_project_25.dateclean: COMMIT
[0m10:40:42.572915 [debug] [Thread-1 (]: SQL status: COMMIT in 0.065 seconds
[0m10:40:42.582459 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."___staging"."dateclean__dbt_backup"
[0m10:40:42.588054 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.dateclean"
[0m10:40:42.588961 [debug] [Thread-1 (]: On model.dbt_project_25.dateclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.dateclean"} */
drop table if exists "BI_group4"."___staging"."dateclean__dbt_backup" cascade
[0m10:40:42.607933 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.018 seconds
[0m10:40:42.613224 [debug] [Thread-1 (]: On model.dbt_project_25.dateclean: Close
[0m10:40:42.615744 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0132c10-12ac-4768-ba24-1548ea52050f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7df3e1f956a0>]}
[0m10:40:42.617066 [info ] [Thread-1 (]: 2 of 12 OK created sql table model ___staging.dateclean ........................ [[32mSELECT 731[0m in 0.36s]
[0m10:40:42.618341 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.dateclean
[0m10:40:42.619274 [debug] [Thread-1 (]: Began running node model.dbt_project_25.my_first_dbt_model
[0m10:40:42.620535 [info ] [Thread-1 (]: 3 of 12 START sql table model _.my_first_dbt_model ............................. [RUN]
[0m10:40:42.621534 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_25.dateclean, now model.dbt_project_25.my_first_dbt_model)
[0m10:40:42.622418 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.my_first_dbt_model
[0m10:40:42.627461 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.my_first_dbt_model"
[0m10:40:42.628731 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.my_first_dbt_model
[0m10:40:42.635650 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.my_first_dbt_model"
[0m10:40:42.636922 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_first_dbt_model"
[0m10:40:42.637811 [debug] [Thread-1 (]: On model.dbt_project_25.my_first_dbt_model: BEGIN
[0m10:40:42.638635 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:40:42.803241 [debug] [Thread-1 (]: SQL status: BEGIN in 0.164 seconds
[0m10:40:42.805209 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_first_dbt_model"
[0m10:40:42.807080 [debug] [Thread-1 (]: On model.dbt_project_25.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.my_first_dbt_model"} */

  
    

  create  table "BI_group4"."_"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m10:40:42.821803 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.013 seconds
[0m10:40:42.832345 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_first_dbt_model"
[0m10:40:42.833510 [debug] [Thread-1 (]: On model.dbt_project_25.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.my_first_dbt_model"} */
alter table "BI_group4"."_"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m10:40:42.845180 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.011 seconds
[0m10:40:42.852029 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_first_dbt_model"
[0m10:40:42.853169 [debug] [Thread-1 (]: On model.dbt_project_25.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.my_first_dbt_model"} */
alter table "BI_group4"."_"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m10:40:42.864449 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m10:40:42.868126 [debug] [Thread-1 (]: On model.dbt_project_25.my_first_dbt_model: COMMIT
[0m10:40:42.869070 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_first_dbt_model"
[0m10:40:42.869947 [debug] [Thread-1 (]: On model.dbt_project_25.my_first_dbt_model: COMMIT
[0m10:40:42.889381 [debug] [Thread-1 (]: SQL status: COMMIT in 0.018 seconds
[0m10:40:42.898482 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."_"."my_first_dbt_model__dbt_backup"
[0m10:40:42.900254 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_first_dbt_model"
[0m10:40:42.901133 [debug] [Thread-1 (]: On model.dbt_project_25.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.my_first_dbt_model"} */
drop table if exists "BI_group4"."_"."my_first_dbt_model__dbt_backup" cascade
[0m10:40:42.918212 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.016 seconds
[0m10:40:42.923533 [debug] [Thread-1 (]: On model.dbt_project_25.my_first_dbt_model: Close
[0m10:40:42.926025 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0132c10-12ac-4768-ba24-1548ea52050f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7df3e4351d90>]}
[0m10:40:42.928276 [info ] [Thread-1 (]: 3 of 12 OK created sql table model _.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.30s]
[0m10:40:42.929590 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.my_first_dbt_model
[0m10:40:42.930525 [debug] [Thread-1 (]: Began running node model.dbt_project_25.personclean
[0m10:40:42.931813 [info ] [Thread-1 (]: 4 of 12 START sql table model ___staging.personclean ........................... [RUN]
[0m10:40:42.933077 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_25.my_first_dbt_model, now model.dbt_project_25.personclean)
[0m10:40:42.933990 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.personclean
[0m10:40:42.939420 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.personclean"
[0m10:40:42.940592 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.personclean
[0m10:40:42.947656 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.personclean"
[0m10:40:42.948869 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.personclean"
[0m10:40:42.949736 [debug] [Thread-1 (]: On model.dbt_project_25.personclean: BEGIN
[0m10:40:42.950556 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:40:43.116188 [debug] [Thread-1 (]: SQL status: BEGIN in 0.165 seconds
[0m10:40:43.118162 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.personclean"
[0m10:40:43.119975 [debug] [Thread-1 (]: On model.dbt_project_25.personclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.personclean"} */

  
    

  create  table "BI_group4"."___staging"."personclean__dbt_tmp"
  
  
    as
  
  (
    

select
    businessentityid,
    firstname,
    lastname

from "BI_group4"."corentin"."person"
  );
  
[0m10:40:43.139253 [debug] [Thread-1 (]: SQL status: SELECT 2057 in 0.017 seconds
[0m10:40:43.150784 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.personclean"
[0m10:40:43.151675 [debug] [Thread-1 (]: On model.dbt_project_25.personclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.personclean"} */
alter table "BI_group4"."___staging"."personclean__dbt_tmp" rename to "personclean"
[0m10:40:43.163229 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m10:40:43.167873 [debug] [Thread-1 (]: On model.dbt_project_25.personclean: COMMIT
[0m10:40:43.169174 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.personclean"
[0m10:40:43.170027 [debug] [Thread-1 (]: On model.dbt_project_25.personclean: COMMIT
[0m10:40:43.183815 [debug] [Thread-1 (]: SQL status: COMMIT in 0.013 seconds
[0m10:40:43.189690 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."___staging"."personclean__dbt_backup"
[0m10:40:43.191423 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.personclean"
[0m10:40:43.192291 [debug] [Thread-1 (]: On model.dbt_project_25.personclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.personclean"} */
drop table if exists "BI_group4"."___staging"."personclean__dbt_backup" cascade
[0m10:40:43.203266 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.010 seconds
[0m10:40:43.207180 [debug] [Thread-1 (]: On model.dbt_project_25.personclean: Close
[0m10:40:43.209049 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0132c10-12ac-4768-ba24-1548ea52050f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7df3e1fb3f50>]}
[0m10:40:43.210759 [info ] [Thread-1 (]: 4 of 12 OK created sql table model ___staging.personclean ...................... [[32mSELECT 2057[0m in 0.28s]
[0m10:40:43.212034 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.personclean
[0m10:40:43.213000 [debug] [Thread-1 (]: Began running node model.dbt_project_25.productsubcategoryclean
[0m10:40:43.214227 [info ] [Thread-1 (]: 5 of 12 START sql table model ___staging.productsubcategoryclean ............... [RUN]
[0m10:40:43.215232 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_25.personclean, now model.dbt_project_25.productsubcategoryclean)
[0m10:40:43.216130 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.productsubcategoryclean
[0m10:40:43.224171 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.productsubcategoryclean"
[0m10:40:43.225423 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.productsubcategoryclean
[0m10:40:43.232646 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.productsubcategoryclean"
[0m10:40:43.233947 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.productsubcategoryclean"
[0m10:40:43.234852 [debug] [Thread-1 (]: On model.dbt_project_25.productsubcategoryclean: BEGIN
[0m10:40:43.235677 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:40:43.404047 [debug] [Thread-1 (]: SQL status: BEGIN in 0.168 seconds
[0m10:40:43.406050 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.productsubcategoryclean"
[0m10:40:43.407890 [debug] [Thread-1 (]: On model.dbt_project_25.productsubcategoryclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.productsubcategoryclean"} */

  
    

  create  table "BI_group4"."___staging"."productsubcategoryclean__dbt_tmp"
  
  
    as
  
  (
    

select
    productsubcategoryid, 
	productcategoryid,
    name as subcategoryname
from "BI_group4"."corentin"."productsubcategory"
  );
  
[0m10:40:43.422694 [debug] [Thread-1 (]: SQL status: SELECT 37 in 0.013 seconds
[0m10:40:43.433518 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.productsubcategoryclean"
[0m10:40:43.434415 [debug] [Thread-1 (]: On model.dbt_project_25.productsubcategoryclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.productsubcategoryclean"} */
alter table "BI_group4"."___staging"."productsubcategoryclean" rename to "productsubcategoryclean__dbt_backup"
[0m10:40:43.446455 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.011 seconds
[0m10:40:43.453547 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.productsubcategoryclean"
[0m10:40:43.454429 [debug] [Thread-1 (]: On model.dbt_project_25.productsubcategoryclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.productsubcategoryclean"} */
alter table "BI_group4"."___staging"."productsubcategoryclean__dbt_tmp" rename to "productsubcategoryclean"
[0m10:40:43.466570 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.011 seconds
[0m10:40:43.471772 [debug] [Thread-1 (]: On model.dbt_project_25.productsubcategoryclean: COMMIT
[0m10:40:43.472818 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.productsubcategoryclean"
[0m10:40:43.473699 [debug] [Thread-1 (]: On model.dbt_project_25.productsubcategoryclean: COMMIT
[0m10:40:43.486763 [debug] [Thread-1 (]: SQL status: COMMIT in 0.012 seconds
[0m10:40:43.491330 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."___staging"."productsubcategoryclean__dbt_backup"
[0m10:40:43.493107 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.productsubcategoryclean"
[0m10:40:43.494005 [debug] [Thread-1 (]: On model.dbt_project_25.productsubcategoryclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.productsubcategoryclean"} */
drop table if exists "BI_group4"."___staging"."productsubcategoryclean__dbt_backup" cascade
[0m10:40:43.510724 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.016 seconds
[0m10:40:43.515925 [debug] [Thread-1 (]: On model.dbt_project_25.productsubcategoryclean: Close
[0m10:40:43.518409 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0132c10-12ac-4768-ba24-1548ea52050f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7df3e1f5adb0>]}
[0m10:40:43.521103 [info ] [Thread-1 (]: 5 of 12 OK created sql table model ___staging.productsubcategoryclean .......... [[32mSELECT 37[0m in 0.30s]
[0m10:40:43.522373 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.productsubcategoryclean
[0m10:40:43.523320 [debug] [Thread-1 (]: Began running node model.dbt_project_25.salesorderdetailsclean
[0m10:40:43.524555 [info ] [Thread-1 (]: 6 of 12 START sql table model ___staging.salesorderdetailsclean ................ [RUN]
[0m10:40:43.525561 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_25.productsubcategoryclean, now model.dbt_project_25.salesorderdetailsclean)
[0m10:40:43.526447 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.salesorderdetailsclean
[0m10:40:43.532017 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.salesorderdetailsclean"
[0m10:40:43.533252 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.salesorderdetailsclean
[0m10:40:43.540630 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.salesorderdetailsclean"
[0m10:40:43.541913 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderdetailsclean"
[0m10:40:43.542802 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderdetailsclean: BEGIN
[0m10:40:43.543633 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:40:43.701065 [debug] [Thread-1 (]: SQL status: BEGIN in 0.157 seconds
[0m10:40:43.703009 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderdetailsclean"
[0m10:40:43.704832 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderdetailsclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.salesorderdetailsclean"} */

  
    

  create  table "BI_group4"."___staging"."salesorderdetailsclean__dbt_tmp"
  
  
    as
  
  (
    

select 
	salesorderid, 
	unitprice,
	orderqty as orderquantity,
	productid,
	unitpricediscount as discount

from "BI_group4"."corentin"."salesorderdetail"
  );
  
[0m10:40:43.723691 [debug] [Thread-1 (]: SQL status: SELECT 5716 in 0.017 seconds
[0m10:40:43.734943 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderdetailsclean"
[0m10:40:43.735852 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderdetailsclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.salesorderdetailsclean"} */
alter table "BI_group4"."___staging"."salesorderdetailsclean" rename to "salesorderdetailsclean__dbt_backup"
[0m10:40:43.746747 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m10:40:43.754034 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderdetailsclean"
[0m10:40:43.754931 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderdetailsclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.salesorderdetailsclean"} */
alter table "BI_group4"."___staging"."salesorderdetailsclean__dbt_tmp" rename to "salesorderdetailsclean"
[0m10:40:43.766788 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.011 seconds
[0m10:40:43.773189 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderdetailsclean: COMMIT
[0m10:40:43.774135 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderdetailsclean"
[0m10:40:43.775035 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderdetailsclean: COMMIT
[0m10:40:43.796667 [debug] [Thread-1 (]: SQL status: COMMIT in 0.020 seconds
[0m10:40:43.804909 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."___staging"."salesorderdetailsclean__dbt_backup"
[0m10:40:43.807048 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderdetailsclean"
[0m10:40:43.808110 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderdetailsclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.salesorderdetailsclean"} */
drop table if exists "BI_group4"."___staging"."salesorderdetailsclean__dbt_backup" cascade
[0m10:40:43.823658 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.014 seconds
[0m10:40:43.828977 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderdetailsclean: Close
[0m10:40:43.831485 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0132c10-12ac-4768-ba24-1548ea52050f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7df3e1f0a4b0>]}
[0m10:40:43.833755 [info ] [Thread-1 (]: 6 of 12 OK created sql table model ___staging.salesorderdetailsclean ........... [[32mSELECT 5716[0m in 0.31s]
[0m10:40:43.835027 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.salesorderdetailsclean
[0m10:40:43.835976 [debug] [Thread-1 (]: Began running node model.dbt_project_25.salesorderheaderclean
[0m10:40:43.837191 [info ] [Thread-1 (]: 7 of 12 START sql table model ___staging.salesorderheaderclean ................. [RUN]
[0m10:40:43.838194 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_25.salesorderdetailsclean, now model.dbt_project_25.salesorderheaderclean)
[0m10:40:43.839105 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.salesorderheaderclean
[0m10:40:43.847341 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.salesorderheaderclean"
[0m10:40:43.848616 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.salesorderheaderclean
[0m10:40:43.855892 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.salesorderheaderclean"
[0m10:40:43.857183 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderheaderclean"
[0m10:40:43.858075 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderheaderclean: BEGIN
[0m10:40:43.858915 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:40:44.018761 [debug] [Thread-1 (]: SQL status: BEGIN in 0.159 seconds
[0m10:40:44.020757 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderheaderclean"
[0m10:40:44.022635 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderheaderclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.salesorderheaderclean"} */

  
    

  create  table "BI_group4"."___staging"."salesorderheaderclean__dbt_tmp"
  
  
    as
  
  (
    

select
    orderdate,
    salesorderid,
    territoryid,
    salespersonid as salerid,
    billtoaddressid,
    customerid,
    salespersonid,
    shipdate
from "BI_group4"."corentin"."salesorderheader"
  );
  
[0m10:40:44.039268 [debug] [Thread-1 (]: SQL status: SELECT 1566 in 0.015 seconds
[0m10:40:44.049736 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderheaderclean"
[0m10:40:44.050983 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderheaderclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.salesorderheaderclean"} */
alter table "BI_group4"."___staging"."salesorderheaderclean" rename to "salesorderheaderclean__dbt_backup"
[0m10:40:44.062095 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m10:40:44.068035 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderheaderclean"
[0m10:40:44.069001 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderheaderclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.salesorderheaderclean"} */
alter table "BI_group4"."___staging"."salesorderheaderclean__dbt_tmp" rename to "salesorderheaderclean"
[0m10:40:44.081433 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.011 seconds
[0m10:40:44.085737 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderheaderclean: COMMIT
[0m10:40:44.086747 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderheaderclean"
[0m10:40:44.087705 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderheaderclean: COMMIT
[0m10:40:44.109913 [debug] [Thread-1 (]: SQL status: COMMIT in 0.021 seconds
[0m10:40:44.117791 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."___staging"."salesorderheaderclean__dbt_backup"
[0m10:40:44.120284 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderheaderclean"
[0m10:40:44.121534 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderheaderclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.salesorderheaderclean"} */
drop table if exists "BI_group4"."___staging"."salesorderheaderclean__dbt_backup" cascade
[0m10:40:44.138391 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.015 seconds
[0m10:40:44.143708 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderheaderclean: Close
[0m10:40:44.145699 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0132c10-12ac-4768-ba24-1548ea52050f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7df3e57bc2c0>]}
[0m10:40:44.147206 [info ] [Thread-1 (]: 7 of 12 OK created sql table model ___staging.salesorderheaderclean ............ [[32mSELECT 1566[0m in 0.31s]
[0m10:40:44.148680 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.salesorderheaderclean
[0m10:40:44.149753 [debug] [Thread-1 (]: Began running node model.dbt_project_25.stg_product
[0m10:40:44.151149 [info ] [Thread-1 (]: 8 of 12 START sql table model ___staging.stg_product ........................... [RUN]
[0m10:40:44.152289 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_25.salesorderheaderclean, now model.dbt_project_25.stg_product)
[0m10:40:44.153304 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.stg_product
[0m10:40:44.159212 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.stg_product"
[0m10:40:44.160490 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.stg_product
[0m10:40:44.167850 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.stg_product"
[0m10:40:44.169147 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_product"
[0m10:40:44.170038 [debug] [Thread-1 (]: On model.dbt_project_25.stg_product: BEGIN
[0m10:40:44.170874 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:40:44.332695 [debug] [Thread-1 (]: SQL status: BEGIN in 0.161 seconds
[0m10:40:44.334689 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_product"
[0m10:40:44.336483 [debug] [Thread-1 (]: On model.dbt_project_25.stg_product: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_product"} */

  
    

  create  table "BI_group4"."___staging"."stg_product__dbt_tmp"
  
  
    as
  
  (
    

SELECT
  productid, 
  name AS itemname
FROM "BI_group4"."corentin"."product"

--run in terminal/shell: 
--dbt run --select stg_product

--(This will build the model as a new view/table in your dev schema, leaving the original data untouched)
  );
  
[0m10:40:44.352529 [debug] [Thread-1 (]: SQL status: SELECT 504 in 0.014 seconds
[0m10:40:44.364595 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_product"
[0m10:40:44.366223 [debug] [Thread-1 (]: On model.dbt_project_25.stg_product: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_product"} */
alter table "BI_group4"."___staging"."stg_product" rename to "stg_product__dbt_backup"
[0m10:40:44.377630 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m10:40:44.387607 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_product"
[0m10:40:44.388473 [debug] [Thread-1 (]: On model.dbt_project_25.stg_product: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_product"} */
alter table "BI_group4"."___staging"."stg_product__dbt_tmp" rename to "stg_product"
[0m10:40:44.400112 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.011 seconds
[0m10:40:44.405769 [debug] [Thread-1 (]: On model.dbt_project_25.stg_product: COMMIT
[0m10:40:44.406819 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_product"
[0m10:40:44.407646 [debug] [Thread-1 (]: On model.dbt_project_25.stg_product: COMMIT
[0m10:40:44.421559 [debug] [Thread-1 (]: SQL status: COMMIT in 0.013 seconds
[0m10:40:44.429765 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."___staging"."stg_product__dbt_backup"
[0m10:40:44.435573 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_product"
[0m10:40:44.436801 [debug] [Thread-1 (]: On model.dbt_project_25.stg_product: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_product"} */
drop table if exists "BI_group4"."___staging"."stg_product__dbt_backup" cascade
[0m10:40:44.454887 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.017 seconds
[0m10:40:44.460154 [debug] [Thread-1 (]: On model.dbt_project_25.stg_product: Close
[0m10:40:44.462637 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0132c10-12ac-4768-ba24-1548ea52050f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7df3e1fba3c0>]}
[0m10:40:44.465266 [info ] [Thread-1 (]: 8 of 12 OK created sql table model ___staging.stg_product ...................... [[32mSELECT 504[0m in 0.31s]
[0m10:40:44.467321 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.stg_product
[0m10:40:44.468249 [debug] [Thread-1 (]: Began running node model.dbt_project_25.stg_productcat
[0m10:40:44.469433 [info ] [Thread-1 (]: 9 of 12 START sql table model ___staging.stg_productcat ........................ [RUN]
[0m10:40:44.470416 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_25.stg_product, now model.dbt_project_25.stg_productcat)
[0m10:40:44.471303 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.stg_productcat
[0m10:40:44.477004 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.stg_productcat"
[0m10:40:44.478245 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.stg_productcat
[0m10:40:44.485332 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.stg_productcat"
[0m10:40:44.486621 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_productcat"
[0m10:40:44.487491 [debug] [Thread-1 (]: On model.dbt_project_25.stg_productcat: BEGIN
[0m10:40:44.488334 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:40:44.645654 [debug] [Thread-1 (]: SQL status: BEGIN in 0.157 seconds
[0m10:40:44.647652 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_productcat"
[0m10:40:44.649528 [debug] [Thread-1 (]: On model.dbt_project_25.stg_productcat: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_productcat"} */

  
    

  create  table "BI_group4"."___staging"."stg_productcat__dbt_tmp"
  
  
    as
  
  (
    

SELECT
  productcategoryid, 
  name AS itemcategoryname
FROM "BI_group4"."corentin"."productcategory"

--run in terminal/shell: 
--dbt run --select stg_productcat

--(This will build the model as a new view/table in your dev schema, leaving the original data untouched)
  );
  
[0m10:40:44.663127 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.012 seconds
[0m10:40:44.672847 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_productcat"
[0m10:40:44.673927 [debug] [Thread-1 (]: On model.dbt_project_25.stg_productcat: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_productcat"} */
alter table "BI_group4"."___staging"."stg_productcat" rename to "stg_productcat__dbt_backup"
[0m10:40:44.685215 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m10:40:44.691024 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_productcat"
[0m10:40:44.691908 [debug] [Thread-1 (]: On model.dbt_project_25.stg_productcat: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_productcat"} */
alter table "BI_group4"."___staging"."stg_productcat__dbt_tmp" rename to "stg_productcat"
[0m10:40:44.702488 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.009 seconds
[0m10:40:44.707585 [debug] [Thread-1 (]: On model.dbt_project_25.stg_productcat: COMMIT
[0m10:40:44.708813 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_productcat"
[0m10:40:44.709710 [debug] [Thread-1 (]: On model.dbt_project_25.stg_productcat: COMMIT
[0m10:40:44.727150 [debug] [Thread-1 (]: SQL status: COMMIT in 0.016 seconds
[0m10:40:44.736459 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."___staging"."stg_productcat__dbt_backup"
[0m10:40:44.739331 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_productcat"
[0m10:40:44.740203 [debug] [Thread-1 (]: On model.dbt_project_25.stg_productcat: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_productcat"} */
drop table if exists "BI_group4"."___staging"."stg_productcat__dbt_backup" cascade
[0m10:40:44.758175 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.017 seconds
[0m10:40:44.763424 [debug] [Thread-1 (]: On model.dbt_project_25.stg_productcat: Close
[0m10:40:44.765950 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0132c10-12ac-4768-ba24-1548ea52050f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7df3e1f3ad80>]}
[0m10:40:44.768671 [info ] [Thread-1 (]: 9 of 12 OK created sql table model ___staging.stg_productcat ................... [[32mSELECT 4[0m in 0.30s]
[0m10:40:44.770265 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.stg_productcat
[0m10:40:44.771207 [debug] [Thread-1 (]: Began running node model.dbt_project_25.stg_stateprovince
[0m10:40:44.772444 [info ] [Thread-1 (]: 10 of 12 START sql table model ___staging.stg_stateprovince .................... [RUN]
[0m10:40:44.773455 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_25.stg_productcat, now model.dbt_project_25.stg_stateprovince)
[0m10:40:44.774360 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.stg_stateprovince
[0m10:40:44.779945 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.stg_stateprovince"
[0m10:40:44.781172 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.stg_stateprovince
[0m10:40:44.788221 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.stg_stateprovince"
[0m10:40:44.789486 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_stateprovince"
[0m10:40:44.790368 [debug] [Thread-1 (]: On model.dbt_project_25.stg_stateprovince: BEGIN
[0m10:40:44.791194 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:40:44.954106 [debug] [Thread-1 (]: SQL status: BEGIN in 0.163 seconds
[0m10:40:44.956095 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_stateprovince"
[0m10:40:44.957964 [debug] [Thread-1 (]: On model.dbt_project_25.stg_stateprovince: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_stateprovince"} */

  
    

  create  table "BI_group4"."___staging"."stg_stateprovince__dbt_tmp"
  
  
    as
  
  (
    

SELECT
  stateprovinceid, 
  countryregioncode,
  territoryid,
  name AS regionname,
  stateprovincecode
FROM "BI_group4"."corentin"."stateprovince"

--run in terminal/shell: 
--dbt run --select stg_stateprovince

--(This will build the model as a new view/table in your dev schema, leaving the original data untouched)
  );
  
[0m10:40:44.972061 [debug] [Thread-1 (]: SQL status: SELECT 181 in 0.012 seconds
[0m10:40:44.982792 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_stateprovince"
[0m10:40:44.983710 [debug] [Thread-1 (]: On model.dbt_project_25.stg_stateprovince: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_stateprovince"} */
alter table "BI_group4"."___staging"."stg_stateprovince" rename to "stg_stateprovince__dbt_backup"
[0m10:40:44.995148 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m10:40:45.000852 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_stateprovince"
[0m10:40:45.001739 [debug] [Thread-1 (]: On model.dbt_project_25.stg_stateprovince: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_stateprovince"} */
alter table "BI_group4"."___staging"."stg_stateprovince__dbt_tmp" rename to "stg_stateprovince"
[0m10:40:45.012731 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m10:40:45.019831 [debug] [Thread-1 (]: On model.dbt_project_25.stg_stateprovince: COMMIT
[0m10:40:45.020879 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_stateprovince"
[0m10:40:45.021714 [debug] [Thread-1 (]: On model.dbt_project_25.stg_stateprovince: COMMIT
[0m10:40:45.034111 [debug] [Thread-1 (]: SQL status: COMMIT in 0.012 seconds
[0m10:40:45.041225 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."___staging"."stg_stateprovince__dbt_backup"
[0m10:40:45.042991 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_stateprovince"
[0m10:40:45.043876 [debug] [Thread-1 (]: On model.dbt_project_25.stg_stateprovince: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_stateprovince"} */
drop table if exists "BI_group4"."___staging"."stg_stateprovince__dbt_backup" cascade
[0m10:40:45.064843 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.020 seconds
[0m10:40:45.070107 [debug] [Thread-1 (]: On model.dbt_project_25.stg_stateprovince: Close
[0m10:40:45.072192 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0132c10-12ac-4768-ba24-1548ea52050f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7df3e0606300>]}
[0m10:40:45.073786 [info ] [Thread-1 (]: 10 of 12 OK created sql table model ___staging.stg_stateprovince ............... [[32mSELECT 181[0m in 0.30s]
[0m10:40:45.075308 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.stg_stateprovince
[0m10:40:45.076421 [debug] [Thread-1 (]: Began running node model.dbt_project_25.storeclean
[0m10:40:45.077838 [info ] [Thread-1 (]: 11 of 12 START sql table model ___staging.storeclean ........................... [RUN]
[0m10:40:45.079030 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_25.stg_stateprovince, now model.dbt_project_25.storeclean)
[0m10:40:45.080142 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.storeclean
[0m10:40:45.085781 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.storeclean"
[0m10:40:45.087003 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.storeclean
[0m10:40:45.094304 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.storeclean"
[0m10:40:45.095635 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.storeclean"
[0m10:40:45.096523 [debug] [Thread-1 (]: On model.dbt_project_25.storeclean: BEGIN
[0m10:40:45.097347 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:40:45.256785 [debug] [Thread-1 (]: SQL status: BEGIN in 0.159 seconds
[0m10:40:45.258769 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.storeclean"
[0m10:40:45.260614 [debug] [Thread-1 (]: On model.dbt_project_25.storeclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.storeclean"} */

  
    

  create  table "BI_group4"."___staging"."storeclean__dbt_tmp"
  
  
    as
  
  (
    

select
    salespersonid as salerid,
    storename,
    businessentityid
from "BI_group4"."corentin"."store1"
  );
  
[0m10:40:45.274826 [debug] [Thread-1 (]: SQL status: SELECT 701 in 0.012 seconds
[0m10:40:45.285524 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.storeclean"
[0m10:40:45.286429 [debug] [Thread-1 (]: On model.dbt_project_25.storeclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.storeclean"} */
alter table "BI_group4"."___staging"."storeclean" rename to "storeclean__dbt_backup"
[0m10:40:45.297730 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m10:40:45.303538 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.storeclean"
[0m10:40:45.304416 [debug] [Thread-1 (]: On model.dbt_project_25.storeclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.storeclean"} */
alter table "BI_group4"."___staging"."storeclean__dbt_tmp" rename to "storeclean"
[0m10:40:45.315116 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m10:40:45.318572 [debug] [Thread-1 (]: On model.dbt_project_25.storeclean: COMMIT
[0m10:40:45.319464 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.storeclean"
[0m10:40:45.320320 [debug] [Thread-1 (]: On model.dbt_project_25.storeclean: COMMIT
[0m10:40:45.336033 [debug] [Thread-1 (]: SQL status: COMMIT in 0.015 seconds
[0m10:40:45.344184 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."___staging"."storeclean__dbt_backup"
[0m10:40:45.346177 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.storeclean"
[0m10:40:45.347159 [debug] [Thread-1 (]: On model.dbt_project_25.storeclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.storeclean"} */
drop table if exists "BI_group4"."___staging"."storeclean__dbt_backup" cascade
[0m10:40:45.376081 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.028 seconds
[0m10:40:45.381344 [debug] [Thread-1 (]: On model.dbt_project_25.storeclean: Close
[0m10:40:45.383549 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0132c10-12ac-4768-ba24-1548ea52050f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7df3e4f554c0>]}
[0m10:40:45.385041 [info ] [Thread-1 (]: 11 of 12 OK created sql table model ___staging.storeclean ...................... [[32mSELECT 701[0m in 0.30s]
[0m10:40:45.386471 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.storeclean
[0m10:40:45.387545 [debug] [Thread-1 (]: Began running node model.dbt_project_25.my_second_dbt_model
[0m10:40:45.388898 [info ] [Thread-1 (]: 12 of 12 START sql view model _.my_second_dbt_model ............................ [RUN]
[0m10:40:45.390020 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_25.storeclean, now model.dbt_project_25.my_second_dbt_model)
[0m10:40:45.391040 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.my_second_dbt_model
[0m10:40:45.396198 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.my_second_dbt_model"
[0m10:40:45.397430 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.my_second_dbt_model
[0m10:40:45.431607 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.my_second_dbt_model"
[0m10:40:45.432952 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_second_dbt_model"
[0m10:40:45.433847 [debug] [Thread-1 (]: On model.dbt_project_25.my_second_dbt_model: BEGIN
[0m10:40:45.434663 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:40:45.594663 [debug] [Thread-1 (]: SQL status: BEGIN in 0.160 seconds
[0m10:40:45.596661 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_second_dbt_model"
[0m10:40:45.598518 [debug] [Thread-1 (]: On model.dbt_project_25.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.my_second_dbt_model"} */

  create view "BI_group4"."_"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "BI_group4"."_"."my_first_dbt_model"
where id = 1
  );
[0m10:40:45.613346 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m10:40:45.622462 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_second_dbt_model"
[0m10:40:45.623941 [debug] [Thread-1 (]: On model.dbt_project_25.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.my_second_dbt_model"} */
alter table "BI_group4"."_"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m10:40:45.634933 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.009 seconds
[0m10:40:45.641588 [debug] [Thread-1 (]: On model.dbt_project_25.my_second_dbt_model: COMMIT
[0m10:40:45.643417 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_second_dbt_model"
[0m10:40:45.645052 [debug] [Thread-1 (]: On model.dbt_project_25.my_second_dbt_model: COMMIT
[0m10:40:45.658157 [debug] [Thread-1 (]: SQL status: COMMIT in 0.012 seconds
[0m10:40:45.668594 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."_"."my_second_dbt_model__dbt_backup"
[0m10:40:45.675590 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_second_dbt_model"
[0m10:40:45.676491 [debug] [Thread-1 (]: On model.dbt_project_25.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.my_second_dbt_model"} */
drop view if exists "BI_group4"."_"."my_second_dbt_model__dbt_backup" cascade
[0m10:40:45.687547 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.010 seconds
[0m10:40:45.692421 [debug] [Thread-1 (]: On model.dbt_project_25.my_second_dbt_model: Close
[0m10:40:45.694723 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0132c10-12ac-4768-ba24-1548ea52050f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7df3e1ff3320>]}
[0m10:40:45.696149 [info ] [Thread-1 (]: 12 of 12 OK created sql view model _.my_second_dbt_model ....................... [[32mCREATE VIEW[0m in 0.30s]
[0m10:40:45.697430 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.my_second_dbt_model
[0m10:40:45.700875 [debug] [MainThread]: Using postgres connection "master"
[0m10:40:45.702572 [debug] [MainThread]: On master: BEGIN
[0m10:40:45.704093 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:40:45.898275 [debug] [MainThread]: SQL status: BEGIN in 0.194 seconds
[0m10:40:45.900109 [debug] [MainThread]: On master: COMMIT
[0m10:40:45.901724 [debug] [MainThread]: Using postgres connection "master"
[0m10:40:45.903252 [debug] [MainThread]: On master: COMMIT
[0m10:40:45.914492 [debug] [MainThread]: SQL status: COMMIT in 0.010 seconds
[0m10:40:45.915369 [debug] [MainThread]: On master: Close
[0m10:40:45.916534 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:40:45.917531 [debug] [MainThread]: Connection 'model.dbt_project_25.my_second_dbt_model' was properly closed.
[0m10:40:45.918795 [info ] [MainThread]: 
[0m10:40:45.919963 [info ] [MainThread]: Finished running 11 table models, 1 view model in 0 hours 0 minutes and 5.81 seconds (5.81s).
[0m10:40:45.925691 [debug] [MainThread]: Command end result
[0m10:40:45.972215 [debug] [MainThread]: Wrote artifact WritableManifest to /home/corentin.vanlandeghe@Digital-Grenoble.local/BI_DBT/target/manifest.json
[0m10:40:45.975336 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/corentin.vanlandeghe@Digital-Grenoble.local/BI_DBT/target/semantic_manifest.json
[0m10:40:45.986330 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/corentin.vanlandeghe@Digital-Grenoble.local/BI_DBT/target/run_results.json
[0m10:40:45.987105 [info ] [MainThread]: 
[0m10:40:45.987950 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:40:45.988717 [info ] [MainThread]: 
[0m10:40:45.989512 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=12
[0m10:40:45.991254 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.8289084, "process_in_blocks": "0", "process_kernel_time": 0.544816, "process_mem_max_rss": "129048", "process_out_blocks": "3952", "process_user_time": 6.072806}
[0m10:40:45.992261 [debug] [MainThread]: Command `dbt run` succeeded at 10:40:45.992071 after 7.83 seconds
[0m10:40:45.993090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7df3e60f53d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7df3e43500b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7df3e47a27b0>]}
[0m10:40:45.993958 [debug] [MainThread]: Flushing usage events
[0m10:40:46.501985 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:21:13.613761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef09ae18230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef09d00c740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef09ae1b380>]}


============================== 15:21:13.619443 | 31e8c37d-729c-4d14-a85a-46fd39f8c303 ==============================
[0m15:21:13.619443 [info ] [MainThread]: Running with dbt=1.10.2
[0m15:21:13.620638 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/corentin.vanlandeghe@Digital-Grenoble.local/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/corentin.vanlandeghe@Digital-Grenoble.local/BI_DBT/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m15:21:13.942726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '31e8c37d-729c-4d14-a85a-46fd39f8c303', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef09aae2f90>]}
[0m15:21:14.068095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '31e8c37d-729c-4d14-a85a-46fd39f8c303', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef09ab9b620>]}
[0m15:21:14.069587 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:21:14.250545 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m15:21:14.481784 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m15:21:14.482913 [debug] [MainThread]: Partial parsing: added file: dbt_project_25://models/staging/addressclean.sql
[0m15:21:14.484798 [debug] [MainThread]: Partial parsing: updated file: dbt_project_25://models/staging/schema.yml
[0m15:21:15.263073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '31e8c37d-729c-4d14-a85a-46fd39f8c303', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef098b56c60>]}
[0m15:21:15.414319 [debug] [MainThread]: Wrote artifact WritableManifest to /home/corentin.vanlandeghe@Digital-Grenoble.local/BI_DBT/target/manifest.json
[0m15:21:15.417373 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/corentin.vanlandeghe@Digital-Grenoble.local/BI_DBT/target/semantic_manifest.json
[0m15:21:15.440802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '31e8c37d-729c-4d14-a85a-46fd39f8c303', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef099344e30>]}
[0m15:21:15.441780 [info ] [MainThread]: Found 13 models, 4 data tests, 11 sources, 549 macros
[0m15:21:15.442602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31e8c37d-729c-4d14-a85a-46fd39f8c303', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef098b75130>]}
[0m15:21:15.446766 [info ] [MainThread]: 
[0m15:21:15.447592 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:21:15.448311 [info ] [MainThread]: 
[0m15:21:15.449333 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:21:15.458184 [debug] [ThreadPool]: Acquiring new postgres connection 'list_BI_group4'
[0m15:21:15.615360 [debug] [ThreadPool]: Using postgres connection "list_BI_group4"
[0m15:21:15.616259 [debug] [ThreadPool]: On list_BI_group4: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "connection_name": "list_BI_group4"} */

    select distinct nspname from pg_namespace
  
[0m15:21:15.617013 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:21:16.020032 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.403 seconds
[0m15:21:16.025339 [debug] [ThreadPool]: On list_BI_group4: Close
[0m15:21:16.033946 [debug] [ThreadPool]: Using postgres connection "list_BI_group4"
[0m15:21:16.034744 [debug] [ThreadPool]: On list_BI_group4: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "connection_name": "list_BI_group4"} */

    select distinct nspname from pg_namespace
  
[0m15:21:16.035451 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:21:16.199199 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.164 seconds
[0m15:21:16.204090 [debug] [ThreadPool]: On list_BI_group4: Close
[0m15:21:16.210568 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_BI_group4, now list_BI_group4____staging)
[0m15:21:16.222908 [debug] [ThreadPool]: Using postgres connection "list_BI_group4____staging"
[0m15:21:16.223701 [debug] [ThreadPool]: On list_BI_group4____staging: BEGIN
[0m15:21:16.224390 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:21:16.388764 [debug] [ThreadPool]: SQL status: BEGIN in 0.164 seconds
[0m15:21:16.390455 [debug] [ThreadPool]: Using postgres connection "list_BI_group4____staging"
[0m15:21:16.392096 [debug] [ThreadPool]: On list_BI_group4____staging: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "connection_name": "list_BI_group4____staging"} */
select
      'BI_group4' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike '___staging'
    union all
    select
      'BI_group4' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike '___staging'
    union all
    select
      'BI_group4' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike '___staging'
  
[0m15:21:16.409453 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.016 seconds
[0m15:21:16.414367 [debug] [ThreadPool]: On list_BI_group4____staging: ROLLBACK
[0m15:21:16.425177 [debug] [ThreadPool]: On list_BI_group4____staging: Close
[0m15:21:16.427701 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_BI_group4____staging, now list_BI_group4__)
[0m15:21:16.441008 [debug] [ThreadPool]: Using postgres connection "list_BI_group4__"
[0m15:21:16.442299 [debug] [ThreadPool]: On list_BI_group4__: BEGIN
[0m15:21:16.443527 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:21:16.608841 [debug] [ThreadPool]: SQL status: BEGIN in 0.165 seconds
[0m15:21:16.610589 [debug] [ThreadPool]: Using postgres connection "list_BI_group4__"
[0m15:21:16.612216 [debug] [ThreadPool]: On list_BI_group4__: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "connection_name": "list_BI_group4__"} */
select
      'BI_group4' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike '_'
    union all
    select
      'BI_group4' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike '_'
    union all
    select
      'BI_group4' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike '_'
  
[0m15:21:16.629056 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.015 seconds
[0m15:21:16.634172 [debug] [ThreadPool]: On list_BI_group4__: ROLLBACK
[0m15:21:16.746755 [debug] [ThreadPool]: On list_BI_group4__: Close
[0m15:21:16.762106 [debug] [MainThread]: Using postgres connection "master"
[0m15:21:16.762956 [debug] [MainThread]: On master: BEGIN
[0m15:21:16.763692 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:21:16.930975 [debug] [MainThread]: SQL status: BEGIN in 0.167 seconds
[0m15:21:16.932702 [debug] [MainThread]: Using postgres connection "master"
[0m15:21:16.934615 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:21:16.955622 [debug] [MainThread]: SQL status: SELECT 3 in 0.019 seconds
[0m15:21:16.961553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31e8c37d-729c-4d14-a85a-46fd39f8c303', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef09839e2a0>]}
[0m15:21:16.963486 [debug] [MainThread]: On master: ROLLBACK
[0m15:21:16.974438 [debug] [MainThread]: Using postgres connection "master"
[0m15:21:16.975288 [debug] [MainThread]: On master: BEGIN
[0m15:21:16.995526 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m15:21:16.997166 [debug] [MainThread]: On master: COMMIT
[0m15:21:16.998743 [debug] [MainThread]: Using postgres connection "master"
[0m15:21:17.000255 [debug] [MainThread]: On master: COMMIT
[0m15:21:17.011472 [debug] [MainThread]: SQL status: COMMIT in 0.010 seconds
[0m15:21:17.012989 [debug] [MainThread]: On master: Close
[0m15:21:17.020325 [debug] [Thread-1 (]: Began running node model.dbt_project_25.addressclean
[0m15:21:17.022646 [info ] [Thread-1 (]: 1 of 13 START sql table model ___staging.addressclean .......................... [RUN]
[0m15:21:17.024694 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_BI_group4__, now model.dbt_project_25.addressclean)
[0m15:21:17.026468 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.addressclean
[0m15:21:17.042332 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.addressclean"
[0m15:21:17.043587 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.addressclean
[0m15:21:17.116022 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.addressclean"
[0m15:21:17.117352 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.addressclean"
[0m15:21:17.118246 [debug] [Thread-1 (]: On model.dbt_project_25.addressclean: BEGIN
[0m15:21:17.119051 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:21:17.278766 [debug] [Thread-1 (]: SQL status: BEGIN in 0.159 seconds
[0m15:21:17.280696 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.addressclean"
[0m15:21:17.282523 [debug] [Thread-1 (]: On model.dbt_project_25.addressclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.addressclean"} */

  
    

  create  table "BI_group4"."___staging"."addressclean__dbt_tmp"
  
  
    as
  
  (
    

select
    salespersonid as salerid,
    storename,
    businessentityid
from "BI_group4"."corentin"."store1"
  );
  
[0m15:21:17.297203 [debug] [Thread-1 (]: SQL status: SELECT 701 in 0.013 seconds
[0m15:21:17.321102 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.addressclean"
[0m15:21:17.322006 [debug] [Thread-1 (]: On model.dbt_project_25.addressclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.addressclean"} */
alter table "BI_group4"."___staging"."addressclean__dbt_tmp" rename to "addressclean"
[0m15:21:17.333590 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m15:21:17.363469 [debug] [Thread-1 (]: On model.dbt_project_25.addressclean: COMMIT
[0m15:21:17.364399 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.addressclean"
[0m15:21:17.365252 [debug] [Thread-1 (]: On model.dbt_project_25.addressclean: COMMIT
[0m15:21:17.377229 [debug] [Thread-1 (]: SQL status: COMMIT in 0.011 seconds
[0m15:21:17.389486 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."___staging"."addressclean__dbt_backup"
[0m15:21:17.399550 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.addressclean"
[0m15:21:17.400430 [debug] [Thread-1 (]: On model.dbt_project_25.addressclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.addressclean"} */
drop table if exists "BI_group4"."___staging"."addressclean__dbt_backup" cascade
[0m15:21:17.411286 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.010 seconds
[0m15:21:17.420297 [debug] [Thread-1 (]: On model.dbt_project_25.addressclean: Close
[0m15:21:17.424021 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31e8c37d-729c-4d14-a85a-46fd39f8c303', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef09cdc40b0>]}
[0m15:21:17.425345 [info ] [Thread-1 (]: 1 of 13 OK created sql table model ___staging.addressclean ..................... [[32mSELECT 701[0m in 0.40s]
[0m15:21:17.426644 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.addressclean
[0m15:21:17.427578 [debug] [Thread-1 (]: Began running node model.dbt_project_25.customerclean
[0m15:21:17.429028 [info ] [Thread-1 (]: 2 of 13 START sql table model ___staging.customerclean ......................... [RUN]
[0m15:21:17.430020 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_25.addressclean, now model.dbt_project_25.customerclean)
[0m15:21:17.430891 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.customerclean
[0m15:21:17.436244 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.customerclean"
[0m15:21:17.437433 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.customerclean
[0m15:21:17.444549 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.customerclean"
[0m15:21:17.445814 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.customerclean"
[0m15:21:17.446664 [debug] [Thread-1 (]: On model.dbt_project_25.customerclean: BEGIN
[0m15:21:17.447460 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:21:17.605739 [debug] [Thread-1 (]: SQL status: BEGIN in 0.158 seconds
[0m15:21:17.607720 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.customerclean"
[0m15:21:17.609955 [debug] [Thread-1 (]: On model.dbt_project_25.customerclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.customerclean"} */

  
    

  create  table "BI_group4"."___staging"."customerclean__dbt_tmp"
  
  
    as
  
  (
    

select
    customerid, 
	storeid,
    territoryid
from "BI_group4"."corentin"."customer"
  );
  
[0m15:21:17.641856 [debug] [Thread-1 (]: SQL status: SELECT 19820 in 0.030 seconds
[0m15:21:17.653708 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.customerclean"
[0m15:21:17.654609 [debug] [Thread-1 (]: On model.dbt_project_25.customerclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.customerclean"} */
alter table "BI_group4"."___staging"."customerclean" rename to "customerclean__dbt_backup"
[0m15:21:17.667245 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.012 seconds
[0m15:21:17.675863 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.customerclean"
[0m15:21:17.676859 [debug] [Thread-1 (]: On model.dbt_project_25.customerclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.customerclean"} */
alter table "BI_group4"."___staging"."customerclean__dbt_tmp" rename to "customerclean"
[0m15:21:17.688271 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m15:21:17.695588 [debug] [Thread-1 (]: On model.dbt_project_25.customerclean: COMMIT
[0m15:21:17.696481 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.customerclean"
[0m15:21:17.697334 [debug] [Thread-1 (]: On model.dbt_project_25.customerclean: COMMIT
[0m15:21:17.716089 [debug] [Thread-1 (]: SQL status: COMMIT in 0.018 seconds
[0m15:21:17.724729 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."___staging"."customerclean__dbt_backup"
[0m15:21:17.726616 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.customerclean"
[0m15:21:17.727531 [debug] [Thread-1 (]: On model.dbt_project_25.customerclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.customerclean"} */
drop table if exists "BI_group4"."___staging"."customerclean__dbt_backup" cascade
[0m15:21:17.742165 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.013 seconds
[0m15:21:17.745656 [debug] [Thread-1 (]: On model.dbt_project_25.customerclean: Close
[0m15:21:17.747408 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31e8c37d-729c-4d14-a85a-46fd39f8c303', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef0967497c0>]}
[0m15:21:17.749248 [info ] [Thread-1 (]: 2 of 13 OK created sql table model ___staging.customerclean .................... [[32mSELECT 19820[0m in 0.32s]
[0m15:21:17.751048 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.customerclean
[0m15:21:17.752357 [debug] [Thread-1 (]: Began running node model.dbt_project_25.dateclean
[0m15:21:17.753553 [info ] [Thread-1 (]: 3 of 13 START sql table model ___staging.dateclean ............................. [RUN]
[0m15:21:17.754744 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_25.customerclean, now model.dbt_project_25.dateclean)
[0m15:21:17.755645 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.dateclean
[0m15:21:17.763399 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.dateclean"
[0m15:21:17.764680 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.dateclean
[0m15:21:17.771886 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.dateclean"
[0m15:21:17.773185 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.dateclean"
[0m15:21:17.774071 [debug] [Thread-1 (]: On model.dbt_project_25.dateclean: BEGIN
[0m15:21:17.774899 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:21:17.939042 [debug] [Thread-1 (]: SQL status: BEGIN in 0.164 seconds
[0m15:21:17.941003 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.dateclean"
[0m15:21:17.942843 [debug] [Thread-1 (]: On model.dbt_project_25.dateclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.dateclean"} */

  
    

  create  table "BI_group4"."___staging"."dateclean__dbt_tmp"
  
  
    as
  
  (
    

select
    date_day,
    day_of_week as number_day_week,
    day_of_week_name as day_name
    
from "BI_group4"."corentin"."date"
  );
  
[0m15:21:17.960277 [debug] [Thread-1 (]: SQL status: SELECT 731 in 0.016 seconds
[0m15:21:17.970857 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.dateclean"
[0m15:21:17.972191 [debug] [Thread-1 (]: On model.dbt_project_25.dateclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.dateclean"} */
alter table "BI_group4"."___staging"."dateclean" rename to "dateclean__dbt_backup"
[0m15:21:17.984036 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.011 seconds
[0m15:21:17.991575 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.dateclean"
[0m15:21:17.992810 [debug] [Thread-1 (]: On model.dbt_project_25.dateclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.dateclean"} */
alter table "BI_group4"."___staging"."dateclean__dbt_tmp" rename to "dateclean"
[0m15:21:18.003969 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m15:21:18.008511 [debug] [Thread-1 (]: On model.dbt_project_25.dateclean: COMMIT
[0m15:21:18.009754 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.dateclean"
[0m15:21:18.010929 [debug] [Thread-1 (]: On model.dbt_project_25.dateclean: COMMIT
[0m15:21:18.023904 [debug] [Thread-1 (]: SQL status: COMMIT in 0.012 seconds
[0m15:21:18.029939 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."___staging"."dateclean__dbt_backup"
[0m15:21:18.032359 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.dateclean"
[0m15:21:18.033591 [debug] [Thread-1 (]: On model.dbt_project_25.dateclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.dateclean"} */
drop table if exists "BI_group4"."___staging"."dateclean__dbt_backup" cascade
[0m15:21:18.049632 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.015 seconds
[0m15:21:18.054858 [debug] [Thread-1 (]: On model.dbt_project_25.dateclean: Close
[0m15:21:18.056551 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31e8c37d-729c-4d14-a85a-46fd39f8c303', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef098bda9f0>]}
[0m15:21:18.058224 [info ] [Thread-1 (]: 3 of 13 OK created sql table model ___staging.dateclean ........................ [[32mSELECT 731[0m in 0.30s]
[0m15:21:18.059868 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.dateclean
[0m15:21:18.061078 [debug] [Thread-1 (]: Began running node model.dbt_project_25.my_first_dbt_model
[0m15:21:18.062595 [info ] [Thread-1 (]: 4 of 13 START sql table model _.my_first_dbt_model ............................. [RUN]
[0m15:21:18.063876 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_25.dateclean, now model.dbt_project_25.my_first_dbt_model)
[0m15:21:18.065033 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.my_first_dbt_model
[0m15:21:18.070119 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.my_first_dbt_model"
[0m15:21:18.071350 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.my_first_dbt_model
[0m15:21:18.078415 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.my_first_dbt_model"
[0m15:21:18.079713 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_first_dbt_model"
[0m15:21:18.080582 [debug] [Thread-1 (]: On model.dbt_project_25.my_first_dbt_model: BEGIN
[0m15:21:18.081382 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:21:18.242703 [debug] [Thread-1 (]: SQL status: BEGIN in 0.161 seconds
[0m15:21:18.244676 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_first_dbt_model"
[0m15:21:18.246547 [debug] [Thread-1 (]: On model.dbt_project_25.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.my_first_dbt_model"} */

  
    

  create  table "BI_group4"."_"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m15:21:18.260049 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.012 seconds
[0m15:21:18.270157 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_first_dbt_model"
[0m15:21:18.271173 [debug] [Thread-1 (]: On model.dbt_project_25.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.my_first_dbt_model"} */
alter table "BI_group4"."_"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m15:21:18.281952 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m15:21:18.288086 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_first_dbt_model"
[0m15:21:18.288968 [debug] [Thread-1 (]: On model.dbt_project_25.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.my_first_dbt_model"} */
alter table "BI_group4"."_"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m15:21:18.300122 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m15:21:18.305952 [debug] [Thread-1 (]: On model.dbt_project_25.my_first_dbt_model: COMMIT
[0m15:21:18.306898 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_first_dbt_model"
[0m15:21:18.307743 [debug] [Thread-1 (]: On model.dbt_project_25.my_first_dbt_model: COMMIT
[0m15:21:18.320314 [debug] [Thread-1 (]: SQL status: COMMIT in 0.011 seconds
[0m15:21:18.328435 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."_"."my_first_dbt_model__dbt_backup"
[0m15:21:18.333173 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_first_dbt_model"
[0m15:21:18.334171 [debug] [Thread-1 (]: On model.dbt_project_25.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.my_first_dbt_model"} */
drop table if exists "BI_group4"."_"."my_first_dbt_model__dbt_backup" cascade
[0m15:21:18.348556 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.013 seconds
[0m15:21:18.352111 [debug] [Thread-1 (]: On model.dbt_project_25.my_first_dbt_model: Close
[0m15:21:18.353803 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31e8c37d-729c-4d14-a85a-46fd39f8c303', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef096788860>]}
[0m15:21:18.355591 [info ] [Thread-1 (]: 4 of 13 OK created sql table model _.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.29s]
[0m15:21:18.357226 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.my_first_dbt_model
[0m15:21:18.358139 [debug] [Thread-1 (]: Began running node model.dbt_project_25.personclean
[0m15:21:18.359522 [info ] [Thread-1 (]: 5 of 13 START sql table model ___staging.personclean ........................... [RUN]
[0m15:21:18.360576 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_25.my_first_dbt_model, now model.dbt_project_25.personclean)
[0m15:21:18.361455 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.personclean
[0m15:21:18.367028 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.personclean"
[0m15:21:18.368263 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.personclean
[0m15:21:18.375258 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.personclean"
[0m15:21:18.376535 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.personclean"
[0m15:21:18.377402 [debug] [Thread-1 (]: On model.dbt_project_25.personclean: BEGIN
[0m15:21:18.378225 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:21:18.542253 [debug] [Thread-1 (]: SQL status: BEGIN in 0.164 seconds
[0m15:21:18.544225 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.personclean"
[0m15:21:18.546050 [debug] [Thread-1 (]: On model.dbt_project_25.personclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.personclean"} */

  
    

  create  table "BI_group4"."___staging"."personclean__dbt_tmp"
  
  
    as
  
  (
    

select
    businessentityid,
    firstname,
    lastname

from "BI_group4"."corentin"."person"
  );
  
[0m15:21:18.564290 [debug] [Thread-1 (]: SQL status: SELECT 2057 in 0.016 seconds
[0m15:21:18.576354 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.personclean"
[0m15:21:18.577949 [debug] [Thread-1 (]: On model.dbt_project_25.personclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.personclean"} */
alter table "BI_group4"."___staging"."personclean" rename to "personclean__dbt_backup"
[0m15:21:18.588984 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m15:21:18.599633 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.personclean"
[0m15:21:18.600529 [debug] [Thread-1 (]: On model.dbt_project_25.personclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.personclean"} */
alter table "BI_group4"."___staging"."personclean__dbt_tmp" rename to "personclean"
[0m15:21:18.611456 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m15:21:18.617049 [debug] [Thread-1 (]: On model.dbt_project_25.personclean: COMMIT
[0m15:21:18.618365 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.personclean"
[0m15:21:18.619202 [debug] [Thread-1 (]: On model.dbt_project_25.personclean: COMMIT
[0m15:21:18.632614 [debug] [Thread-1 (]: SQL status: COMMIT in 0.012 seconds
[0m15:21:18.640393 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."___staging"."personclean__dbt_backup"
[0m15:21:18.642517 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.personclean"
[0m15:21:18.643570 [debug] [Thread-1 (]: On model.dbt_project_25.personclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.personclean"} */
drop table if exists "BI_group4"."___staging"."personclean__dbt_backup" cascade
[0m15:21:18.657282 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.013 seconds
[0m15:21:18.660250 [debug] [Thread-1 (]: On model.dbt_project_25.personclean: Close
[0m15:21:18.661978 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31e8c37d-729c-4d14-a85a-46fd39f8c303', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef096730b90>]}
[0m15:21:18.663806 [info ] [Thread-1 (]: 5 of 13 OK created sql table model ___staging.personclean ...................... [[32mSELECT 2057[0m in 0.30s]
[0m15:21:18.665592 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.personclean
[0m15:21:18.666898 [debug] [Thread-1 (]: Began running node model.dbt_project_25.productsubcategoryclean
[0m15:21:18.668542 [info ] [Thread-1 (]: 6 of 13 START sql table model ___staging.productsubcategoryclean ............... [RUN]
[0m15:21:18.669727 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_25.personclean, now model.dbt_project_25.productsubcategoryclean)
[0m15:21:18.670634 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.productsubcategoryclean
[0m15:21:18.676091 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.productsubcategoryclean"
[0m15:21:18.677335 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.productsubcategoryclean
[0m15:21:18.684463 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.productsubcategoryclean"
[0m15:21:18.685760 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.productsubcategoryclean"
[0m15:21:18.686640 [debug] [Thread-1 (]: On model.dbt_project_25.productsubcategoryclean: BEGIN
[0m15:21:18.687445 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:21:18.914190 [debug] [Thread-1 (]: SQL status: BEGIN in 0.226 seconds
[0m15:21:18.916155 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.productsubcategoryclean"
[0m15:21:18.918005 [debug] [Thread-1 (]: On model.dbt_project_25.productsubcategoryclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.productsubcategoryclean"} */

  
    

  create  table "BI_group4"."___staging"."productsubcategoryclean__dbt_tmp"
  
  
    as
  
  (
    

select
    productsubcategoryid, 
	productcategoryid,
    name as subcategoryname
from "BI_group4"."corentin"."productsubcategory"
  );
  
[0m15:21:18.930977 [debug] [Thread-1 (]: SQL status: SELECT 37 in 0.011 seconds
[0m15:21:18.942394 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.productsubcategoryclean"
[0m15:21:18.943307 [debug] [Thread-1 (]: On model.dbt_project_25.productsubcategoryclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.productsubcategoryclean"} */
alter table "BI_group4"."___staging"."productsubcategoryclean" rename to "productsubcategoryclean__dbt_backup"
[0m15:21:18.953918 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.009 seconds
[0m15:21:18.961408 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.productsubcategoryclean"
[0m15:21:18.962304 [debug] [Thread-1 (]: On model.dbt_project_25.productsubcategoryclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.productsubcategoryclean"} */
alter table "BI_group4"."___staging"."productsubcategoryclean__dbt_tmp" rename to "productsubcategoryclean"
[0m15:21:18.973727 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m15:21:18.980084 [debug] [Thread-1 (]: On model.dbt_project_25.productsubcategoryclean: COMMIT
[0m15:21:18.981150 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.productsubcategoryclean"
[0m15:21:18.981991 [debug] [Thread-1 (]: On model.dbt_project_25.productsubcategoryclean: COMMIT
[0m15:21:18.994294 [debug] [Thread-1 (]: SQL status: COMMIT in 0.011 seconds
[0m15:21:19.005084 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."___staging"."productsubcategoryclean__dbt_backup"
[0m15:21:19.007063 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.productsubcategoryclean"
[0m15:21:19.008051 [debug] [Thread-1 (]: On model.dbt_project_25.productsubcategoryclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.productsubcategoryclean"} */
drop table if exists "BI_group4"."___staging"."productsubcategoryclean__dbt_backup" cascade
[0m15:21:19.021579 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.012 seconds
[0m15:21:19.026826 [debug] [Thread-1 (]: On model.dbt_project_25.productsubcategoryclean: Close
[0m15:21:19.029297 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31e8c37d-729c-4d14-a85a-46fd39f8c303', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef0967aeed0>]}
[0m15:21:19.031637 [info ] [Thread-1 (]: 6 of 13 OK created sql table model ___staging.productsubcategoryclean .......... [[32mSELECT 37[0m in 0.36s]
[0m15:21:19.032894 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.productsubcategoryclean
[0m15:21:19.033819 [debug] [Thread-1 (]: Began running node model.dbt_project_25.salesorderdetailsclean
[0m15:21:19.035011 [info ] [Thread-1 (]: 7 of 13 START sql table model ___staging.salesorderdetailsclean ................ [RUN]
[0m15:21:19.036003 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_25.productsubcategoryclean, now model.dbt_project_25.salesorderdetailsclean)
[0m15:21:19.036879 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.salesorderdetailsclean
[0m15:21:19.042238 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.salesorderdetailsclean"
[0m15:21:19.043478 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.salesorderdetailsclean
[0m15:21:19.050731 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.salesorderdetailsclean"
[0m15:21:19.052042 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderdetailsclean"
[0m15:21:19.052933 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderdetailsclean: BEGIN
[0m15:21:19.053778 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:21:19.209389 [debug] [Thread-1 (]: SQL status: BEGIN in 0.155 seconds
[0m15:21:19.211381 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderdetailsclean"
[0m15:21:19.213225 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderdetailsclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.salesorderdetailsclean"} */

  
    

  create  table "BI_group4"."___staging"."salesorderdetailsclean__dbt_tmp"
  
  
    as
  
  (
    

select 
	salesorderid, 
	unitprice,
	orderqty as orderquantity,
	productid,
	unitpricediscount as discount

from "BI_group4"."corentin"."salesorderdetail"
  );
  
[0m15:21:19.233610 [debug] [Thread-1 (]: SQL status: SELECT 5716 in 0.018 seconds
[0m15:21:19.244434 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderdetailsclean"
[0m15:21:19.245382 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderdetailsclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.salesorderdetailsclean"} */
alter table "BI_group4"."___staging"."salesorderdetailsclean" rename to "salesorderdetailsclean__dbt_backup"
[0m15:21:19.255747 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.009 seconds
[0m15:21:19.261691 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderdetailsclean"
[0m15:21:19.262594 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderdetailsclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.salesorderdetailsclean"} */
alter table "BI_group4"."___staging"."salesorderdetailsclean__dbt_tmp" rename to "salesorderdetailsclean"
[0m15:21:19.273123 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m15:21:19.277996 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderdetailsclean: COMMIT
[0m15:21:19.279219 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderdetailsclean"
[0m15:21:19.280390 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderdetailsclean: COMMIT
[0m15:21:19.294908 [debug] [Thread-1 (]: SQL status: COMMIT in 0.013 seconds
[0m15:21:19.301432 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."___staging"."salesorderdetailsclean__dbt_backup"
[0m15:21:19.303558 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderdetailsclean"
[0m15:21:19.304420 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderdetailsclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.salesorderdetailsclean"} */
drop table if exists "BI_group4"."___staging"."salesorderdetailsclean__dbt_backup" cascade
[0m15:21:19.318741 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.013 seconds
[0m15:21:19.322997 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderdetailsclean: Close
[0m15:21:19.324719 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31e8c37d-729c-4d14-a85a-46fd39f8c303', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef09676e870>]}
[0m15:21:19.326528 [info ] [Thread-1 (]: 7 of 13 OK created sql table model ___staging.salesorderdetailsclean ........... [[32mSELECT 5716[0m in 0.29s]
[0m15:21:19.328253 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.salesorderdetailsclean
[0m15:21:19.329544 [debug] [Thread-1 (]: Began running node model.dbt_project_25.salesorderheaderclean
[0m15:21:19.331144 [info ] [Thread-1 (]: 8 of 13 START sql table model ___staging.salesorderheaderclean ................. [RUN]
[0m15:21:19.332530 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_25.salesorderdetailsclean, now model.dbt_project_25.salesorderheaderclean)
[0m15:21:19.333485 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.salesorderheaderclean
[0m15:21:19.339185 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.salesorderheaderclean"
[0m15:21:19.340422 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.salesorderheaderclean
[0m15:21:19.347880 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.salesorderheaderclean"
[0m15:21:19.349162 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderheaderclean"
[0m15:21:19.350047 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderheaderclean: BEGIN
[0m15:21:19.350865 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:21:19.500899 [debug] [Thread-1 (]: SQL status: BEGIN in 0.150 seconds
[0m15:21:19.502861 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderheaderclean"
[0m15:21:19.504718 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderheaderclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.salesorderheaderclean"} */

  
    

  create  table "BI_group4"."___staging"."salesorderheaderclean__dbt_tmp"
  
  
    as
  
  (
    

select
    orderdate,
    salesorderid,
    territoryid,
    salespersonid as salerid,
    billtoaddressid,
    customerid,
    salespersonid,
    shipdate
from "BI_group4"."corentin"."salesorderheader"
  );
  
[0m15:21:19.520404 [debug] [Thread-1 (]: SQL status: SELECT 1566 in 0.014 seconds
[0m15:21:19.532398 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderheaderclean"
[0m15:21:19.533974 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderheaderclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.salesorderheaderclean"} */
alter table "BI_group4"."___staging"."salesorderheaderclean" rename to "salesorderheaderclean__dbt_backup"
[0m15:21:19.544940 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m15:21:19.555055 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderheaderclean"
[0m15:21:19.555948 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderheaderclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.salesorderheaderclean"} */
alter table "BI_group4"."___staging"."salesorderheaderclean__dbt_tmp" rename to "salesorderheaderclean"
[0m15:21:19.566616 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m15:21:19.572372 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderheaderclean: COMMIT
[0m15:21:19.573861 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderheaderclean"
[0m15:21:19.574743 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderheaderclean: COMMIT
[0m15:21:19.586284 [debug] [Thread-1 (]: SQL status: COMMIT in 0.010 seconds
[0m15:21:19.595169 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."___staging"."salesorderheaderclean__dbt_backup"
[0m15:21:19.596942 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderheaderclean"
[0m15:21:19.597834 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderheaderclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.salesorderheaderclean"} */
drop table if exists "BI_group4"."___staging"."salesorderheaderclean__dbt_backup" cascade
[0m15:21:19.611002 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.012 seconds
[0m15:21:19.613584 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderheaderclean: Close
[0m15:21:19.614862 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31e8c37d-729c-4d14-a85a-46fd39f8c303', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef0967b43b0>]}
[0m15:21:19.616195 [info ] [Thread-1 (]: 8 of 13 OK created sql table model ___staging.salesorderheaderclean ............ [[32mSELECT 1566[0m in 0.28s]
[0m15:21:19.617477 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.salesorderheaderclean
[0m15:21:19.618409 [debug] [Thread-1 (]: Began running node model.dbt_project_25.stg_product
[0m15:21:19.619618 [info ] [Thread-1 (]: 9 of 13 START sql table model ___staging.stg_product ........................... [RUN]
[0m15:21:19.620613 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_25.salesorderheaderclean, now model.dbt_project_25.stg_product)
[0m15:21:19.621484 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.stg_product
[0m15:21:19.626962 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.stg_product"
[0m15:21:19.628178 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.stg_product
[0m15:21:19.635379 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.stg_product"
[0m15:21:19.636664 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_product"
[0m15:21:19.637549 [debug] [Thread-1 (]: On model.dbt_project_25.stg_product: BEGIN
[0m15:21:19.638368 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:21:19.861401 [debug] [Thread-1 (]: SQL status: BEGIN in 0.223 seconds
[0m15:21:19.863414 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_product"
[0m15:21:19.865285 [debug] [Thread-1 (]: On model.dbt_project_25.stg_product: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_product"} */

  
    

  create  table "BI_group4"."___staging"."stg_product__dbt_tmp"
  
  
    as
  
  (
    

SELECT
  productid, 
  name AS itemname
FROM "BI_group4"."corentin"."product"

--run in terminal/shell: 
--dbt run --select stg_product

--(This will build the model as a new view/table in your dev schema, leaving the original data untouched)
  );
  
[0m15:21:19.879528 [debug] [Thread-1 (]: SQL status: SELECT 504 in 0.013 seconds
[0m15:21:19.889593 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_product"
[0m15:21:19.890594 [debug] [Thread-1 (]: On model.dbt_project_25.stg_product: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_product"} */
alter table "BI_group4"."___staging"."stg_product" rename to "stg_product__dbt_backup"
[0m15:21:19.901661 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m15:21:19.907967 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_product"
[0m15:21:19.908846 [debug] [Thread-1 (]: On model.dbt_project_25.stg_product: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_product"} */
alter table "BI_group4"."___staging"."stg_product__dbt_tmp" rename to "stg_product"
[0m15:21:19.919486 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m15:21:19.924699 [debug] [Thread-1 (]: On model.dbt_project_25.stg_product: COMMIT
[0m15:21:19.925951 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_product"
[0m15:21:19.926798 [debug] [Thread-1 (]: On model.dbt_project_25.stg_product: COMMIT
[0m15:21:19.938572 [debug] [Thread-1 (]: SQL status: COMMIT in 0.011 seconds
[0m15:21:19.944588 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."___staging"."stg_product__dbt_backup"
[0m15:21:19.946665 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_product"
[0m15:21:19.947549 [debug] [Thread-1 (]: On model.dbt_project_25.stg_product: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_product"} */
drop table if exists "BI_group4"."___staging"."stg_product__dbt_backup" cascade
[0m15:21:19.961192 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.013 seconds
[0m15:21:19.966272 [debug] [Thread-1 (]: On model.dbt_project_25.stg_product: Close
[0m15:21:19.967892 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31e8c37d-729c-4d14-a85a-46fd39f8c303', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef098bd9730>]}
[0m15:21:19.969583 [info ] [Thread-1 (]: 9 of 13 OK created sql table model ___staging.stg_product ...................... [[32mSELECT 504[0m in 0.35s]
[0m15:21:19.971213 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.stg_product
[0m15:21:19.972414 [debug] [Thread-1 (]: Began running node model.dbt_project_25.stg_productcat
[0m15:21:19.973926 [info ] [Thread-1 (]: 10 of 13 START sql table model ___staging.stg_productcat ....................... [RUN]
[0m15:21:19.975203 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_25.stg_product, now model.dbt_project_25.stg_productcat)
[0m15:21:19.976343 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.stg_productcat
[0m15:21:19.981996 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.stg_productcat"
[0m15:21:19.983186 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.stg_productcat
[0m15:21:19.990515 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.stg_productcat"
[0m15:21:19.991810 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_productcat"
[0m15:21:19.992687 [debug] [Thread-1 (]: On model.dbt_project_25.stg_productcat: BEGIN
[0m15:21:19.993482 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:21:20.149401 [debug] [Thread-1 (]: SQL status: BEGIN in 0.156 seconds
[0m15:21:20.151403 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_productcat"
[0m15:21:20.153342 [debug] [Thread-1 (]: On model.dbt_project_25.stg_productcat: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_productcat"} */

  
    

  create  table "BI_group4"."___staging"."stg_productcat__dbt_tmp"
  
  
    as
  
  (
    

SELECT
  productcategoryid, 
  name AS itemcategoryname
FROM "BI_group4"."corentin"."productcategory"

--run in terminal/shell: 
--dbt run --select stg_productcat

--(This will build the model as a new view/table in your dev schema, leaving the original data untouched)
  );
  
[0m15:21:20.166943 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.012 seconds
[0m15:21:20.177224 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_productcat"
[0m15:21:20.178274 [debug] [Thread-1 (]: On model.dbt_project_25.stg_productcat: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_productcat"} */
alter table "BI_group4"."___staging"."stg_productcat" rename to "stg_productcat__dbt_backup"
[0m15:21:20.189085 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m15:21:20.199402 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_productcat"
[0m15:21:20.200304 [debug] [Thread-1 (]: On model.dbt_project_25.stg_productcat: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_productcat"} */
alter table "BI_group4"."___staging"."stg_productcat__dbt_tmp" rename to "stg_productcat"
[0m15:21:20.210837 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.009 seconds
[0m15:21:20.216125 [debug] [Thread-1 (]: On model.dbt_project_25.stg_productcat: COMMIT
[0m15:21:20.217480 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_productcat"
[0m15:21:20.218607 [debug] [Thread-1 (]: On model.dbt_project_25.stg_productcat: COMMIT
[0m15:21:20.230821 [debug] [Thread-1 (]: SQL status: COMMIT in 0.011 seconds
[0m15:21:20.241331 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."___staging"."stg_productcat__dbt_backup"
[0m15:21:20.243197 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_productcat"
[0m15:21:20.244127 [debug] [Thread-1 (]: On model.dbt_project_25.stg_productcat: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_productcat"} */
drop table if exists "BI_group4"."___staging"."stg_productcat__dbt_backup" cascade
[0m15:21:20.257488 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.012 seconds
[0m15:21:20.260694 [debug] [Thread-1 (]: On model.dbt_project_25.stg_productcat: Close
[0m15:21:20.262439 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31e8c37d-729c-4d14-a85a-46fd39f8c303', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef0967d7da0>]}
[0m15:21:20.264274 [info ] [Thread-1 (]: 10 of 13 OK created sql table model ___staging.stg_productcat .................. [[32mSELECT 4[0m in 0.29s]
[0m15:21:20.266058 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.stg_productcat
[0m15:21:20.267352 [debug] [Thread-1 (]: Began running node model.dbt_project_25.stg_stateprovince
[0m15:21:20.268888 [info ] [Thread-1 (]: 11 of 13 START sql table model ___staging.stg_stateprovince .................... [RUN]
[0m15:21:20.269899 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_25.stg_productcat, now model.dbt_project_25.stg_stateprovince)
[0m15:21:20.270790 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.stg_stateprovince
[0m15:21:20.276615 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.stg_stateprovince"
[0m15:21:20.277844 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.stg_stateprovince
[0m15:21:20.284961 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.stg_stateprovince"
[0m15:21:20.286253 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_stateprovince"
[0m15:21:20.287139 [debug] [Thread-1 (]: On model.dbt_project_25.stg_stateprovince: BEGIN
[0m15:21:20.287966 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:21:20.451777 [debug] [Thread-1 (]: SQL status: BEGIN in 0.163 seconds
[0m15:21:20.453783 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_stateprovince"
[0m15:21:20.455675 [debug] [Thread-1 (]: On model.dbt_project_25.stg_stateprovince: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_stateprovince"} */

  
    

  create  table "BI_group4"."___staging"."stg_stateprovince__dbt_tmp"
  
  
    as
  
  (
    

SELECT
  stateprovinceid, 
  countryregioncode,
  territoryid,
  name AS regionname,
  stateprovincecode
FROM "BI_group4"."corentin"."stateprovince"

--run in terminal/shell: 
--dbt run --select stg_stateprovince

--(This will build the model as a new view/table in your dev schema, leaving the original data untouched)
  );
  
[0m15:21:20.470958 [debug] [Thread-1 (]: SQL status: SELECT 181 in 0.013 seconds
[0m15:21:20.481727 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_stateprovince"
[0m15:21:20.482624 [debug] [Thread-1 (]: On model.dbt_project_25.stg_stateprovince: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_stateprovince"} */
alter table "BI_group4"."___staging"."stg_stateprovince" rename to "stg_stateprovince__dbt_backup"
[0m15:21:20.494026 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m15:21:20.501309 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_stateprovince"
[0m15:21:20.502215 [debug] [Thread-1 (]: On model.dbt_project_25.stg_stateprovince: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_stateprovince"} */
alter table "BI_group4"."___staging"."stg_stateprovince__dbt_tmp" rename to "stg_stateprovince"
[0m15:21:20.513123 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m15:21:20.516912 [debug] [Thread-1 (]: On model.dbt_project_25.stg_stateprovince: COMMIT
[0m15:21:20.517826 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_stateprovince"
[0m15:21:20.518671 [debug] [Thread-1 (]: On model.dbt_project_25.stg_stateprovince: COMMIT
[0m15:21:20.531281 [debug] [Thread-1 (]: SQL status: COMMIT in 0.012 seconds
[0m15:21:20.540517 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."___staging"."stg_stateprovince__dbt_backup"
[0m15:21:20.542280 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_stateprovince"
[0m15:21:20.543166 [debug] [Thread-1 (]: On model.dbt_project_25.stg_stateprovince: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_stateprovince"} */
drop table if exists "BI_group4"."___staging"."stg_stateprovince__dbt_backup" cascade
[0m15:21:20.557888 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.014 seconds
[0m15:21:20.562028 [debug] [Thread-1 (]: On model.dbt_project_25.stg_stateprovince: Close
[0m15:21:20.564259 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31e8c37d-729c-4d14-a85a-46fd39f8c303', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef0967503e0>]}
[0m15:21:20.566657 [info ] [Thread-1 (]: 11 of 13 OK created sql table model ___staging.stg_stateprovince ............... [[32mSELECT 181[0m in 0.29s]
[0m15:21:20.568994 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.stg_stateprovince
[0m15:21:20.570242 [debug] [Thread-1 (]: Began running node model.dbt_project_25.storeclean
[0m15:21:20.571449 [info ] [Thread-1 (]: 12 of 13 START sql table model ___staging.storeclean ........................... [RUN]
[0m15:21:20.572452 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_25.stg_stateprovince, now model.dbt_project_25.storeclean)
[0m15:21:20.573350 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.storeclean
[0m15:21:20.578795 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.storeclean"
[0m15:21:20.580025 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.storeclean
[0m15:21:20.587094 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.storeclean"
[0m15:21:20.588386 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.storeclean"
[0m15:21:20.589254 [debug] [Thread-1 (]: On model.dbt_project_25.storeclean: BEGIN
[0m15:21:20.590072 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:21:20.754988 [debug] [Thread-1 (]: SQL status: BEGIN in 0.165 seconds
[0m15:21:20.756963 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.storeclean"
[0m15:21:20.758803 [debug] [Thread-1 (]: On model.dbt_project_25.storeclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.storeclean"} */

  
    

  create  table "BI_group4"."___staging"."storeclean__dbt_tmp"
  
  
    as
  
  (
    

select
    salespersonid as salerid,
    storename,
    businessentityid
from "BI_group4"."corentin"."store1"
  );
  
[0m15:21:20.774776 [debug] [Thread-1 (]: SQL status: SELECT 701 in 0.014 seconds
[0m15:21:20.785106 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.storeclean"
[0m15:21:20.786108 [debug] [Thread-1 (]: On model.dbt_project_25.storeclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.storeclean"} */
alter table "BI_group4"."___staging"."storeclean" rename to "storeclean__dbt_backup"
[0m15:21:20.797343 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m15:21:20.805827 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.storeclean"
[0m15:21:20.806727 [debug] [Thread-1 (]: On model.dbt_project_25.storeclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.storeclean"} */
alter table "BI_group4"."___staging"."storeclean__dbt_tmp" rename to "storeclean"
[0m15:21:20.817308 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m15:21:20.820995 [debug] [Thread-1 (]: On model.dbt_project_25.storeclean: COMMIT
[0m15:21:20.821943 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.storeclean"
[0m15:21:20.822815 [debug] [Thread-1 (]: On model.dbt_project_25.storeclean: COMMIT
[0m15:21:20.835979 [debug] [Thread-1 (]: SQL status: COMMIT in 0.012 seconds
[0m15:21:20.844002 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."___staging"."storeclean__dbt_backup"
[0m15:21:20.846282 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.storeclean"
[0m15:21:20.847412 [debug] [Thread-1 (]: On model.dbt_project_25.storeclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.storeclean"} */
drop table if exists "BI_group4"."___staging"."storeclean__dbt_backup" cascade
[0m15:21:20.863172 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.014 seconds
[0m15:21:20.866839 [debug] [Thread-1 (]: On model.dbt_project_25.storeclean: Close
[0m15:21:20.868554 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31e8c37d-729c-4d14-a85a-46fd39f8c303', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef096775280>]}
[0m15:21:20.870338 [info ] [Thread-1 (]: 12 of 13 OK created sql table model ___staging.storeclean ...................... [[32mSELECT 701[0m in 0.30s]
[0m15:21:20.872112 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.storeclean
[0m15:21:20.873063 [debug] [Thread-1 (]: Began running node model.dbt_project_25.my_second_dbt_model
[0m15:21:20.874267 [info ] [Thread-1 (]: 13 of 13 START sql view model _.my_second_dbt_model ............................ [RUN]
[0m15:21:20.875266 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_25.storeclean, now model.dbt_project_25.my_second_dbt_model)
[0m15:21:20.876153 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.my_second_dbt_model
[0m15:21:20.881117 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.my_second_dbt_model"
[0m15:21:20.882337 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.my_second_dbt_model
[0m15:21:20.916627 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.my_second_dbt_model"
[0m15:21:20.917975 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_second_dbt_model"
[0m15:21:20.918878 [debug] [Thread-1 (]: On model.dbt_project_25.my_second_dbt_model: BEGIN
[0m15:21:20.919701 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:21:21.078772 [debug] [Thread-1 (]: SQL status: BEGIN in 0.159 seconds
[0m15:21:21.080577 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_second_dbt_model"
[0m15:21:21.082203 [debug] [Thread-1 (]: On model.dbt_project_25.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.my_second_dbt_model"} */

  create view "BI_group4"."_"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "BI_group4"."_"."my_first_dbt_model"
where id = 1
  );
[0m15:21:21.095862 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m15:21:21.105475 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_second_dbt_model"
[0m15:21:21.106372 [debug] [Thread-1 (]: On model.dbt_project_25.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.my_second_dbt_model"} */
alter table "BI_group4"."_"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m15:21:21.117054 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m15:21:21.120212 [debug] [Thread-1 (]: On model.dbt_project_25.my_second_dbt_model: COMMIT
[0m15:21:21.121106 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_second_dbt_model"
[0m15:21:21.121939 [debug] [Thread-1 (]: On model.dbt_project_25.my_second_dbt_model: COMMIT
[0m15:21:21.134278 [debug] [Thread-1 (]: SQL status: COMMIT in 0.011 seconds
[0m15:21:21.143530 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."_"."my_second_dbt_model__dbt_backup"
[0m15:21:21.149782 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_second_dbt_model"
[0m15:21:21.150675 [debug] [Thread-1 (]: On model.dbt_project_25.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.my_second_dbt_model"} */
drop view if exists "BI_group4"."_"."my_second_dbt_model__dbt_backup" cascade
[0m15:21:21.161001 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.009 seconds
[0m15:21:21.163634 [debug] [Thread-1 (]: On model.dbt_project_25.my_second_dbt_model: Close
[0m15:21:21.164948 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31e8c37d-729c-4d14-a85a-46fd39f8c303', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef09839d460>]}
[0m15:21:21.166316 [info ] [Thread-1 (]: 13 of 13 OK created sql view model _.my_second_dbt_model ....................... [[32mCREATE VIEW[0m in 0.29s]
[0m15:21:21.167669 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.my_second_dbt_model
[0m15:21:21.170367 [debug] [MainThread]: Using postgres connection "master"
[0m15:21:21.171187 [debug] [MainThread]: On master: BEGIN
[0m15:21:21.171947 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:21:21.330226 [debug] [MainThread]: SQL status: BEGIN in 0.158 seconds
[0m15:21:21.332046 [debug] [MainThread]: On master: COMMIT
[0m15:21:21.333663 [debug] [MainThread]: Using postgres connection "master"
[0m15:21:21.335094 [debug] [MainThread]: On master: COMMIT
[0m15:21:21.345918 [debug] [MainThread]: SQL status: COMMIT in 0.010 seconds
[0m15:21:21.347626 [debug] [MainThread]: On master: Close
[0m15:21:21.349803 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:21:21.351337 [debug] [MainThread]: Connection 'model.dbt_project_25.my_second_dbt_model' was properly closed.
[0m15:21:21.353151 [info ] [MainThread]: 
[0m15:21:21.354888 [info ] [MainThread]: Finished running 12 table models, 1 view model in 0 hours 0 minutes and 5.90 seconds (5.90s).
[0m15:21:21.359346 [debug] [MainThread]: Command end result
[0m15:21:21.408830 [debug] [MainThread]: Wrote artifact WritableManifest to /home/corentin.vanlandeghe@Digital-Grenoble.local/BI_DBT/target/manifest.json
[0m15:21:21.411976 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/corentin.vanlandeghe@Digital-Grenoble.local/BI_DBT/target/semantic_manifest.json
[0m15:21:21.423047 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/corentin.vanlandeghe@Digital-Grenoble.local/BI_DBT/target/run_results.json
[0m15:21:21.423834 [info ] [MainThread]: 
[0m15:21:21.424678 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:21:21.425435 [info ] [MainThread]: 
[0m15:21:21.426252 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=13
[0m15:21:21.427997 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.923361, "process_in_blocks": "0", "process_kernel_time": 0.530959, "process_mem_max_rss": "129316", "process_out_blocks": "3992", "process_user_time": 6.166762}
[0m15:21:21.429015 [debug] [MainThread]: Command `dbt run` succeeded at 15:21:21.428824 after 7.92 seconds
[0m15:21:21.429855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef09b4a68a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef096730a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef096730b30>]}
[0m15:21:21.430723 [debug] [MainThread]: Flushing usage events
[0m15:21:21.944401 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:24:20.902294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c0ec4e435f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c0ec4c050a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c0ec4b18830>]}


============================== 15:24:20.908071 | 6ce5a2b5-909e-4b21-9d64-971f9e7769fa ==============================
[0m15:24:20.908071 [info ] [MainThread]: Running with dbt=1.10.2
[0m15:24:20.909227 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/corentin.vanlandeghe@Digital-Grenoble.local/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/corentin.vanlandeghe@Digital-Grenoble.local/BI_DBT/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --model addressclean', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:24:20.910156 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of
`--resource-type model --select`
[0m15:24:20.911026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6ce5a2b5-909e-4b21-9d64-971f9e7769fa', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c0ec44dac30>]}
[0m15:24:21.234011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6ce5a2b5-909e-4b21-9d64-971f9e7769fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c0ec40fb980>]}
[0m15:24:21.359956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6ce5a2b5-909e-4b21-9d64-971f9e7769fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c0ec3fa7260>]}
[0m15:24:21.361433 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:24:21.545048 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m15:24:21.778182 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:24:21.779011 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:24:21.865321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ce5a2b5-909e-4b21-9d64-971f9e7769fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c0ec3fa71a0>]}
[0m15:24:22.027244 [debug] [MainThread]: Wrote artifact WritableManifest to /home/corentin.vanlandeghe@Digital-Grenoble.local/BI_DBT/target/manifest.json
[0m15:24:22.030259 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/corentin.vanlandeghe@Digital-Grenoble.local/BI_DBT/target/semantic_manifest.json
[0m15:24:22.053672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6ce5a2b5-909e-4b21-9d64-971f9e7769fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c0ec2dc1790>]}
[0m15:24:22.054663 [info ] [MainThread]: Found 13 models, 4 data tests, 11 sources, 549 macros
[0m15:24:22.055470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ce5a2b5-909e-4b21-9d64-971f9e7769fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c0ec3171e20>]}
[0m15:24:22.058388 [info ] [MainThread]: 
[0m15:24:22.059205 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:24:22.059947 [info ] [MainThread]: 
[0m15:24:22.060981 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:24:22.063197 [debug] [ThreadPool]: Acquiring new postgres connection 'list_BI_group4'
[0m15:24:22.140833 [debug] [ThreadPool]: Using postgres connection "list_BI_group4"
[0m15:24:22.141746 [debug] [ThreadPool]: On list_BI_group4: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "connection_name": "list_BI_group4"} */

    select distinct nspname from pg_namespace
  
[0m15:24:22.142658 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:24:22.306396 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.163 seconds
[0m15:24:22.311739 [debug] [ThreadPool]: On list_BI_group4: Close
[0m15:24:22.328873 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_BI_group4, now list_BI_group4__)
[0m15:24:22.344088 [debug] [ThreadPool]: Using postgres connection "list_BI_group4__"
[0m15:24:22.344893 [debug] [ThreadPool]: On list_BI_group4__: BEGIN
[0m15:24:22.345601 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:24:22.502630 [debug] [ThreadPool]: SQL status: BEGIN in 0.157 seconds
[0m15:24:22.504318 [debug] [ThreadPool]: Using postgres connection "list_BI_group4__"
[0m15:24:22.505936 [debug] [ThreadPool]: On list_BI_group4__: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "connection_name": "list_BI_group4__"} */
select
      'BI_group4' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike '_'
    union all
    select
      'BI_group4' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike '_'
    union all
    select
      'BI_group4' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike '_'
  
[0m15:24:22.521799 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.014 seconds
[0m15:24:22.526930 [debug] [ThreadPool]: On list_BI_group4__: ROLLBACK
[0m15:24:22.538293 [debug] [ThreadPool]: On list_BI_group4__: Close
[0m15:24:22.540363 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_BI_group4__, now list_BI_group4____staging)
[0m15:24:22.549817 [debug] [ThreadPool]: Using postgres connection "list_BI_group4____staging"
[0m15:24:22.550603 [debug] [ThreadPool]: On list_BI_group4____staging: BEGIN
[0m15:24:22.551300 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:24:22.715436 [debug] [ThreadPool]: SQL status: BEGIN in 0.164 seconds
[0m15:24:22.717137 [debug] [ThreadPool]: Using postgres connection "list_BI_group4____staging"
[0m15:24:22.718774 [debug] [ThreadPool]: On list_BI_group4____staging: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "connection_name": "list_BI_group4____staging"} */
select
      'BI_group4' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike '___staging'
    union all
    select
      'BI_group4' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike '___staging'
    union all
    select
      'BI_group4' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike '___staging'
  
[0m15:24:22.736706 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.016 seconds
[0m15:24:22.742227 [debug] [ThreadPool]: On list_BI_group4____staging: ROLLBACK
[0m15:24:22.753706 [debug] [ThreadPool]: On list_BI_group4____staging: Close
[0m15:24:22.773711 [debug] [MainThread]: Using postgres connection "master"
[0m15:24:22.774511 [debug] [MainThread]: On master: BEGIN
[0m15:24:22.775218 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:24:22.937278 [debug] [MainThread]: SQL status: BEGIN in 0.162 seconds
[0m15:24:22.961708 [debug] [MainThread]: Using postgres connection "master"
[0m15:24:22.963693 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:24:22.996491 [debug] [MainThread]: SQL status: SELECT 3 in 0.031 seconds
[0m15:24:23.002194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ce5a2b5-909e-4b21-9d64-971f9e7769fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c0ec40cf200>]}
[0m15:24:23.003760 [debug] [MainThread]: On master: ROLLBACK
[0m15:24:23.015107 [debug] [MainThread]: Using postgres connection "master"
[0m15:24:23.016196 [debug] [MainThread]: On master: BEGIN
[0m15:24:23.037953 [debug] [MainThread]: SQL status: BEGIN in 0.021 seconds
[0m15:24:23.039610 [debug] [MainThread]: On master: COMMIT
[0m15:24:23.041149 [debug] [MainThread]: Using postgres connection "master"
[0m15:24:23.042655 [debug] [MainThread]: On master: COMMIT
[0m15:24:23.053857 [debug] [MainThread]: SQL status: COMMIT in 0.010 seconds
[0m15:24:23.055525 [debug] [MainThread]: On master: Close
[0m15:24:23.063004 [debug] [Thread-1 (]: Began running node model.dbt_project_25.addressclean
[0m15:24:23.065301 [info ] [Thread-1 (]: 1 of 1 START sql table model ___staging.addressclean ........................... [RUN]
[0m15:24:23.067379 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_BI_group4____staging, now model.dbt_project_25.addressclean)
[0m15:24:23.069162 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.addressclean
[0m15:24:23.084840 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.addressclean"
[0m15:24:23.086163 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.addressclean
[0m15:24:23.156351 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.addressclean"
[0m15:24:23.157718 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.addressclean"
[0m15:24:23.158584 [debug] [Thread-1 (]: On model.dbt_project_25.addressclean: BEGIN
[0m15:24:23.159367 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:24:23.327557 [debug] [Thread-1 (]: SQL status: BEGIN in 0.168 seconds
[0m15:24:23.329432 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.addressclean"
[0m15:24:23.331209 [debug] [Thread-1 (]: On model.dbt_project_25.addressclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.addressclean"} */

  
    

  create  table "BI_group4"."___staging"."addressclean__dbt_tmp"
  
  
    as
  
  (
    

select
    salespersonid as salerid,
    storename,
    businessentityid
from "BI_group4"."corentin"."store1"
  );
  
[0m15:24:23.348718 [debug] [Thread-1 (]: SQL status: SELECT 701 in 0.016 seconds
[0m15:24:23.374722 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.addressclean"
[0m15:24:23.375629 [debug] [Thread-1 (]: On model.dbt_project_25.addressclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.addressclean"} */
alter table "BI_group4"."___staging"."addressclean" rename to "addressclean__dbt_backup"
[0m15:24:23.389019 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.012 seconds
[0m15:24:23.397056 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.addressclean"
[0m15:24:23.398120 [debug] [Thread-1 (]: On model.dbt_project_25.addressclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.addressclean"} */
alter table "BI_group4"."___staging"."addressclean__dbt_tmp" rename to "addressclean"
[0m15:24:23.409703 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m15:24:23.440633 [debug] [Thread-1 (]: On model.dbt_project_25.addressclean: COMMIT
[0m15:24:23.441535 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.addressclean"
[0m15:24:23.442342 [debug] [Thread-1 (]: On model.dbt_project_25.addressclean: COMMIT
[0m15:24:23.455043 [debug] [Thread-1 (]: SQL status: COMMIT in 0.012 seconds
[0m15:24:23.470917 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."___staging"."addressclean__dbt_backup"
[0m15:24:23.481063 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.addressclean"
[0m15:24:23.481944 [debug] [Thread-1 (]: On model.dbt_project_25.addressclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.addressclean"} */
drop table if exists "BI_group4"."___staging"."addressclean__dbt_backup" cascade
[0m15:24:23.499269 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.016 seconds
[0m15:24:23.506891 [debug] [Thread-1 (]: On model.dbt_project_25.addressclean: Close
[0m15:24:23.511174 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ce5a2b5-909e-4b21-9d64-971f9e7769fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c0ec1dab830>]}
[0m15:24:23.513111 [info ] [Thread-1 (]: 1 of 1 OK created sql table model ___staging.addressclean ...................... [[32mSELECT 701[0m in 0.44s]
[0m15:24:23.514939 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.addressclean
[0m15:24:23.518342 [debug] [MainThread]: Using postgres connection "master"
[0m15:24:23.520021 [debug] [MainThread]: On master: BEGIN
[0m15:24:23.521537 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:24:23.679926 [debug] [MainThread]: SQL status: BEGIN in 0.158 seconds
[0m15:24:23.681730 [debug] [MainThread]: On master: COMMIT
[0m15:24:23.683306 [debug] [MainThread]: Using postgres connection "master"
[0m15:24:23.684832 [debug] [MainThread]: On master: COMMIT
[0m15:24:23.695310 [debug] [MainThread]: SQL status: COMMIT in 0.009 seconds
[0m15:24:23.696645 [debug] [MainThread]: On master: Close
[0m15:24:23.698744 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:24:23.700250 [debug] [MainThread]: Connection 'model.dbt_project_25.addressclean' was properly closed.
[0m15:24:23.701821 [info ] [MainThread]: 
[0m15:24:23.703485 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.64 seconds (1.64s).
[0m15:24:23.706407 [debug] [MainThread]: Command end result
[0m15:24:23.754718 [debug] [MainThread]: Wrote artifact WritableManifest to /home/corentin.vanlandeghe@Digital-Grenoble.local/BI_DBT/target/manifest.json
[0m15:24:23.757815 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/corentin.vanlandeghe@Digital-Grenoble.local/BI_DBT/target/semantic_manifest.json
[0m15:24:23.768222 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/corentin.vanlandeghe@Digital-Grenoble.local/BI_DBT/target/run_results.json
[0m15:24:23.769003 [info ] [MainThread]: 
[0m15:24:23.769902 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:24:23.770677 [info ] [MainThread]: 
[0m15:24:23.771473 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m15:24:23.772583 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:24:23.774336 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.9807706, "process_in_blocks": "0", "process_kernel_time": 0.43498, "process_mem_max_rss": "124216", "process_out_blocks": "2472", "process_user_time": 4.135818}
[0m15:24:23.775344 [debug] [MainThread]: Command `dbt run` succeeded at 15:24:23.775156 after 2.98 seconds
[0m15:24:23.776168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c0ec4c050a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c0ec4f6ab70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c0ec4fb2030>]}
[0m15:24:23.777028 [debug] [MainThread]: Flushing usage events
[0m15:24:24.311042 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:25:25.995074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x742ad2e78ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x742ad28591f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x742ad13c4410>]}


============================== 15:25:26.000819 | 1972d666-b52a-48ae-bf91-71730c45905c ==============================
[0m15:25:26.000819 [info ] [MainThread]: Running with dbt=1.10.2
[0m15:25:26.016144 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/corentin.vanlandeghe@Digital-Grenoble.local/BI_DBT/logs', 'profiles_dir': '/home/corentin.vanlandeghe@Digital-Grenoble.local/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --model addressclean', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:25:26.017105 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of
`--resource-type model --select`
[0m15:25:26.017987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1972d666-b52a-48ae-bf91-71730c45905c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x742ad0d54b60>]}
[0m15:25:26.343962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1972d666-b52a-48ae-bf91-71730c45905c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x742ad0b41340>]}
[0m15:25:26.469991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1972d666-b52a-48ae-bf91-71730c45905c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x742ad1760fe0>]}
[0m15:25:26.471445 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:25:26.651097 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m15:25:26.883847 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:25:26.884696 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:25:26.971116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1972d666-b52a-48ae-bf91-71730c45905c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x742acfd78770>]}
[0m15:25:27.133192 [debug] [MainThread]: Wrote artifact WritableManifest to /home/corentin.vanlandeghe@Digital-Grenoble.local/BI_DBT/target/manifest.json
[0m15:25:27.136186 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/corentin.vanlandeghe@Digital-Grenoble.local/BI_DBT/target/semantic_manifest.json
[0m15:25:27.159632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1972d666-b52a-48ae-bf91-71730c45905c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x742acf101820>]}
[0m15:25:27.160589 [info ] [MainThread]: Found 13 models, 4 data tests, 11 sources, 549 macros
[0m15:25:27.161377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1972d666-b52a-48ae-bf91-71730c45905c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x742acfd78bf0>]}
[0m15:25:27.164297 [info ] [MainThread]: 
[0m15:25:27.165127 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:25:27.165865 [info ] [MainThread]: 
[0m15:25:27.166902 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:25:27.169099 [debug] [ThreadPool]: Acquiring new postgres connection 'list_BI_group4'
[0m15:25:27.243051 [debug] [ThreadPool]: Using postgres connection "list_BI_group4"
[0m15:25:27.243988 [debug] [ThreadPool]: On list_BI_group4: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "connection_name": "list_BI_group4"} */

    select distinct nspname from pg_namespace
  
[0m15:25:27.244754 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:25:27.502984 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.258 seconds
[0m15:25:27.508097 [debug] [ThreadPool]: On list_BI_group4: Close
[0m15:25:27.522490 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_BI_group4, now list_BI_group4____staging)
[0m15:25:27.535747 [debug] [ThreadPool]: Using postgres connection "list_BI_group4____staging"
[0m15:25:27.536594 [debug] [ThreadPool]: On list_BI_group4____staging: BEGIN
[0m15:25:27.537341 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:25:27.694908 [debug] [ThreadPool]: SQL status: BEGIN in 0.157 seconds
[0m15:25:27.696618 [debug] [ThreadPool]: Using postgres connection "list_BI_group4____staging"
[0m15:25:27.698247 [debug] [ThreadPool]: On list_BI_group4____staging: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "connection_name": "list_BI_group4____staging"} */
select
      'BI_group4' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike '___staging'
    union all
    select
      'BI_group4' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike '___staging'
    union all
    select
      'BI_group4' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike '___staging'
  
[0m15:25:27.713116 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.013 seconds
[0m15:25:27.718693 [debug] [ThreadPool]: On list_BI_group4____staging: ROLLBACK
[0m15:25:27.729952 [debug] [ThreadPool]: On list_BI_group4____staging: Close
[0m15:25:27.732482 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_BI_group4____staging, now list_BI_group4__)
[0m15:25:27.745119 [debug] [ThreadPool]: Using postgres connection "list_BI_group4__"
[0m15:25:27.746396 [debug] [ThreadPool]: On list_BI_group4__: BEGIN
[0m15:25:27.747599 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:25:27.905587 [debug] [ThreadPool]: SQL status: BEGIN in 0.158 seconds
[0m15:25:27.907262 [debug] [ThreadPool]: Using postgres connection "list_BI_group4__"
[0m15:25:27.908910 [debug] [ThreadPool]: On list_BI_group4__: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "connection_name": "list_BI_group4__"} */
select
      'BI_group4' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike '_'
    union all
    select
      'BI_group4' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike '_'
    union all
    select
      'BI_group4' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike '_'
  
[0m15:25:27.923939 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.013 seconds
[0m15:25:27.929438 [debug] [ThreadPool]: On list_BI_group4__: ROLLBACK
[0m15:25:27.940426 [debug] [ThreadPool]: On list_BI_group4__: Close
[0m15:25:27.955894 [debug] [MainThread]: Using postgres connection "master"
[0m15:25:27.956771 [debug] [MainThread]: On master: BEGIN
[0m15:25:27.957566 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:25:28.115161 [debug] [MainThread]: SQL status: BEGIN in 0.157 seconds
[0m15:25:28.116821 [debug] [MainThread]: Using postgres connection "master"
[0m15:25:28.118728 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:25:28.144193 [debug] [MainThread]: SQL status: SELECT 3 in 0.024 seconds
[0m15:25:28.150062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1972d666-b52a-48ae-bf91-71730c45905c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x742ad0536fc0>]}
[0m15:25:28.151524 [debug] [MainThread]: On master: ROLLBACK
[0m15:25:28.162095 [debug] [MainThread]: Using postgres connection "master"
[0m15:25:28.163294 [debug] [MainThread]: On master: BEGIN
[0m15:25:28.183644 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m15:25:28.185268 [debug] [MainThread]: On master: COMMIT
[0m15:25:28.186841 [debug] [MainThread]: Using postgres connection "master"
[0m15:25:28.188331 [debug] [MainThread]: On master: COMMIT
[0m15:25:28.199274 [debug] [MainThread]: SQL status: COMMIT in 0.009 seconds
[0m15:25:28.200193 [debug] [MainThread]: On master: Close
[0m15:25:28.206199 [debug] [Thread-1 (]: Began running node model.dbt_project_25.addressclean
[0m15:25:28.208478 [info ] [Thread-1 (]: 1 of 1 START sql table model ___staging.addressclean ........................... [RUN]
[0m15:25:28.210540 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_BI_group4__, now model.dbt_project_25.addressclean)
[0m15:25:28.211923 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.addressclean
[0m15:25:28.228464 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.addressclean"
[0m15:25:28.229802 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.addressclean
[0m15:25:28.300181 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.addressclean"
[0m15:25:28.301574 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.addressclean"
[0m15:25:28.302444 [debug] [Thread-1 (]: On model.dbt_project_25.addressclean: BEGIN
[0m15:25:28.303264 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:25:28.503085 [debug] [Thread-1 (]: SQL status: BEGIN in 0.200 seconds
[0m15:25:28.505003 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.addressclean"
[0m15:25:28.506860 [debug] [Thread-1 (]: On model.dbt_project_25.addressclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.addressclean"} */

  
    

  create  table "BI_group4"."___staging"."addressclean__dbt_tmp"
  
  
    as
  
  (
    

select
    salespersonid as salerid,
    storename,
    businessentityid
from "BI_group4"."corentin"."store1"
  );
  
[0m15:25:28.524354 [debug] [Thread-1 (]: SQL status: SELECT 701 in 0.016 seconds
[0m15:25:28.548605 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.addressclean"
[0m15:25:28.549491 [debug] [Thread-1 (]: On model.dbt_project_25.addressclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.addressclean"} */
alter table "BI_group4"."___staging"."addressclean__dbt_tmp" rename to "addressclean"
[0m15:25:28.561141 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.011 seconds
[0m15:25:28.588241 [debug] [Thread-1 (]: On model.dbt_project_25.addressclean: COMMIT
[0m15:25:28.589193 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.addressclean"
[0m15:25:28.590040 [debug] [Thread-1 (]: On model.dbt_project_25.addressclean: COMMIT
[0m15:25:28.604790 [debug] [Thread-1 (]: SQL status: COMMIT in 0.014 seconds
[0m15:25:28.621140 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."___staging"."addressclean__dbt_backup"
[0m15:25:28.631536 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.addressclean"
[0m15:25:28.632425 [debug] [Thread-1 (]: On model.dbt_project_25.addressclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.addressclean"} */
drop table if exists "BI_group4"."___staging"."addressclean__dbt_backup" cascade
[0m15:25:28.643369 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.010 seconds
[0m15:25:28.651345 [debug] [Thread-1 (]: On model.dbt_project_25.addressclean: Close
[0m15:25:28.656157 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1972d666-b52a-48ae-bf91-71730c45905c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x742ad333bc80>]}
[0m15:25:28.657471 [info ] [Thread-1 (]: 1 of 1 OK created sql table model ___staging.addressclean ...................... [[32mSELECT 701[0m in 0.44s]
[0m15:25:28.658776 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.addressclean
[0m15:25:28.661732 [debug] [MainThread]: Using postgres connection "master"
[0m15:25:28.662840 [debug] [MainThread]: On master: BEGIN
[0m15:25:28.663848 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:25:28.829095 [debug] [MainThread]: SQL status: BEGIN in 0.165 seconds
[0m15:25:28.830890 [debug] [MainThread]: On master: COMMIT
[0m15:25:28.832462 [debug] [MainThread]: Using postgres connection "master"
[0m15:25:28.833999 [debug] [MainThread]: On master: COMMIT
[0m15:25:28.845250 [debug] [MainThread]: SQL status: COMMIT in 0.010 seconds
[0m15:25:28.846926 [debug] [MainThread]: On master: Close
[0m15:25:28.849040 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:25:28.850576 [debug] [MainThread]: Connection 'model.dbt_project_25.addressclean' was properly closed.
[0m15:25:28.852118 [info ] [MainThread]: 
[0m15:25:28.853810 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.69 seconds (1.69s).
[0m15:25:28.856083 [debug] [MainThread]: Command end result
[0m15:25:28.904276 [debug] [MainThread]: Wrote artifact WritableManifest to /home/corentin.vanlandeghe@Digital-Grenoble.local/BI_DBT/target/manifest.json
[0m15:25:28.907430 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/corentin.vanlandeghe@Digital-Grenoble.local/BI_DBT/target/semantic_manifest.json
[0m15:25:28.917893 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/corentin.vanlandeghe@Digital-Grenoble.local/BI_DBT/target/run_results.json
[0m15:25:28.918701 [info ] [MainThread]: 
[0m15:25:28.919586 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:25:28.920347 [info ] [MainThread]: 
[0m15:25:28.921160 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m15:25:28.922256 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:25:28.924007 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.0389104, "process_in_blocks": "0", "process_kernel_time": 0.428782, "process_mem_max_rss": "124048", "process_out_blocks": "2480", "process_user_time": 4.117907}
[0m15:25:28.925027 [debug] [MainThread]: Command `dbt run` succeeded at 15:25:28.924834 after 3.04 seconds
[0m15:25:28.925867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x742ad2e78ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x742ad0ead640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x742ad19435c0>]}
[0m15:25:28.926738 [debug] [MainThread]: Flushing usage events
[0m15:25:29.367404 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:28:42.526101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a840a382780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8409e54f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a840c06b050>]}


============================== 15:28:42.531895 | 070f3460-768b-4e1c-b499-d4bc2fcd51ff ==============================
[0m15:28:42.531895 [info ] [MainThread]: Running with dbt=1.10.2
[0m15:28:42.533038 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/corentin.vanlandeghe@Digital-Grenoble.local/BI_DBT/logs', 'version_check': 'True', 'profiles_dir': '/home/corentin.vanlandeghe@Digital-Grenoble.local/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --model addressclean', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:28:42.533958 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of
`--resource-type model --select`
[0m15:28:42.534834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '070f3460-768b-4e1c-b499-d4bc2fcd51ff', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8409e01640>]}
[0m15:28:42.863449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '070f3460-768b-4e1c-b499-d4bc2fcd51ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8409ace000>]}
[0m15:28:42.990615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '070f3460-768b-4e1c-b499-d4bc2fcd51ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8409c199d0>]}
[0m15:28:42.992073 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:28:43.177835 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m15:28:43.411194 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m15:28:43.412331 [debug] [MainThread]: Partial parsing: added file: dbt_project_25://models/staging/adressclean.sql
[0m15:28:43.413091 [debug] [MainThread]: Partial parsing: deleted file: dbt_project_25://models/staging/addressclean.sql
[0m15:28:43.939261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '070f3460-768b-4e1c-b499-d4bc2fcd51ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a84081f7fb0>]}
[0m15:28:44.097246 [debug] [MainThread]: Wrote artifact WritableManifest to /home/corentin.vanlandeghe@Digital-Grenoble.local/BI_DBT/target/manifest.json
[0m15:28:44.100288 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/corentin.vanlandeghe@Digital-Grenoble.local/BI_DBT/target/semantic_manifest.json
[0m15:28:44.123983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '070f3460-768b-4e1c-b499-d4bc2fcd51ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8407d26330>]}
[0m15:28:44.124952 [info ] [MainThread]: Found 13 models, 4 data tests, 11 sources, 549 macros
[0m15:28:44.125773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '070f3460-768b-4e1c-b499-d4bc2fcd51ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a84081f3950>]}
[0m15:28:44.127065 [warn ] [MainThread]: The selection criterion 'addressclean' does not match any enabled nodes
[0m15:28:44.129313 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m15:28:44.130441 [debug] [MainThread]: Command end result
[0m15:28:44.176249 [debug] [MainThread]: Wrote artifact WritableManifest to /home/corentin.vanlandeghe@Digital-Grenoble.local/BI_DBT/target/manifest.json
[0m15:28:44.179250 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/corentin.vanlandeghe@Digital-Grenoble.local/BI_DBT/target/semantic_manifest.json
[0m15:28:44.184945 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/corentin.vanlandeghe@Digital-Grenoble.local/BI_DBT/target/run_results.json
[0m15:28:44.186051 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:28:44.187822 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.7719897, "process_in_blocks": "0", "process_kernel_time": 0.349414, "process_mem_max_rss": "118352", "process_out_blocks": "3632", "process_user_time": 4.038238}
[0m15:28:44.188847 [debug] [MainThread]: Command `dbt run` succeeded at 15:28:44.188653 after 1.77 seconds
[0m15:28:44.189711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a840a7dc380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8409bcfd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a840c544a10>]}
[0m15:28:44.190590 [debug] [MainThread]: Flushing usage events
[0m15:28:44.637843 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:31:39.204235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721b8235e3c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721b822de600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721b81be0c50>]}


============================== 15:31:39.209987 | f93c6a7d-8f75-401f-8cd0-d8f578fa560c ==============================
[0m15:31:39.209987 [info ] [MainThread]: Running with dbt=1.10.2
[0m15:31:39.211147 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/corentin.vanlandeghe@Digital-Grenoble.local/.dbt', 'log_path': '/home/corentin.vanlandeghe@Digital-Grenoble.local/BI_DBT/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --model addressclean --show-all-deprecations', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:31:39.212081 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of
`--resource-type model --select`
[0m15:31:39.212945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f93c6a7d-8f75-401f-8cd0-d8f578fa560c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721b81afd820>]}
[0m15:31:39.534947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f93c6a7d-8f75-401f-8cd0-d8f578fa560c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721b8155df70>]}
[0m15:31:39.660014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f93c6a7d-8f75-401f-8cd0-d8f578fa560c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721b8182a9c0>]}
[0m15:31:39.661549 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:31:39.844788 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m15:31:40.075706 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:31:40.076544 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:31:40.162177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f93c6a7d-8f75-401f-8cd0-d8f578fa560c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721b80d80f80>]}
[0m15:31:40.323720 [debug] [MainThread]: Wrote artifact WritableManifest to /home/corentin.vanlandeghe@Digital-Grenoble.local/BI_DBT/target/manifest.json
[0m15:31:40.326723 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/corentin.vanlandeghe@Digital-Grenoble.local/BI_DBT/target/semantic_manifest.json
[0m15:31:40.350204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f93c6a7d-8f75-401f-8cd0-d8f578fa560c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721b815d3950>]}
[0m15:31:40.351196 [info ] [MainThread]: Found 13 models, 4 data tests, 11 sources, 549 macros
[0m15:31:40.352016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f93c6a7d-8f75-401f-8cd0-d8f578fa560c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721b8269fad0>]}
[0m15:31:40.353289 [warn ] [MainThread]: The selection criterion 'addressclean' does not match any enabled nodes
[0m15:31:40.355553 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m15:31:40.359074 [debug] [MainThread]: Command end result
[0m15:31:40.404949 [debug] [MainThread]: Wrote artifact WritableManifest to /home/corentin.vanlandeghe@Digital-Grenoble.local/BI_DBT/target/manifest.json
[0m15:31:40.407918 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/corentin.vanlandeghe@Digital-Grenoble.local/BI_DBT/target/semantic_manifest.json
[0m15:31:40.413606 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/corentin.vanlandeghe@Digital-Grenoble.local/BI_DBT/target/run_results.json
[0m15:31:40.414619 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
[0m15:31:40.416368 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.3208587, "process_in_blocks": "0", "process_kernel_time": 0.346257, "process_mem_max_rss": "115120", "process_out_blocks": "2440", "process_user_time": 3.581319}
[0m15:31:40.417390 [debug] [MainThread]: Command `dbt run` succeeded at 15:31:40.417198 after 1.32 seconds
[0m15:31:40.418235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721b81c92db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721b81113860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721b81c075c0>]}
[0m15:31:40.419106 [debug] [MainThread]: Flushing usage events
[0m15:31:40.873983 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:33:05.287016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74d4aa4924e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74d4a94aefc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74d4aaf1b680>]}


============================== 15:33:05.292699 | 584a89e2-9f50-49a6-b46f-dbdc8744fda3 ==============================
[0m15:33:05.292699 [info ] [MainThread]: Running with dbt=1.10.2
[0m15:33:05.293858 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/corentin.vanlandeghe@Digital-Grenoble.local/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/corentin.vanlandeghe@Digital-Grenoble.local/BI_DBT/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m15:33:05.616742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '584a89e2-9f50-49a6-b46f-dbdc8744fda3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74d4a8379c10>]}
[0m15:33:05.742747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '584a89e2-9f50-49a6-b46f-dbdc8744fda3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74d4a90c5070>]}
[0m15:33:05.744222 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:33:05.927722 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m15:33:06.160828 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:33:06.161662 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:33:06.248163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '584a89e2-9f50-49a6-b46f-dbdc8744fda3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74d4a7f440e0>]}
[0m15:33:06.409754 [debug] [MainThread]: Wrote artifact WritableManifest to /home/corentin.vanlandeghe@Digital-Grenoble.local/BI_DBT/target/manifest.json
[0m15:33:06.412763 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/corentin.vanlandeghe@Digital-Grenoble.local/BI_DBT/target/semantic_manifest.json
[0m15:33:06.436084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '584a89e2-9f50-49a6-b46f-dbdc8744fda3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74d4a6f18e60>]}
[0m15:33:06.437050 [info ] [MainThread]: Found 13 models, 4 data tests, 11 sources, 549 macros
[0m15:33:06.437859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '584a89e2-9f50-49a6-b46f-dbdc8744fda3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74d4a7f73dd0>]}
[0m15:33:06.442032 [info ] [MainThread]: 
[0m15:33:06.442857 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:33:06.443582 [info ] [MainThread]: 
[0m15:33:06.444617 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:33:06.453440 [debug] [ThreadPool]: Acquiring new postgres connection 'list_BI_group4'
[0m15:33:06.527591 [debug] [ThreadPool]: Using postgres connection "list_BI_group4"
[0m15:33:06.528479 [debug] [ThreadPool]: On list_BI_group4: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "connection_name": "list_BI_group4"} */

    select distinct nspname from pg_namespace
  
[0m15:33:06.529228 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:33:06.736643 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.207 seconds
[0m15:33:06.741879 [debug] [ThreadPool]: On list_BI_group4: Close
[0m15:33:06.747813 [debug] [ThreadPool]: Using postgres connection "list_BI_group4"
[0m15:33:06.748772 [debug] [ThreadPool]: On list_BI_group4: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "connection_name": "list_BI_group4"} */

    select distinct nspname from pg_namespace
  
[0m15:33:06.749530 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:33:06.921648 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.172 seconds
[0m15:33:06.926600 [debug] [ThreadPool]: On list_BI_group4: Close
[0m15:33:06.933827 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_BI_group4, now list_BI_group4__)
[0m15:33:06.950522 [debug] [ThreadPool]: Using postgres connection "list_BI_group4__"
[0m15:33:06.951293 [debug] [ThreadPool]: On list_BI_group4__: BEGIN
[0m15:33:06.951996 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:33:07.112108 [debug] [ThreadPool]: SQL status: BEGIN in 0.160 seconds
[0m15:33:07.113866 [debug] [ThreadPool]: Using postgres connection "list_BI_group4__"
[0m15:33:07.115475 [debug] [ThreadPool]: On list_BI_group4__: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "connection_name": "list_BI_group4__"} */
select
      'BI_group4' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike '_'
    union all
    select
      'BI_group4' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike '_'
    union all
    select
      'BI_group4' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike '_'
  
[0m15:33:07.134749 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.018 seconds
[0m15:33:07.139893 [debug] [ThreadPool]: On list_BI_group4__: ROLLBACK
[0m15:33:07.151021 [debug] [ThreadPool]: On list_BI_group4__: Close
[0m15:33:07.152611 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_BI_group4__, now list_BI_group4____staging)
[0m15:33:07.158982 [debug] [ThreadPool]: Using postgres connection "list_BI_group4____staging"
[0m15:33:07.159772 [debug] [ThreadPool]: On list_BI_group4____staging: BEGIN
[0m15:33:07.160468 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:33:07.320814 [debug] [ThreadPool]: SQL status: BEGIN in 0.160 seconds
[0m15:33:07.322546 [debug] [ThreadPool]: Using postgres connection "list_BI_group4____staging"
[0m15:33:07.324154 [debug] [ThreadPool]: On list_BI_group4____staging: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "connection_name": "list_BI_group4____staging"} */
select
      'BI_group4' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike '___staging'
    union all
    select
      'BI_group4' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike '___staging'
    union all
    select
      'BI_group4' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike '___staging'
  
[0m15:33:07.338878 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.013 seconds
[0m15:33:07.343727 [debug] [ThreadPool]: On list_BI_group4____staging: ROLLBACK
[0m15:33:07.354792 [debug] [ThreadPool]: On list_BI_group4____staging: Close
[0m15:33:07.372948 [debug] [MainThread]: Using postgres connection "master"
[0m15:33:07.373726 [debug] [MainThread]: On master: BEGIN
[0m15:33:07.374418 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:33:07.533482 [debug] [MainThread]: SQL status: BEGIN in 0.159 seconds
[0m15:33:07.535238 [debug] [MainThread]: Using postgres connection "master"
[0m15:33:07.537161 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:33:07.580918 [debug] [MainThread]: SQL status: SELECT 3 in 0.042 seconds
[0m15:33:07.587329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '584a89e2-9f50-49a6-b46f-dbdc8744fda3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74d4a83ba240>]}
[0m15:33:07.589120 [debug] [MainThread]: On master: ROLLBACK
[0m15:33:07.599482 [debug] [MainThread]: Using postgres connection "master"
[0m15:33:07.600618 [debug] [MainThread]: On master: BEGIN
[0m15:33:07.622873 [debug] [MainThread]: SQL status: BEGIN in 0.021 seconds
[0m15:33:07.624547 [debug] [MainThread]: On master: COMMIT
[0m15:33:07.626077 [debug] [MainThread]: Using postgres connection "master"
[0m15:33:07.627573 [debug] [MainThread]: On master: COMMIT
[0m15:33:07.638240 [debug] [MainThread]: SQL status: COMMIT in 0.009 seconds
[0m15:33:07.639227 [debug] [MainThread]: On master: Close
[0m15:33:07.646093 [debug] [Thread-1 (]: Began running node model.dbt_project_25.adressclean
[0m15:33:07.648361 [info ] [Thread-1 (]: 1 of 13 START sql table model ___staging.adressclean ........................... [RUN]
[0m15:33:07.650267 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_BI_group4____staging, now model.dbt_project_25.adressclean)
[0m15:33:07.651887 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.adressclean
[0m15:33:07.669249 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.adressclean"
[0m15:33:07.670483 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.adressclean
[0m15:33:07.742588 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.adressclean"
[0m15:33:07.743927 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.adressclean"
[0m15:33:07.744826 [debug] [Thread-1 (]: On model.dbt_project_25.adressclean: BEGIN
[0m15:33:07.745631 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:33:07.903970 [debug] [Thread-1 (]: SQL status: BEGIN in 0.158 seconds
[0m15:33:07.905887 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.adressclean"
[0m15:33:07.907699 [debug] [Thread-1 (]: On model.dbt_project_25.adressclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.adressclean"} */

  
    

  create  table "BI_group4"."___staging"."adressclean__dbt_tmp"
  
  
    as
  
  (
    

SELECT
  addressid, 
  addressline1 as adressline,
  city,
  postalcode,
  stateprovinceid
FROM "BI_group4"."corentin"."address"
  );
  
[0m15:33:07.925214 [debug] [Thread-1 (]: SQL status: SELECT 1675 in 0.016 seconds
[0m15:33:07.948310 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.adressclean"
[0m15:33:07.949207 [debug] [Thread-1 (]: On model.dbt_project_25.adressclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.adressclean"} */
alter table "BI_group4"."___staging"."adressclean__dbt_tmp" rename to "adressclean"
[0m15:33:07.960364 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m15:33:07.989674 [debug] [Thread-1 (]: On model.dbt_project_25.adressclean: COMMIT
[0m15:33:07.990571 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.adressclean"
[0m15:33:07.991385 [debug] [Thread-1 (]: On model.dbt_project_25.adressclean: COMMIT
[0m15:33:08.006820 [debug] [Thread-1 (]: SQL status: COMMIT in 0.014 seconds
[0m15:33:08.023544 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."___staging"."adressclean__dbt_backup"
[0m15:33:08.033923 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.adressclean"
[0m15:33:08.034846 [debug] [Thread-1 (]: On model.dbt_project_25.adressclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.adressclean"} */
drop table if exists "BI_group4"."___staging"."adressclean__dbt_backup" cascade
[0m15:33:08.046181 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.010 seconds
[0m15:33:08.052216 [debug] [Thread-1 (]: On model.dbt_project_25.adressclean: Close
[0m15:33:08.055342 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '584a89e2-9f50-49a6-b46f-dbdc8744fda3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74d4aadfbb90>]}
[0m15:33:08.056702 [info ] [Thread-1 (]: 1 of 13 OK created sql table model ___staging.adressclean ...................... [[32mSELECT 1675[0m in 0.40s]
[0m15:33:08.058004 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.adressclean
[0m15:33:08.058930 [debug] [Thread-1 (]: Began running node model.dbt_project_25.customerclean
[0m15:33:08.060177 [info ] [Thread-1 (]: 2 of 13 START sql table model ___staging.customerclean ......................... [RUN]
[0m15:33:08.061184 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_25.adressclean, now model.dbt_project_25.customerclean)
[0m15:33:08.062062 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.customerclean
[0m15:33:08.067616 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.customerclean"
[0m15:33:08.068816 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.customerclean
[0m15:33:08.075979 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.customerclean"
[0m15:33:08.077230 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.customerclean"
[0m15:33:08.078099 [debug] [Thread-1 (]: On model.dbt_project_25.customerclean: BEGIN
[0m15:33:08.078918 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:33:08.237136 [debug] [Thread-1 (]: SQL status: BEGIN in 0.158 seconds
[0m15:33:08.239103 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.customerclean"
[0m15:33:08.240918 [debug] [Thread-1 (]: On model.dbt_project_25.customerclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.customerclean"} */

  
    

  create  table "BI_group4"."___staging"."customerclean__dbt_tmp"
  
  
    as
  
  (
    

select
    customerid, 
	storeid,
    territoryid
from "BI_group4"."corentin"."customer"
  );
  
[0m15:33:08.265291 [debug] [Thread-1 (]: SQL status: SELECT 19820 in 0.023 seconds
[0m15:33:08.276118 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.customerclean"
[0m15:33:08.277007 [debug] [Thread-1 (]: On model.dbt_project_25.customerclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.customerclean"} */
alter table "BI_group4"."___staging"."customerclean" rename to "customerclean__dbt_backup"
[0m15:33:08.288041 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m15:33:08.295067 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.customerclean"
[0m15:33:08.295946 [debug] [Thread-1 (]: On model.dbt_project_25.customerclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.customerclean"} */
alter table "BI_group4"."___staging"."customerclean__dbt_tmp" rename to "customerclean"
[0m15:33:08.306925 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m15:33:08.316838 [debug] [Thread-1 (]: On model.dbt_project_25.customerclean: COMMIT
[0m15:33:08.317744 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.customerclean"
[0m15:33:08.318581 [debug] [Thread-1 (]: On model.dbt_project_25.customerclean: COMMIT
[0m15:33:08.335543 [debug] [Thread-1 (]: SQL status: COMMIT in 0.016 seconds
[0m15:33:08.344512 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."___staging"."customerclean__dbt_backup"
[0m15:33:08.346281 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.customerclean"
[0m15:33:08.347174 [debug] [Thread-1 (]: On model.dbt_project_25.customerclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.customerclean"} */
drop table if exists "BI_group4"."___staging"."customerclean__dbt_backup" cascade
[0m15:33:08.369006 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.021 seconds
[0m15:33:08.374149 [debug] [Thread-1 (]: On model.dbt_project_25.customerclean: Close
[0m15:33:08.376085 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '584a89e2-9f50-49a6-b46f-dbdc8744fda3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74d4a67f0b00>]}
[0m15:33:08.378060 [info ] [Thread-1 (]: 2 of 13 OK created sql table model ___staging.customerclean .................... [[32mSELECT 19820[0m in 0.31s]
[0m15:33:08.379994 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.customerclean
[0m15:33:08.381393 [debug] [Thread-1 (]: Began running node model.dbt_project_25.dateclean
[0m15:33:08.383184 [info ] [Thread-1 (]: 3 of 13 START sql table model ___staging.dateclean ............................. [RUN]
[0m15:33:08.384298 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_25.customerclean, now model.dbt_project_25.dateclean)
[0m15:33:08.385184 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.dateclean
[0m15:33:08.390661 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.dateclean"
[0m15:33:08.391875 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.dateclean
[0m15:33:08.401419 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.dateclean"
[0m15:33:08.402752 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.dateclean"
[0m15:33:08.403642 [debug] [Thread-1 (]: On model.dbt_project_25.dateclean: BEGIN
[0m15:33:08.404451 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:33:08.571159 [debug] [Thread-1 (]: SQL status: BEGIN in 0.166 seconds
[0m15:33:08.573139 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.dateclean"
[0m15:33:08.574964 [debug] [Thread-1 (]: On model.dbt_project_25.dateclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.dateclean"} */

  
    

  create  table "BI_group4"."___staging"."dateclean__dbt_tmp"
  
  
    as
  
  (
    

select
    date_day,
    day_of_week as number_day_week,
    day_of_week_name as day_name
    
from "BI_group4"."corentin"."date"
  );
  
[0m15:33:08.591723 [debug] [Thread-1 (]: SQL status: SELECT 731 in 0.015 seconds
[0m15:33:08.604718 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.dateclean"
[0m15:33:08.605689 [debug] [Thread-1 (]: On model.dbt_project_25.dateclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.dateclean"} */
alter table "BI_group4"."___staging"."dateclean" rename to "dateclean__dbt_backup"
[0m15:33:08.616901 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m15:33:08.624133 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.dateclean"
[0m15:33:08.625261 [debug] [Thread-1 (]: On model.dbt_project_25.dateclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.dateclean"} */
alter table "BI_group4"."___staging"."dateclean__dbt_tmp" rename to "dateclean"
[0m15:33:08.636337 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m15:33:08.641143 [debug] [Thread-1 (]: On model.dbt_project_25.dateclean: COMMIT
[0m15:33:08.642390 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.dateclean"
[0m15:33:08.643594 [debug] [Thread-1 (]: On model.dbt_project_25.dateclean: COMMIT
[0m15:33:08.657712 [debug] [Thread-1 (]: SQL status: COMMIT in 0.013 seconds
[0m15:33:08.666565 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."___staging"."dateclean__dbt_backup"
[0m15:33:08.668312 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.dateclean"
[0m15:33:08.669185 [debug] [Thread-1 (]: On model.dbt_project_25.dateclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.dateclean"} */
drop table if exists "BI_group4"."___staging"."dateclean__dbt_backup" cascade
[0m15:33:08.684222 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.014 seconds
[0m15:33:08.688196 [debug] [Thread-1 (]: On model.dbt_project_25.dateclean: Close
[0m15:33:08.690410 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '584a89e2-9f50-49a6-b46f-dbdc8744fda3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74d4a57a70e0>]}
[0m15:33:08.692806 [info ] [Thread-1 (]: 3 of 13 OK created sql table model ___staging.dateclean ........................ [[32mSELECT 731[0m in 0.31s]
[0m15:33:08.695125 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.dateclean
[0m15:33:08.696481 [debug] [Thread-1 (]: Began running node model.dbt_project_25.my_first_dbt_model
[0m15:33:08.697532 [info ] [Thread-1 (]: 4 of 13 START sql table model _.my_first_dbt_model ............................. [RUN]
[0m15:33:08.698686 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_25.dateclean, now model.dbt_project_25.my_first_dbt_model)
[0m15:33:08.699572 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.my_first_dbt_model
[0m15:33:08.704629 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.my_first_dbt_model"
[0m15:33:08.705856 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.my_first_dbt_model
[0m15:33:08.712915 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.my_first_dbt_model"
[0m15:33:08.714181 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_first_dbt_model"
[0m15:33:08.715069 [debug] [Thread-1 (]: On model.dbt_project_25.my_first_dbt_model: BEGIN
[0m15:33:08.715892 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:33:08.903961 [debug] [Thread-1 (]: SQL status: BEGIN in 0.188 seconds
[0m15:33:08.905934 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_first_dbt_model"
[0m15:33:08.907807 [debug] [Thread-1 (]: On model.dbt_project_25.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.my_first_dbt_model"} */

  
    

  create  table "BI_group4"."_"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m15:33:08.922892 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.013 seconds
[0m15:33:08.934075 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_first_dbt_model"
[0m15:33:08.935569 [debug] [Thread-1 (]: On model.dbt_project_25.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.my_first_dbt_model"} */
alter table "BI_group4"."_"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m15:33:08.946804 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m15:33:08.954365 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_first_dbt_model"
[0m15:33:08.955635 [debug] [Thread-1 (]: On model.dbt_project_25.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.my_first_dbt_model"} */
alter table "BI_group4"."_"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m15:33:08.966738 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m15:33:08.971362 [debug] [Thread-1 (]: On model.dbt_project_25.my_first_dbt_model: COMMIT
[0m15:33:08.972604 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_first_dbt_model"
[0m15:33:08.973774 [debug] [Thread-1 (]: On model.dbt_project_25.my_first_dbt_model: COMMIT
[0m15:33:08.987942 [debug] [Thread-1 (]: SQL status: COMMIT in 0.013 seconds
[0m15:33:08.997389 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."_"."my_first_dbt_model__dbt_backup"
[0m15:33:08.999153 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_first_dbt_model"
[0m15:33:09.000034 [debug] [Thread-1 (]: On model.dbt_project_25.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.my_first_dbt_model"} */
drop table if exists "BI_group4"."_"."my_first_dbt_model__dbt_backup" cascade
[0m15:33:09.016073 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.015 seconds
[0m15:33:09.020718 [debug] [Thread-1 (]: On model.dbt_project_25.my_first_dbt_model: Close
[0m15:33:09.023184 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '584a89e2-9f50-49a6-b46f-dbdc8744fda3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74d4a6382f00>]}
[0m15:33:09.025845 [info ] [Thread-1 (]: 4 of 13 OK created sql table model _.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.32s]
[0m15:33:09.028196 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.my_first_dbt_model
[0m15:33:09.029135 [debug] [Thread-1 (]: Began running node model.dbt_project_25.personclean
[0m15:33:09.030604 [info ] [Thread-1 (]: 5 of 13 START sql table model ___staging.personclean ........................... [RUN]
[0m15:33:09.031666 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_25.my_first_dbt_model, now model.dbt_project_25.personclean)
[0m15:33:09.032608 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.personclean
[0m15:33:09.038223 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.personclean"
[0m15:33:09.039545 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.personclean
[0m15:33:09.127700 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.personclean"
[0m15:33:09.129124 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.personclean"
[0m15:33:09.130031 [debug] [Thread-1 (]: On model.dbt_project_25.personclean: BEGIN
[0m15:33:09.130842 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:33:09.296001 [debug] [Thread-1 (]: SQL status: BEGIN in 0.165 seconds
[0m15:33:09.297978 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.personclean"
[0m15:33:09.299802 [debug] [Thread-1 (]: On model.dbt_project_25.personclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.personclean"} */

  
    

  create  table "BI_group4"."___staging"."personclean__dbt_tmp"
  
  
    as
  
  (
    

select
    businessentityid,
    firstname,
    lastname

from "BI_group4"."corentin"."person"
  );
  
[0m15:33:09.319288 [debug] [Thread-1 (]: SQL status: SELECT 2057 in 0.018 seconds
[0m15:33:09.330981 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.personclean"
[0m15:33:09.331869 [debug] [Thread-1 (]: On model.dbt_project_25.personclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.personclean"} */
alter table "BI_group4"."___staging"."personclean" rename to "personclean__dbt_backup"
[0m15:33:09.343544 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.011 seconds
[0m15:33:09.351330 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.personclean"
[0m15:33:09.352225 [debug] [Thread-1 (]: On model.dbt_project_25.personclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.personclean"} */
alter table "BI_group4"."___staging"."personclean__dbt_tmp" rename to "personclean"
[0m15:33:09.363872 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.011 seconds
[0m15:33:09.369529 [debug] [Thread-1 (]: On model.dbt_project_25.personclean: COMMIT
[0m15:33:09.370583 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.personclean"
[0m15:33:09.371397 [debug] [Thread-1 (]: On model.dbt_project_25.personclean: COMMIT
[0m15:33:09.384586 [debug] [Thread-1 (]: SQL status: COMMIT in 0.012 seconds
[0m15:33:09.392785 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."___staging"."personclean__dbt_backup"
[0m15:33:09.395011 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.personclean"
[0m15:33:09.396118 [debug] [Thread-1 (]: On model.dbt_project_25.personclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.personclean"} */
drop table if exists "BI_group4"."___staging"."personclean__dbt_backup" cascade
[0m15:33:09.412405 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.015 seconds
[0m15:33:09.417628 [debug] [Thread-1 (]: On model.dbt_project_25.personclean: Close
[0m15:33:09.420108 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '584a89e2-9f50-49a6-b46f-dbdc8744fda3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74d4a575f1d0>]}
[0m15:33:09.421450 [info ] [Thread-1 (]: 5 of 13 OK created sql table model ___staging.personclean ...................... [[32mSELECT 2057[0m in 0.39s]
[0m15:33:09.422735 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.personclean
[0m15:33:09.423665 [debug] [Thread-1 (]: Began running node model.dbt_project_25.productsubcategoryclean
[0m15:33:09.424869 [info ] [Thread-1 (]: 6 of 13 START sql table model ___staging.productsubcategoryclean ............... [RUN]
[0m15:33:09.425870 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_25.personclean, now model.dbt_project_25.productsubcategoryclean)
[0m15:33:09.426752 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.productsubcategoryclean
[0m15:33:09.432232 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.productsubcategoryclean"
[0m15:33:09.433464 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.productsubcategoryclean
[0m15:33:09.440418 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.productsubcategoryclean"
[0m15:33:09.441715 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.productsubcategoryclean"
[0m15:33:09.442607 [debug] [Thread-1 (]: On model.dbt_project_25.productsubcategoryclean: BEGIN
[0m15:33:09.443441 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:33:09.611201 [debug] [Thread-1 (]: SQL status: BEGIN in 0.167 seconds
[0m15:33:09.613188 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.productsubcategoryclean"
[0m15:33:09.615032 [debug] [Thread-1 (]: On model.dbt_project_25.productsubcategoryclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.productsubcategoryclean"} */

  
    

  create  table "BI_group4"."___staging"."productsubcategoryclean__dbt_tmp"
  
  
    as
  
  (
    

select
    productsubcategoryid, 
	productcategoryid,
    name as subcategoryname
from "BI_group4"."corentin"."productsubcategory"
  );
  
[0m15:33:09.629906 [debug] [Thread-1 (]: SQL status: SELECT 37 in 0.013 seconds
[0m15:33:09.640917 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.productsubcategoryclean"
[0m15:33:09.642179 [debug] [Thread-1 (]: On model.dbt_project_25.productsubcategoryclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.productsubcategoryclean"} */
alter table "BI_group4"."___staging"."productsubcategoryclean" rename to "productsubcategoryclean__dbt_backup"
[0m15:33:09.653138 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m15:33:09.663053 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.productsubcategoryclean"
[0m15:33:09.663955 [debug] [Thread-1 (]: On model.dbt_project_25.productsubcategoryclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.productsubcategoryclean"} */
alter table "BI_group4"."___staging"."productsubcategoryclean__dbt_tmp" rename to "productsubcategoryclean"
[0m15:33:09.674906 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m15:33:09.678319 [debug] [Thread-1 (]: On model.dbt_project_25.productsubcategoryclean: COMMIT
[0m15:33:09.679215 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.productsubcategoryclean"
[0m15:33:09.680054 [debug] [Thread-1 (]: On model.dbt_project_25.productsubcategoryclean: COMMIT
[0m15:33:09.692936 [debug] [Thread-1 (]: SQL status: COMMIT in 0.012 seconds
[0m15:33:09.698484 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."___staging"."productsubcategoryclean__dbt_backup"
[0m15:33:09.700608 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.productsubcategoryclean"
[0m15:33:09.701654 [debug] [Thread-1 (]: On model.dbt_project_25.productsubcategoryclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.productsubcategoryclean"} */
drop table if exists "BI_group4"."___staging"."productsubcategoryclean__dbt_backup" cascade
[0m15:33:09.717003 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.014 seconds
[0m15:33:09.722279 [debug] [Thread-1 (]: On model.dbt_project_25.productsubcategoryclean: Close
[0m15:33:09.724185 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '584a89e2-9f50-49a6-b46f-dbdc8744fda3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74d4a5702420>]}
[0m15:33:09.726151 [info ] [Thread-1 (]: 6 of 13 OK created sql table model ___staging.productsubcategoryclean .......... [[32mSELECT 37[0m in 0.30s]
[0m15:33:09.728072 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.productsubcategoryclean
[0m15:33:09.729464 [debug] [Thread-1 (]: Began running node model.dbt_project_25.salesorderdetailsclean
[0m15:33:09.731201 [info ] [Thread-1 (]: 7 of 13 START sql table model ___staging.salesorderdetailsclean ................ [RUN]
[0m15:33:09.732552 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_25.productsubcategoryclean, now model.dbt_project_25.salesorderdetailsclean)
[0m15:33:09.733431 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.salesorderdetailsclean
[0m15:33:09.739076 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.salesorderdetailsclean"
[0m15:33:09.740307 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.salesorderdetailsclean
[0m15:33:09.750208 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.salesorderdetailsclean"
[0m15:33:09.751484 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderdetailsclean"
[0m15:33:09.752370 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderdetailsclean: BEGIN
[0m15:33:09.753206 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:33:09.916948 [debug] [Thread-1 (]: SQL status: BEGIN in 0.163 seconds
[0m15:33:09.918926 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderdetailsclean"
[0m15:33:09.920827 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderdetailsclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.salesorderdetailsclean"} */

  
    

  create  table "BI_group4"."___staging"."salesorderdetailsclean__dbt_tmp"
  
  
    as
  
  (
    

select 
	salesorderid, 
	unitprice,
	orderqty as orderquantity,
	productid,
	unitpricediscount as discount

from "BI_group4"."corentin"."salesorderdetail"
  );
  
[0m15:33:09.945647 [debug] [Thread-1 (]: SQL status: SELECT 5716 in 0.023 seconds
[0m15:33:09.954926 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderdetailsclean"
[0m15:33:09.955832 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderdetailsclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.salesorderdetailsclean"} */
alter table "BI_group4"."___staging"."salesorderdetailsclean" rename to "salesorderdetailsclean__dbt_backup"
[0m15:33:09.967103 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m15:33:09.972854 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderdetailsclean"
[0m15:33:09.973757 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderdetailsclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.salesorderdetailsclean"} */
alter table "BI_group4"."___staging"."salesorderdetailsclean__dbt_tmp" rename to "salesorderdetailsclean"
[0m15:33:09.984968 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m15:33:09.992048 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderdetailsclean: COMMIT
[0m15:33:09.993696 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderdetailsclean"
[0m15:33:09.994541 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderdetailsclean: COMMIT
[0m15:33:10.007838 [debug] [Thread-1 (]: SQL status: COMMIT in 0.012 seconds
[0m15:33:10.015791 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."___staging"."salesorderdetailsclean__dbt_backup"
[0m15:33:10.017895 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderdetailsclean"
[0m15:33:10.018956 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderdetailsclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.salesorderdetailsclean"} */
drop table if exists "BI_group4"."___staging"."salesorderdetailsclean__dbt_backup" cascade
[0m15:33:10.034062 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.014 seconds
[0m15:33:10.039284 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderdetailsclean: Close
[0m15:33:10.041801 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '584a89e2-9f50-49a6-b46f-dbdc8744fda3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74d4a57ac110>]}
[0m15:33:10.044139 [info ] [Thread-1 (]: 7 of 13 OK created sql table model ___staging.salesorderdetailsclean ........... [[32mSELECT 5716[0m in 0.31s]
[0m15:33:10.045421 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.salesorderdetailsclean
[0m15:33:10.046353 [debug] [Thread-1 (]: Began running node model.dbt_project_25.salesorderheaderclean
[0m15:33:10.047559 [info ] [Thread-1 (]: 8 of 13 START sql table model ___staging.salesorderheaderclean ................. [RUN]
[0m15:33:10.048557 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_25.salesorderdetailsclean, now model.dbt_project_25.salesorderheaderclean)
[0m15:33:10.049462 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.salesorderheaderclean
[0m15:33:10.055096 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.salesorderheaderclean"
[0m15:33:10.056321 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.salesorderheaderclean
[0m15:33:10.063472 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.salesorderheaderclean"
[0m15:33:10.064754 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderheaderclean"
[0m15:33:10.065641 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderheaderclean: BEGIN
[0m15:33:10.066455 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:33:10.222024 [debug] [Thread-1 (]: SQL status: BEGIN in 0.155 seconds
[0m15:33:10.223994 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderheaderclean"
[0m15:33:10.225849 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderheaderclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.salesorderheaderclean"} */

  
    

  create  table "BI_group4"."___staging"."salesorderheaderclean__dbt_tmp"
  
  
    as
  
  (
    

select
    orderdate,
    salesorderid,
    territoryid,
    salespersonid as salerid,
    billtoaddressid,
    customerid,
    salespersonid,
    shipdate
from "BI_group4"."corentin"."salesorderheader"
  );
  
[0m15:33:10.241398 [debug] [Thread-1 (]: SQL status: SELECT 1566 in 0.014 seconds
[0m15:33:10.253307 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderheaderclean"
[0m15:33:10.254885 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderheaderclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.salesorderheaderclean"} */
alter table "BI_group4"."___staging"."salesorderheaderclean" rename to "salesorderheaderclean__dbt_backup"
[0m15:33:10.265639 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m15:33:10.276062 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderheaderclean"
[0m15:33:10.276950 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderheaderclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.salesorderheaderclean"} */
alter table "BI_group4"."___staging"."salesorderheaderclean__dbt_tmp" rename to "salesorderheaderclean"
[0m15:33:10.288355 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m15:33:10.294623 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderheaderclean: COMMIT
[0m15:33:10.295712 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderheaderclean"
[0m15:33:10.296567 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderheaderclean: COMMIT
[0m15:33:10.315411 [debug] [Thread-1 (]: SQL status: COMMIT in 0.018 seconds
[0m15:33:10.324742 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."___staging"."salesorderheaderclean__dbt_backup"
[0m15:33:10.327043 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.salesorderheaderclean"
[0m15:33:10.327924 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderheaderclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.salesorderheaderclean"} */
drop table if exists "BI_group4"."___staging"."salesorderheaderclean__dbt_backup" cascade
[0m15:33:10.343571 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.014 seconds
[0m15:33:10.348377 [debug] [Thread-1 (]: On model.dbt_project_25.salesorderheaderclean: Close
[0m15:33:10.350873 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '584a89e2-9f50-49a6-b46f-dbdc8744fda3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74d4a6368920>]}
[0m15:33:10.353536 [info ] [Thread-1 (]: 8 of 13 OK created sql table model ___staging.salesorderheaderclean ............ [[32mSELECT 1566[0m in 0.30s]
[0m15:33:10.356028 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.salesorderheaderclean
[0m15:33:10.356955 [debug] [Thread-1 (]: Began running node model.dbt_project_25.stg_product
[0m15:33:10.358157 [info ] [Thread-1 (]: 9 of 13 START sql table model ___staging.stg_product ........................... [RUN]
[0m15:33:10.359174 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_25.salesorderheaderclean, now model.dbt_project_25.stg_product)
[0m15:33:10.360075 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.stg_product
[0m15:33:10.365768 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.stg_product"
[0m15:33:10.366985 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.stg_product
[0m15:33:10.377103 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.stg_product"
[0m15:33:10.378437 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_product"
[0m15:33:10.379349 [debug] [Thread-1 (]: On model.dbt_project_25.stg_product: BEGIN
[0m15:33:10.380163 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:33:10.541218 [debug] [Thread-1 (]: SQL status: BEGIN in 0.161 seconds
[0m15:33:10.543142 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_product"
[0m15:33:10.544991 [debug] [Thread-1 (]: On model.dbt_project_25.stg_product: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_product"} */

  
    

  create  table "BI_group4"."___staging"."stg_product__dbt_tmp"
  
  
    as
  
  (
    

SELECT
  productid, 
  name AS itemname
FROM "BI_group4"."corentin"."product"

--run in terminal/shell: 
--dbt run --select stg_product

--(This will build the model as a new view/table in your dev schema, leaving the original data untouched)
  );
  
[0m15:33:10.561172 [debug] [Thread-1 (]: SQL status: SELECT 504 in 0.014 seconds
[0m15:33:10.571404 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_product"
[0m15:33:10.572568 [debug] [Thread-1 (]: On model.dbt_project_25.stg_product: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_product"} */
alter table "BI_group4"."___staging"."stg_product" rename to "stg_product__dbt_backup"
[0m15:33:10.584106 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m15:33:10.589982 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_product"
[0m15:33:10.590924 [debug] [Thread-1 (]: On model.dbt_project_25.stg_product: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_product"} */
alter table "BI_group4"."___staging"."stg_product__dbt_tmp" rename to "stg_product"
[0m15:33:10.601890 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m15:33:10.606295 [debug] [Thread-1 (]: On model.dbt_project_25.stg_product: COMMIT
[0m15:33:10.607332 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_product"
[0m15:33:10.608171 [debug] [Thread-1 (]: On model.dbt_project_25.stg_product: COMMIT
[0m15:33:10.620946 [debug] [Thread-1 (]: SQL status: COMMIT in 0.012 seconds
[0m15:33:10.628830 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."___staging"."stg_product__dbt_backup"
[0m15:33:10.630922 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_product"
[0m15:33:10.631967 [debug] [Thread-1 (]: On model.dbt_project_25.stg_product: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_product"} */
drop table if exists "BI_group4"."___staging"."stg_product__dbt_backup" cascade
[0m15:33:10.646755 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.014 seconds
[0m15:33:10.651790 [debug] [Thread-1 (]: On model.dbt_project_25.stg_product: Close
[0m15:33:10.654263 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '584a89e2-9f50-49a6-b46f-dbdc8744fda3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74d4a7f2d8e0>]}
[0m15:33:10.656840 [info ] [Thread-1 (]: 9 of 13 OK created sql table model ___staging.stg_product ...................... [[32mSELECT 504[0m in 0.29s]
[0m15:33:10.658109 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.stg_product
[0m15:33:10.659032 [debug] [Thread-1 (]: Began running node model.dbt_project_25.stg_productcat
[0m15:33:10.660217 [info ] [Thread-1 (]: 10 of 13 START sql table model ___staging.stg_productcat ....................... [RUN]
[0m15:33:10.661215 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_25.stg_product, now model.dbt_project_25.stg_productcat)
[0m15:33:10.662103 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.stg_productcat
[0m15:33:10.667692 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.stg_productcat"
[0m15:33:10.668934 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.stg_productcat
[0m15:33:10.676113 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.stg_productcat"
[0m15:33:10.677374 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_productcat"
[0m15:33:10.678259 [debug] [Thread-1 (]: On model.dbt_project_25.stg_productcat: BEGIN
[0m15:33:10.679092 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:33:10.896935 [debug] [Thread-1 (]: SQL status: BEGIN in 0.217 seconds
[0m15:33:10.898883 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_productcat"
[0m15:33:10.900724 [debug] [Thread-1 (]: On model.dbt_project_25.stg_productcat: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_productcat"} */

  
    

  create  table "BI_group4"."___staging"."stg_productcat__dbt_tmp"
  
  
    as
  
  (
    

SELECT
  productcategoryid, 
  name AS itemcategoryname
FROM "BI_group4"."corentin"."productcategory"

--run in terminal/shell: 
--dbt run --select stg_productcat

--(This will build the model as a new view/table in your dev schema, leaving the original data untouched)
  );
  
[0m15:33:10.915842 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.013 seconds
[0m15:33:10.927121 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_productcat"
[0m15:33:10.928754 [debug] [Thread-1 (]: On model.dbt_project_25.stg_productcat: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_productcat"} */
alter table "BI_group4"."___staging"."stg_productcat" rename to "stg_productcat__dbt_backup"
[0m15:33:10.940386 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m15:33:10.950346 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_productcat"
[0m15:33:10.951230 [debug] [Thread-1 (]: On model.dbt_project_25.stg_productcat: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_productcat"} */
alter table "BI_group4"."___staging"."stg_productcat__dbt_tmp" rename to "stg_productcat"
[0m15:33:10.962352 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m15:33:10.968019 [debug] [Thread-1 (]: On model.dbt_project_25.stg_productcat: COMMIT
[0m15:33:10.969203 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_productcat"
[0m15:33:10.970029 [debug] [Thread-1 (]: On model.dbt_project_25.stg_productcat: COMMIT
[0m15:33:10.982172 [debug] [Thread-1 (]: SQL status: COMMIT in 0.011 seconds
[0m15:33:10.990084 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."___staging"."stg_productcat__dbt_backup"
[0m15:33:10.991942 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_productcat"
[0m15:33:10.992868 [debug] [Thread-1 (]: On model.dbt_project_25.stg_productcat: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_productcat"} */
drop table if exists "BI_group4"."___staging"."stg_productcat__dbt_backup" cascade
[0m15:33:11.008227 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.014 seconds
[0m15:33:11.011624 [debug] [Thread-1 (]: On model.dbt_project_25.stg_productcat: Close
[0m15:33:11.013310 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '584a89e2-9f50-49a6-b46f-dbdc8744fda3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74d4a636a0f0>]}
[0m15:33:11.015123 [info ] [Thread-1 (]: 10 of 13 OK created sql table model ___staging.stg_productcat .................. [[32mSELECT 4[0m in 0.35s]
[0m15:33:11.016991 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.stg_productcat
[0m15:33:11.018344 [debug] [Thread-1 (]: Began running node model.dbt_project_25.stg_stateprovince
[0m15:33:11.019615 [info ] [Thread-1 (]: 11 of 13 START sql table model ___staging.stg_stateprovince .................... [RUN]
[0m15:33:11.020777 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_25.stg_productcat, now model.dbt_project_25.stg_stateprovince)
[0m15:33:11.021678 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.stg_stateprovince
[0m15:33:11.027261 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.stg_stateprovince"
[0m15:33:11.028483 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.stg_stateprovince
[0m15:33:11.038364 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.stg_stateprovince"
[0m15:33:11.039667 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_stateprovince"
[0m15:33:11.040548 [debug] [Thread-1 (]: On model.dbt_project_25.stg_stateprovince: BEGIN
[0m15:33:11.041356 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:33:11.209427 [debug] [Thread-1 (]: SQL status: BEGIN in 0.168 seconds
[0m15:33:11.211363 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_stateprovince"
[0m15:33:11.213212 [debug] [Thread-1 (]: On model.dbt_project_25.stg_stateprovince: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_stateprovince"} */

  
    

  create  table "BI_group4"."___staging"."stg_stateprovince__dbt_tmp"
  
  
    as
  
  (
    

SELECT
  stateprovinceid, 
  countryregioncode,
  territoryid,
  name AS regionname,
  stateprovincecode
FROM "BI_group4"."corentin"."stateprovince"

--run in terminal/shell: 
--dbt run --select stg_stateprovince

--(This will build the model as a new view/table in your dev schema, leaving the original data untouched)
  );
  
[0m15:33:11.228540 [debug] [Thread-1 (]: SQL status: SELECT 181 in 0.013 seconds
[0m15:33:11.239612 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_stateprovince"
[0m15:33:11.240797 [debug] [Thread-1 (]: On model.dbt_project_25.stg_stateprovince: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_stateprovince"} */
alter table "BI_group4"."___staging"."stg_stateprovince" rename to "stg_stateprovince__dbt_backup"
[0m15:33:11.251900 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m15:33:11.261946 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_stateprovince"
[0m15:33:11.262832 [debug] [Thread-1 (]: On model.dbt_project_25.stg_stateprovince: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_stateprovince"} */
alter table "BI_group4"."___staging"."stg_stateprovince__dbt_tmp" rename to "stg_stateprovince"
[0m15:33:11.274289 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m15:33:11.280056 [debug] [Thread-1 (]: On model.dbt_project_25.stg_stateprovince: COMMIT
[0m15:33:11.281202 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_stateprovince"
[0m15:33:11.282039 [debug] [Thread-1 (]: On model.dbt_project_25.stg_stateprovince: COMMIT
[0m15:33:11.294332 [debug] [Thread-1 (]: SQL status: COMMIT in 0.011 seconds
[0m15:33:11.302359 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."___staging"."stg_stateprovince__dbt_backup"
[0m15:33:11.304555 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.stg_stateprovince"
[0m15:33:11.305560 [debug] [Thread-1 (]: On model.dbt_project_25.stg_stateprovince: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.stg_stateprovince"} */
drop table if exists "BI_group4"."___staging"."stg_stateprovince__dbt_backup" cascade
[0m15:33:11.320139 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.013 seconds
[0m15:33:11.323541 [debug] [Thread-1 (]: On model.dbt_project_25.stg_stateprovince: Close
[0m15:33:11.325238 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '584a89e2-9f50-49a6-b46f-dbdc8744fda3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74d4a57a6f60>]}
[0m15:33:11.327054 [info ] [Thread-1 (]: 11 of 13 OK created sql table model ___staging.stg_stateprovince ............... [[32mSELECT 181[0m in 0.30s]
[0m15:33:11.328835 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.stg_stateprovince
[0m15:33:11.330118 [debug] [Thread-1 (]: Began running node model.dbt_project_25.storeclean
[0m15:33:11.331548 [info ] [Thread-1 (]: 12 of 13 START sql table model ___staging.storeclean ........................... [RUN]
[0m15:33:11.332570 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_25.stg_stateprovince, now model.dbt_project_25.storeclean)
[0m15:33:11.333436 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.storeclean
[0m15:33:11.338983 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.storeclean"
[0m15:33:11.340201 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.storeclean
[0m15:33:11.347144 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.storeclean"
[0m15:33:11.348402 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.storeclean"
[0m15:33:11.349270 [debug] [Thread-1 (]: On model.dbt_project_25.storeclean: BEGIN
[0m15:33:11.350093 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:33:11.518317 [debug] [Thread-1 (]: SQL status: BEGIN in 0.168 seconds
[0m15:33:11.520275 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.storeclean"
[0m15:33:11.522113 [debug] [Thread-1 (]: On model.dbt_project_25.storeclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.storeclean"} */

  
    

  create  table "BI_group4"."___staging"."storeclean__dbt_tmp"
  
  
    as
  
  (
    

select
    salespersonid as salerid,
    storename,
    businessentityid
from "BI_group4"."corentin"."store1"
  );
  
[0m15:33:11.538615 [debug] [Thread-1 (]: SQL status: SELECT 701 in 0.015 seconds
[0m15:33:11.550594 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.storeclean"
[0m15:33:11.552199 [debug] [Thread-1 (]: On model.dbt_project_25.storeclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.storeclean"} */
alter table "BI_group4"."___staging"."storeclean" rename to "storeclean__dbt_backup"
[0m15:33:11.563522 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m15:33:11.570790 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.storeclean"
[0m15:33:11.571913 [debug] [Thread-1 (]: On model.dbt_project_25.storeclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.storeclean"} */
alter table "BI_group4"."___staging"."storeclean__dbt_tmp" rename to "storeclean"
[0m15:33:11.583116 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m15:33:11.590635 [debug] [Thread-1 (]: On model.dbt_project_25.storeclean: COMMIT
[0m15:33:11.592450 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.storeclean"
[0m15:33:11.593814 [debug] [Thread-1 (]: On model.dbt_project_25.storeclean: COMMIT
[0m15:33:11.606255 [debug] [Thread-1 (]: SQL status: COMMIT in 0.011 seconds
[0m15:33:11.614129 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."___staging"."storeclean__dbt_backup"
[0m15:33:11.615987 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.storeclean"
[0m15:33:11.616908 [debug] [Thread-1 (]: On model.dbt_project_25.storeclean: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.storeclean"} */
drop table if exists "BI_group4"."___staging"."storeclean__dbt_backup" cascade
[0m15:33:11.632154 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.014 seconds
[0m15:33:11.635402 [debug] [Thread-1 (]: On model.dbt_project_25.storeclean: Close
[0m15:33:11.637119 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '584a89e2-9f50-49a6-b46f-dbdc8744fda3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74d4a571d040>]}
[0m15:33:11.638928 [info ] [Thread-1 (]: 12 of 13 OK created sql table model ___staging.storeclean ...................... [[32mSELECT 701[0m in 0.30s]
[0m15:33:11.640709 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.storeclean
[0m15:33:11.641991 [debug] [Thread-1 (]: Began running node model.dbt_project_25.my_second_dbt_model
[0m15:33:11.643536 [info ] [Thread-1 (]: 13 of 13 START sql view model _.my_second_dbt_model ............................ [RUN]
[0m15:33:11.644534 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_25.storeclean, now model.dbt_project_25.my_second_dbt_model)
[0m15:33:11.645404 [debug] [Thread-1 (]: Began compiling node model.dbt_project_25.my_second_dbt_model
[0m15:33:11.653007 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_25.my_second_dbt_model"
[0m15:33:11.654255 [debug] [Thread-1 (]: Began executing node model.dbt_project_25.my_second_dbt_model
[0m15:33:11.687993 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_25.my_second_dbt_model"
[0m15:33:11.689303 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_second_dbt_model"
[0m15:33:11.690188 [debug] [Thread-1 (]: On model.dbt_project_25.my_second_dbt_model: BEGIN
[0m15:33:11.690995 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:33:11.892526 [debug] [Thread-1 (]: SQL status: BEGIN in 0.201 seconds
[0m15:33:11.894420 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_second_dbt_model"
[0m15:33:11.896293 [debug] [Thread-1 (]: On model.dbt_project_25.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.my_second_dbt_model"} */

  create view "BI_group4"."_"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "BI_group4"."_"."my_first_dbt_model"
where id = 1
  );
[0m15:33:11.909184 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m15:33:11.917972 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_second_dbt_model"
[0m15:33:11.918960 [debug] [Thread-1 (]: On model.dbt_project_25.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.my_second_dbt_model"} */
alter table "BI_group4"."_"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m15:33:11.929658 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m15:33:11.932714 [debug] [Thread-1 (]: On model.dbt_project_25.my_second_dbt_model: COMMIT
[0m15:33:11.933604 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_second_dbt_model"
[0m15:33:11.934439 [debug] [Thread-1 (]: On model.dbt_project_25.my_second_dbt_model: COMMIT
[0m15:33:11.946733 [debug] [Thread-1 (]: SQL status: COMMIT in 0.011 seconds
[0m15:33:11.955269 [debug] [Thread-1 (]: Applying DROP to: "BI_group4"."_"."my_second_dbt_model__dbt_backup"
[0m15:33:11.961608 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_25.my_second_dbt_model"
[0m15:33:11.962514 [debug] [Thread-1 (]: On model.dbt_project_25.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "BI_DBT", "target_name": "dev", "node_id": "model.dbt_project_25.my_second_dbt_model"} */
drop view if exists "BI_group4"."_"."my_second_dbt_model__dbt_backup" cascade
[0m15:33:11.972655 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.009 seconds
[0m15:33:11.975293 [debug] [Thread-1 (]: On model.dbt_project_25.my_second_dbt_model: Close
[0m15:33:11.976683 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '584a89e2-9f50-49a6-b46f-dbdc8744fda3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74d4a834c1d0>]}
[0m15:33:11.978150 [info ] [Thread-1 (]: 13 of 13 OK created sql view model _.my_second_dbt_model ....................... [[32mCREATE VIEW[0m in 0.33s]
[0m15:33:11.979569 [debug] [Thread-1 (]: Finished running node model.dbt_project_25.my_second_dbt_model
[0m15:33:11.983314 [debug] [MainThread]: Using postgres connection "master"
[0m15:33:11.984963 [debug] [MainThread]: On master: BEGIN
[0m15:33:11.986446 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:33:12.143405 [debug] [MainThread]: SQL status: BEGIN in 0.157 seconds
[0m15:33:12.145225 [debug] [MainThread]: On master: COMMIT
[0m15:33:12.146823 [debug] [MainThread]: Using postgres connection "master"
[0m15:33:12.148361 [debug] [MainThread]: On master: COMMIT
[0m15:33:12.159249 [debug] [MainThread]: SQL status: COMMIT in 0.009 seconds
[0m15:33:12.160664 [debug] [MainThread]: On master: Close
[0m15:33:12.162399 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:33:12.163653 [debug] [MainThread]: Connection 'model.dbt_project_25.my_second_dbt_model' was properly closed.
[0m15:33:12.165100 [info ] [MainThread]: 
[0m15:33:12.166338 [info ] [MainThread]: Finished running 12 table models, 1 view model in 0 hours 0 minutes and 5.72 seconds (5.72s).
[0m15:33:12.170636 [debug] [MainThread]: Command end result
[0m15:33:12.219662 [debug] [MainThread]: Wrote artifact WritableManifest to /home/corentin.vanlandeghe@Digital-Grenoble.local/BI_DBT/target/manifest.json
[0m15:33:12.222764 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/corentin.vanlandeghe@Digital-Grenoble.local/BI_DBT/target/semantic_manifest.json
[0m15:33:12.233973 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/corentin.vanlandeghe@Digital-Grenoble.local/BI_DBT/target/run_results.json
[0m15:33:12.234735 [info ] [MainThread]: 
[0m15:33:12.235552 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:33:12.236304 [info ] [MainThread]: 
[0m15:33:12.237104 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=13
[0m15:33:12.238814 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.0613217, "process_in_blocks": "0", "process_kernel_time": 0.522267, "process_mem_max_rss": "124712", "process_out_blocks": "2800", "process_user_time": 5.490808}
[0m15:33:12.239807 [debug] [MainThread]: Command `dbt run` succeeded at 15:33:12.239618 after 7.06 seconds
[0m15:33:12.240632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74d4a8a42ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74d4a8ce66c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74d4a579ea50>]}
[0m15:33:12.241464 [debug] [MainThread]: Flushing usage events
[0m15:33:12.777220 [debug] [MainThread]: An error was encountered while trying to flush usage events
